System.register(["./SiteScroll.vue_vue_type_script_setup_true_lang-legacy-DLExNrH8.js","./NavigationTempl.vue_vue_type_script_setup_true_lang-legacy-C2dvgt7J.js","./DomainTime.vue_vue_type_script_setup_true_lang-legacy-E3oOPybF.js","./index-legacy-DsOVKWX6.js","./useArticle-legacy-BDiQncJd.js","./Constant-legacy-C2LnN0pO.js"],(function(e,t){"use strict";var l,r,a,n,o,s,i,c,d,m,u,x,p,v,f,h,b,g,y,w,j,k,_,E,T,S,O,I,M,U,z,C,$,H,A,L,N,D,F,V,W,Y,q,B,R,G,J,K;return{setters:[e=>{l=e._},e=>{r=e.a,a=e.b,n=e.e,o=e.f,s=e.D,i=e.q,c=e.w,d=e.i,m=e.l,u=e.o,x=e.c},e=>{p=e._},e=>{v=e.d,f=e.y,h=e.b,b=e.r,g=e.j,y=e.c,w=e.e,j=e.f,k=e.t,_=e.g,E=e.V,T=e.h,S=e.K,O=e.i,I=e.W,M=e.X,U=e.o,z=e.O,C=e.B,$=e.Y,H=e.u,A=e.Z,L=e.J,N=e.D,D=e._,F=e.z,V=e.H,W=e.A,Y=e.F,q=e.C,B=e.E,R=e.G,G=e.I,J=e.U},e=>{K=e.s},null],execute:function(){var t=document.createElement("style");t.textContent=".transImage{--imageTrans: invert(73%) sepia(13%) saturate(147%) hue-rotate(345deg) brightness(88%) contrast(85%) }.transImage:hover{--imageTrans: filter: invert(24%) sepia(6%) saturate(733%) hue-rotate(353deg) brightness(93%) contrast(89%) }@keyframes scale-up{0%{scale:0}to{scale:1}}.scale-up{animation:scale-up .3s ease-out forwards}\n/*$vite$:1*/",document.head.appendChild(t);var P="object"==typeof global&&global&&global.Object===Object&&global,X="object"==typeof self&&self&&self.Object===Object&&self,Z=P||X||Function("return this")(),Q=Z.Symbol,ee=Object.prototype,te=ee.hasOwnProperty,le=ee.toString,re=Q?Q.toStringTag:void 0,ae=Object.prototype.toString,ne=Q?Q.toStringTag:void 0;function oe(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ne&&ne in Object(e)?function(e){var t=te.call(e,re),l=e[re];try{e[re]=void 0;var r=!0}catch(n){}var a=le.call(e);return r&&(t?e[re]=l:delete e[re]),a}(e):function(e){return ae.call(e)}(e)}var se=/\s/,ie=/^\s+/;function ce(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&se.test(e.charAt(t)););return t}(e)+1).replace(ie,""):e}function de(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var me=/^[-+]0x[0-9a-f]+$/i,ue=/^0b[01]+$/i,xe=/^0o[0-7]+$/i,pe=parseInt;function ve(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==oe(e)}(e))return NaN;if(de(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=de(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ce(e);var l=ue.test(e);return l||xe.test(e)?pe(e.slice(2),l?2:8):me.test(e)?NaN:+e}var fe=function(){return Z.Date.now()},he=Math.max,be=Math.min;function ge(e,t,l){var r,a,n,o,s,i,c=0,d=!1,m=!1,u=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function x(t){var l=r,n=a;return r=a=void 0,c=t,o=e.apply(n,l)}function p(e){var l=e-i;return void 0===i||l>=t||l<0||m&&e-c>=n}function v(){var e=fe();if(p(e))return f(e);s=setTimeout(v,function(e){var l=t-(e-i);return m?be(l,n-(e-c)):l}(e))}function f(e){return s=void 0,u&&r?x(e):(r=a=void 0,o)}function h(){var e=fe(),l=p(e);if(r=arguments,a=this,i=e,l){if(void 0===s)return function(e){return c=e,s=setTimeout(v,t),d?x(e):o}(i);if(m)return clearTimeout(s),s=setTimeout(v,t),x(i)}return void 0===s&&(s=setTimeout(v,t)),o}return t=ve(t)||0,de(l)&&(d=!!l.leading,n=(m="maxWait"in l)?he(ve(l.maxWait)||0,t):n,u="trailing"in l?!!l.trailing:u),h.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=i=a=s=void 0},h.flush=function(){return void 0===s?o:f(fe())},h}const ye={class:"border-b w-full flex items-end font-bold cursor-pointer border-stone-400 text-stone-400 hover:mix-blend-difference"},we={class:"xl:pt-2 md:pt-1 max-md:pt-0.5"},je={class:"break-all line-clamp-2 text-stone-400/50 xl:w-[calc(1.25rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},ke={class:"break-all line-clamp-2 xl:w-[calc(1.5rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},_e={class:"flex flex-col ml-auto xl:text-[1.2rem] md:text-[1rem] max-md:text-[0.8rem]"},Ee={class:"flex justify-end gap-5"},Te={class:"flex gap-1 items-center"},Se={class:"flex gap-1 items-center"},Oe=v({__name:"ReviewArticleTempl",props:f({article:{}},{forumTemplModels:{},forumTemplModelsModifiers:{},reviewImageObject:{},reviewImageObjectModifiers:{}}),emits:["update:forumTemplModels","update:reviewImageObject"],setup(e){const t=S(),l=e,r=h(e,"forumTemplModels"),a=h(e,"reviewImageObject"),n=b(""),o=g((()=>r.value?.alias||l.article.alias)),s=g((()=>(n.value=r.value?.path||l.article.path,r.value?.path||l.article.path))),i=g((()=>r.value?.time||l.article.time)),c=g((()=>{const e=r.value?.analyze.rating||l.article.analyze.rating;return{nice:e.nice,bad:e.bad}}));g((()=>r.value?.analyze.views||l.article.analyze.views));const d=g((()=>{const e=r.value?.history.length||l.article.history.length;return r.value?.history[e-1].articleTitle||l.article.history[e-1].articleTitle})),m=()=>{a.value.isEnterElement=!1};return(e,l)=>{const r=T("Icon"),a=p;return O(),y("div",{onMouseleave:m},[w("div",{onClick:l[0]||(l[0]=e=>{return l=j(s),void t.push({path:l});var l})},[w("div",ye,[w("span",we,[w("p",je,k(j(o)),1),w("p",ke,k(j(d)),1)]),w("span",_e,[w("div",Ee,[w("p",Te,[_(r,{icon:"ic:round-thumb-up-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),E(" "+k(j(c).nice),1)]),w("p",Se,[_(r,{icon:"ic:round-thumb-down-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),E(" "+k(j(c).bad),1)])]),w("p",null,[_(a,{paramTime:j(i),fromNow:""},null,8,["paramTime"])])])])])],32)}}}),Ie=["src"],Me=v({__name:"followWhatYouSee",props:{imageString:{},imageStringModifiers:{},isEnterElement:{type:Boolean},isEnterElementModifiers:{}},emits:["update:imageString","update:isEnterElement"],setup(e){I($);const t=b(),l=h(e,"imageString"),r=h(e,"isEnterElement"),{x:a,y:n}=M();let o,s=0,i=0,c=0,d=0;return U((()=>{const e=()=>{s=a.value,i=n.value,c+=.08*(s-c),d+=.08*(i-d),t.value.style.top=`${d}px`,t.value.style.left=`${c}px`,o=requestAnimationFrame(e)};e()})),z((()=>{cancelAnimationFrame(o)})),(e,a)=>(O(),y("div",{ref_key:"movingDiv",ref:t,class:"absolute -z-10 pointer-events-none select-none"},[w("div",{class:"absolute -z-20 object-cover -translate-1/2 md:w-[202px] max-md:w-[122px] transition-[height] duration-[0.3s] bg-stone-700 mix-blend-difference",style:C({height:r.value?0:"0px"})},null,4),w("img",{src:l.value,class:"object-cover -translate-1/2 md:w-[200px] max-md:w-[120px] transition-[height] duration-[0.3s]",style:C({height:r.value?0:"0px"})},null,12,Ie)],512))}}),Ue={ref:"root"},ze={class:"[&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},Ce={class:"xl:flex-2/3 md:flex-3/4"},$e={class:"border-y border-stone-400 py-5 grid grid-cols-3"},He={class:"p-2"},Ae={class:"transImage w-full h-full border relative text-stone-400 border-stone-400 hover:text-stone-700 hover:border-stone-700 flex items-end overflow-hidden xl:h-[120px] md:h-[100px] max-md:h-[70px] after:backdrop-blur-[2px] after:absolute after:content-[''] after:w-full after:h-full after:-z-20"},Le=["src"],Ne=["src"],De={class:"px-2 font-bold max-md:text-[0.8rem]"},Fe={class:"p-2"},Ve={class:"flex"},We=["disabled"],Ye=["disabled"],qe={class:"flex-col flex xl:flex-1/3 md:flex-2/4"},Be={class:"md:sticky md:top-[100px] flex flex-col"},Re={class:"font-bold xl:text-[6rem] md:text-[3rem] max-md:text-[2rem]"},Ge={class:"px-2"},Je={class:"flex gap-3 select-none flex-wrap"},Ke={class:"flex"},Pe={class:"flex"},Xe={class:"flex"},Ze={class:"flex"},Qe={class:"w-[82%] xl:my-10 md:my-5 max-md:my-5 max-md:sticky max-md:top-[100px]"},et={ref:"searchForm",class:"relative group flex-7/12 flex items-center"},tt={class:"absolute group-focus-within:text-stone-700 text-stone-400",for:"s"},lt={class:"xl:flex-2/3 md:flex-2/4"};e("default",v({__name:"ForumIndex",setup(e){const t=H(),p=A({isEnterElement:!1,imageSource:""}),v=I($),f=L(),h=g((()=>f.path.split("/")[1]||"index")),k=b([]),S=b([]),M=b([]),z=b(!1),C=b(!0),P=b(null),X=async(e=!1)=>{if(!z.value&&C.value){z.value=!0;try{let t;const l=k.value.find((e=>e.name===h.value))?.articleIDs||[],r=n(s,"articles"),a=l.slice(0,ie.value);console.log(a),e?(S.value=[],P.value=null,C.value=!0,t=i(r,c("xid","in",a))):t=i(r,c("xid","in",a),d(P.value));const m=await o(t);if(console.log(m.docs),m.empty)return C.value=!1,void(z.value=!1);const u=m.docs[m.docs.length-1];P.value=u,m.forEach((e=>{S.value.push({...e.data()})}))}catch(t){console.error(t)}finally{z.value=!1}}},Z=ge((async()=>{!z.value&&C.value&&await X(!1)}),300);U((async()=>{await(async()=>{const e=n(s,"topics");(await o(e)).forEach((e=>{k.value.push({...e.data()})}))})(),X(!0),(async()=>{if(M.value.length>0)return;const e=n(s,"articles"),t=i(e,u("time","desc"),m(2));(await o(t)).forEach((e=>{M.value.push({...e.data()})}))})()})),N(h,(()=>{ae.value="order",z.value=!1,C.value=!0,X(!0)}));const Q=b(1),ee=v?.value.fetchTopics??0,te=g((()=>({currentMax:Q.value*ee,currentMin:(Q.value-1)*ee}))),le=()=>{Q.value-=1},re=()=>{Q.value+=1},ae=b("order");N(ae,(()=>{K(ae.value,S.value)}));const ne=b("");N(ne,ge((()=>{(async()=>{if(!ne.value.trim())return z.value=!1,C.value=!0,void(await X(!0));try{z.value=!0,S.value=[];const e=n(s,"articles"),t=await o(e),l=ne.value.toLowerCase();t.forEach((e=>{const t={...e.data()},r=t.history.length-1;(t.history[r].articleTitle.toLowerCase().includes(l)||t.history[r].articleHtmlRef.toLowerCase().includes(l))&&S.value.push(t)})),C.value=!1}catch(e){console.error("Error searching articles:",e)}finally{z.value=!1}})()}),500));const oe=g((()=>{const e=k.value.find((e=>e.name===h.value))??null,l=e?.nickname??"開始聊";return t.topicTitle="同領地"===l?"開始聊":l,t.articleTitle="",e})),se=b(!1),ie=b(5),{y:ce}=D(),de=g((()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return{scrollableHeight:e-t,currentScrollY:ce.value,windowHeight:t}})),me=g((()=>{const{scrollableHeight:e,currentScrollY:t,windowHeight:l}=de.value;return!se.value&&t>0&&(se.value=!0),!!(se.value&&e-t<.1*l)}));return N(me,(()=>{me.value&&(ie.value+=5,Z())})),(e,t)=>{const n=Me,o=r,s=Oe,i=a,c=x,d=T("router-link"),m=T("Icon"),u=l;return O(),y("div",Ue,[_(n,{isEnterElement:j(p).isEnterElement,"onUpdate:isEnterElement":t[0]||(t[0]=e=>j(p).isEnterElement=e),imageString:j(p).imageSource,"onUpdate:imageString":t[1]||(t[1]=e=>j(p).imageSource=e)},null,8,["isEnterElement","imageString"]),_(o),w("div",ze,["index"===j(h)?(O(),F(i,{key:0,class:"xl:flex xl:item-start xl:py-20 md:flex md:item-start md:py-10 max-md:flex-col max-md:py-6"},{default:W((()=>[t[9]||(t[9]=w("h2",{class:"xl:text-[2.5rem] xl:flex-1/3 md:text-[2rem] md:flex-1/4 max-md:text-[1.5rem]"}," 熱門文章 ",-1)),w("div",Ce,[j(M).length>0?(O(!0),y(Y,{key:0},q(j(M),(e=>(O(),F(s,{reviewImageObject:j(p),"onUpdate:reviewImageObject":t[2]||(t[2]=e=>B(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),256)):(O(),y(Y,{key:1},[E(" still loading... ")],64))])])),_:1})):V("",!0),_(i,{class:"!p-0 !py-10 select-none"},{default:W((()=>[w("div",$e,[j(k).length>0?(O(!0),y(Y,{key:0},q(j(k).slice(j(te).currentMin,j(te).currentMax),(e=>(O(),y("div",He,[_(d,{to:e.path},{default:W((()=>[w("div",Ae,[w("img",{src:`./${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-4 -bottom-2 rounded-full absolute z-10w-20 h-20"},null,8,Le),w("img",{src:`./${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-8 -bottom-4 rounded-full absolute opacity-20 z-10 w-40 h-40"},null,8,Ne),w("div",De,[_(c,{text:e.nickname},null,8,["text"])])])])),_:2},1032,["to"])])))),256)):(O(),y(Y,{key:1},q(3,(e=>w("div",Fe,t[10]||(t[10]=[w("div",{class:"xl:h-[120px] animate-pulse bg-stone-400 md:h-[100px] max-md:h-[70px]"},null,-1)])))),64))]),w("div",Ve,[w("button",{disabled:1===j(Q),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:-translate-x-10 flex-1/2 flex justify-center border-b border-r border-stone-400 py-1",onClick:le},[_(m,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-left-large-light"})],8,We),w("button",{disabled:j(Q)>j(k).length/j(ee),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:translate-x-10 flex-1/2 flex justify-center border-b border-stone-400 py-1",onClick:re},[_(m,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-right-large-light"})],8,Ye)])])),_:1}),_(i,{ref:"root",class:"w-full py-10 xl:flex xl:item-start md:flex md:item-start max-lg:flex-col max-md:flex-col"},{default:W((()=>[w("div",qe,[w("div",Be,[w("h2",Re,[_(c,{text:j(oe)?.nickname??"/*15a"},null,8,["text"])]),w("div",Ge,[_(c,{text:j(oe)?.description??"/*13ad|15a"},null,8,["text"])]),w("div",Je,[w("div",Ke,[R(w("input",{type:"radio",id:"order",name:"msg",value:"order","onUpdate:modelValue":t[3]||(t[3]=e=>B(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[G,j(ae)]]),t[11]||(t[11]=w("label",{for:"order",class:"border-dashed border-2 border-transparent hover:border-stone-400 flex items-center cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 按順序 ",-1))]),w("div",Pe,[R(w("input",{type:"radio",id:"newest",name:"msg",value:"newest","onUpdate:modelValue":t[4]||(t[4]=e=>B(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[G,j(ae)]]),t[12]||(t[12]=w("label",{for:"newest",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最新 ",-1))]),w("div",Xe,[R(w("input",{type:"radio",id:"mostLiked",name:"mostLiked",value:"mostLiked","onUpdate:modelValue":t[5]||(t[5]=e=>B(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[G,j(ae)]]),t[13]||(t[13]=w("label",{for:"mostLiked",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最多讚 ",-1))]),w("div",Ze,[R(w("input",{type:"radio",id:"worst",name:"msg",value:"worst","onUpdate:modelValue":t[6]||(t[6]=e=>B(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[G,j(ae)]]),t[14]||(t[14]=w("label",{for:"worst",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最爛 ",-1))])]),w("div",Qe,[w("form",et,[w("label",tt,[_(m,{icon:"ic:baseline-search",class:"xl:w-6 xl:h-6 md:w-4.5 md:h-4.5 max-md:w-4 max-md:h-4"})]),R(w("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>B(ne)?ne.value=e:null),type:"text",id:"s",placeholder:"文章搜尋...",class:"w-full xl:px-7 xl:h-10 xl:text-[1.2rem] md:px-5 md:h-8 md:text-[1rem] max-md:px-5 max-md:h-5 max-md:text-[1rem] outline-none bg-none border-b border-transparent relative border-b-stone-400 focus:border-b-stone-700"},null,512),[[J,j(ne)]])],512)])])]),w("div",lt,[j(S).length>0?(O(!0),y(Y,{key:0},q(j(S),(e=>(O(),F(s,{key:e.xid,ref_for:!0,ref:"currentArticleScroll",reviewImageObject:j(p),"onUpdate:reviewImageObject":t[8]||(t[8]=e=>B(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),128)):(O(),y(Y,{key:1},[E(" still loading... ")],64))])])),_:1},512)]),_(u)],512)}}}))}}}));

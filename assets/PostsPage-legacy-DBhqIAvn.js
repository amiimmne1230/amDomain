System.register(["./DomainTime.vue_vue_type_script_setup_true_lang-legacy-DMhCqCIK.js","./index-legacy-5WAohqN7.js","./TipTap_Extensions-legacy-Cbsqme6j.js","./NavigationTempl.vue_vue_type_script_setup_true_lang-legacy-DtYztB8L.js"],(function(t,e){"use strict";var r,n,o,s,i,a,l,c,d,h,u,p,f,m,g,v,w,b,x,y,S,k,C,T,E,O,N,z,M,A,I,R,J,D,_,L,j,F,P,H,B,$,W,U,q,G,V,Z,K,Y,X,Q,tt,et,rt,nt,ot,st,it,at,lt,ct,dt,ht;return{setters:[t=>{r=t.i,n=t.r,o=t.u,s=t.A,i=t._,a=t.T},t=>{l=t.d,c=t.M,d=t.s,h=t.r,u=t.p,p=t.m,f=t.u,m=t.N,g=t.O,v=t.P,w=t.Q,b=t.i,x=t.c,y=t.R,S=t.g,k=t.h,C=t.a,T=t.F,E=t.e,O=t.f,N=t.n,z=t.j,M=t.G,A=t.S,I=t.E,R=t.t,J=t.L,D=t.K,_=t.b,L=t.A},t=>{j=t.D,F=t.a,P=t.b,H=t._,B=t.c,$=t.d,W=t.e,U=t.P,q=t.f,G=t.N,V=t.T,Z=t.S,K=t.F,Y=t.h,X=t.i,Q=t.E,tt=t.j,et=t.k},t=>{rt=t.d,nt=t.D,ot=t.g,st=t.u,it=t.h,at=t.s,lt=t._,ct=t.a,dt=t.b,ht=t.c}],execute:function(){var e=document.createElement("style");e.textContent="/*! tailwindcss v4.0.8 | MIT License | https://tailwindcss.com */@layer theme{[data-v-996c856e]:root,[data-v-996c856e]:host{--color-violet-500:oklch(.606 .25 292.717);--color-stone-300:oklch(.869 .005 56.366);--color-stone-400:oklch(.709 .01 56.259);--color-stone-500:oklch(.553 .013 58.071);--color-stone-600:oklch(.444 .011 73.639);--color-stone-900:oklch(.216 .006 56.043);--spacing:.25rem;--text-2xl:1.5rem;--text-2xl--line-height:calc(2/1.5);--text-3xl:1.875rem;--text-3xl--line-height: 1.2 ;--font-weight-bold:700;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1)}}[data-v-996c856e] p{word-break:break-all}[data-v-996c856e] strong{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold);color:var(--color-stone-900)}[data-v-996c856e] mark{background-color:var(--color-stone-300);color:inherit;border-radius:.25rem;margin-inline:2px;padding-inline:2px}[data-v-996c856e] ul{margin-left:calc(var(--spacing)*5);flex-direction:column;list-style-type:disc;display:flex}[data-v-996c856e] ol{margin-left:calc(var(--spacing)*5);flex-direction:column;list-style-type:decimal;display:flex}[data-v-996c856e] li::marker{color:var(--color-stone-400)}:is([data-v-996c856e] h1,[data-v-996c856e] .ProseMirror>h1){font-size:var(--text-3xl);line-height:var(--tw-leading,var(--text-3xl--line-height));text-wrap:pretty;color:var(--color-stone-500)}:is([data-v-996c856e] h2,[data-v-996c856e] .ProseMirror>h2){font-size:var(--text-2xl);line-height:var(--tw-leading,var(--text-2xl--line-height));text-wrap:pretty;color:var(--color-stone-500)}[data-v-996c856e] hr{border-top-style:var(--tw-border-style);border-top-width:0;border-bottom-style:var(--tw-border-style);--tw-border-style:dashed;border-style:dashed;border-bottom-width:2px;border-bottom-color:var(--color-stone-400);min-height:.875rem;margin-bottom:.875rem}[data-v-996c856e] .ProseMirror>hr{margin-bottom:calc(var(--spacing)*0);border-style:var(--tw-border-style);--tw-border-style:dashed;border-style:dashed;border-width:2px;border-color:var(--color-stone-400);border-radius:.25rem;min-height:1.75rem}[data-v-996c856e] blockquote{border-left-style:var(--tw-border-style);border-left-width:3px;border-left-color:var(--color-stone-500);background-color:var(--color-stone-300);padding-left:calc(var(--spacing)*2)}[data-v-996c856e] a{cursor:pointer;--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold);color:var(--color-violet-500)}@media (width>=64rem){[data-v-996c856e] iframe{width:584px}}@media (width>=80rem){[data-v-996c856e] iframe{width:calc(42rem - 40px)}}@media (width>=64rem){[data-v-996c856e] iframe{height:424px}}@media (width>=80rem){[data-v-996c856e] iframe{height:calc(42rem - 200px)}}[data-v-996c856e] .ProseMirror{height:500px;padding-inline:calc(var(--spacing)*5);padding-top:calc(var(--spacing)*16);--tw-outline-style:none;scrollbar-gutter:stable;outline-style:none;overflow-y:auto}[data-v-996c856e] .is-empty:before{pointer-events:none;height:calc(var(--spacing)*0);color:var(--color-stone-400);content:attr(data-placeholder);padding-left:2px;position:absolute}[data-v-996c856e] .drag-handle{z-index:20;height:calc(var(--spacing)*5);width:calc(var(--spacing)*5);cursor:grab;opacity:1;transition-property:all;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration));--handleSvg:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 10 10' style='fill: rgba(0,0,0,50%)'%3E%3Cpath d='M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z'%3E%3C/path%3E%3C/svg%3E\");background-image:var(--handleSvg);background-position:50%;background-repeat:no-repeat;background-size:calc(.5em + .375rem) calc(.5em + .375rem);margin-top:2px;position:fixed}@media (width<48rem){[data-v-996c856e] .drag-handle{display:none}}[data-v-996c856e] .drag-handle.hide{pointer-events:none;opacity:0}[data-v-996c856e] .ProseMirror-selectednode::selection{background-color:var(--color-stone-600)}[data-v-996c856e] .ProseMirror-selectednode{outline-style:var(--tw-outline-style);outline-width:4px;outline-color:var(--color-stone-400)}@property --tw-font-weight{syntax:\"*\";inherits:false}@property --tw-border-style{syntax:\"*\";inherits:false;initial-value:solid}@property --tw-outline-style{syntax:\"*\";inherits:false;initial-value:solid}\n/*$vite$:1*/",document.head.appendChild(e);const ut=Object.freeze(Object.defineProperty({__proto__:null,Decoration:j,DecorationSet:F,EditorView:P,__endComposition:H,__parseFromClipboard:B},Symbol.toStringTag,{value:"Module"}));function pt(t){return v(((e,r)=>({get:()=>(e(),t),set(e){t=e,requestAnimationFrame((()=>{requestAnimationFrame((()=>{r()}))}))}})))}class ft extends ${constructor(t={}){return super(t),this.contentComponent=null,this.appContext=null,this.reactiveState=pt(this.view.state),this.reactiveExtensionStorage=pt(this.extensionStorage),this.on("beforeTransaction",(({nextState:t})=>{this.reactiveState.value=t,this.reactiveExtensionStorage.value=this.extensionStorage})),c(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,e){const r=super.registerPlugin(t,e);return this.reactiveState&&(this.reactiveState.value=r),r}unregisterPlugin(t){const e=super.unregisterPlugin(t);return this.reactiveState&&e&&(this.reactiveState.value=e),e}}const mt=l({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(t){const e=h(),r=m();return u((()=>{const n=t.editor;n&&n.options.element&&e.value&&p((()=>{if(!e.value||!n.options.element.firstChild)return;const t=f(e.value);e.value.append(...n.options.element.childNodes),n.contentComponent=r.ctx._,r&&(n.appContext={...r.appContext,provides:r.provides}),n.setOptions({element:t}),n.createNodeViews()}))})),g((()=>{const e=t.editor;e&&(e.contentComponent=null,e.appContext=null)})),{rootEl:e}},render(){return d("div",{ref:t=>{this.rootEl=t}})}});function gt(t,e){if(t&&"function"==typeof t.serializeForClipboard)return t.serializeForClipboard(e);const r=function(){try{return ut}catch(t){return null}}();if(r&&"function"==typeof r?.__serializeForClipboard)return r.__serializeForClipboard(t,e);throw new Error("No supported clipboard serialization method found.")}function vt(t,e){const r=["li","p:not(:first-child)","pre","blockquote","h1","h2","h3","h4","h5","h6",...e.customNodes.map((t=>`[data-type=${t}]`))].join(", ");return document.elementsFromPoint(t.x,t.y).find((t=>t.parentElement?.matches?.(".ProseMirror")||t.matches(r)))}function wt(t,e){const r=e.state.doc.resolve(t);return r.depth>1?r.before(r.depth):t}function bt(t){let e="",r=null;function n(){r&&r.classList.add("hide")}function o(t){if(t.target instanceof Element){const e=t.relatedTarget;if(e?.classList.contains("tiptap")||e?.classList.contains("drag-handle"))return}n()}return new U({key:new q(t.pluginKey),view:s=>{const i=t.dragHandleSelector?document.querySelector(t.dragHandleSelector):null;function a(r){!function(r,n){if(n.focus(),!r.dataTransfer)return;const o=vt({x:r.clientX+50+t.dragHandleWidth,y:r.clientY},t);if(!(o instanceof Element))return;let s=function(t,e,r){const n=t.getBoundingClientRect();return e.posAtCoords({left:n.left+50+r.dragHandleWidth,top:n.top+1})?.inside}(o,n,t);if(null==s||s<0)return;s=wt(s,n);const{from:i,to:a}=n.state.selection,l=i-a,c=wt(i,n);let d=!1;const h=n.state.doc.resolve(c);if("doc"===h.node().type.name)d=!0;else{const t=G.create(n.state.doc,h.before());d=!(s+1>=t.$from.pos&&s<=t.$to.pos)}let u=n.state.selection;if(d||0===l||n.state.selection instanceof G){if(u=G.create(n.state.doc,s),u.node.type.isInline||"tableRow"===u.node.type.name){let t=n.state.doc.resolve(u.from);u=G.create(n.state.doc,t.before())}}else{const t=G.create(n.state.doc,a-1);u=V.create(n.state.doc,s,t.$to.pos)}n.dispatch(n.state.tr.setSelection(u)),n.state.selection instanceof G&&"listItem"===n.state.selection.node.type.name&&(e=o.parentElement.tagName);const p=n.state.selection.content(),{dom:f,text:m}=gt(n,p);r.dataTransfer.clearData(),r.dataTransfer.setData("text/html",f.innerHTML),r.dataTransfer.setData("text/plain",m),r.dataTransfer.effectAllowed="copyMove",r.dataTransfer.setDragImage(o,0,0),n.dragging={slice:p,move:r.ctrlKey}}(r,s)}function l(e){n();let r=window.scrollY;e.clientY<t.scrollTreshold?window.scrollTo({top:r-30,behavior:"smooth"}):window.innerHeight-e.clientY<t.scrollTreshold&&window.scrollTo({top:r+30,behavior:"smooth"})}return r=i??document.createElement("div"),r.draggable=!0,r.dataset.dragHandle="",r.classList.add("drag-handle"),r.addEventListener("dragstart",a),r.addEventListener("drag",l),n(),i||s?.dom?.parentElement?.appendChild(r),s?.dom?.parentElement?.addEventListener("mouseout",o),{destroy:()=>{i||r?.remove?.(),r?.removeEventListener("drag",l),r?.removeEventListener("dragstart",a),r=null,s?.dom?.parentElement?.removeEventListener("mouseout",o)}}},props:{handleDOMEvents:{mousemove:(e,o)=>{if(!e.editable)return;const s=vt({x:o.clientX+50+t.dragHandleWidth,y:o.clientY},t),i=s?.closest(".not-draggable"),a=t.excludedTags.concat(["ol","ul"]).join(", ");if(!(s instanceof Element)||s.matches(a)||i)return void n();const l=window.getComputedStyle(s),c=parseInt(l.lineHeight,10),d=isNaN(c)?1.2*parseInt(l.fontSize):c,h=parseInt(l.paddingTop,10),u=function(t){const e=t.getBoundingClientRect(),r=t.closest('[role="dialog"]');if(r&&"none"!==window.getComputedStyle(r).transform){const t=r.getBoundingClientRect();return{top:e.top-t.top,left:e.left-t.left,width:e.width}}return{top:e.top,left:e.left,width:e.width}}(s);u.top+=(d-24)/2,u.top+=h,s.matches("ul:not([data-type=taskList]) li, ol li")&&(u.left-=t.dragHandleWidth),u.width=t.dragHandleWidth,r&&(r.style.left=u.left-u.width+"px",r.style.top=`${u.top}px`,r&&r.classList.remove("hide"))},keydown:()=>{n()},mousewheel:()=>{n()},dragstart:t=>{t.dom.classList.add("dragging")},drop:(t,r)=>{t.dom.classList.remove("dragging"),n();let o=null;const s=t.posAtCoords({left:r.clientX,top:r.clientY});if(!s)return;if(t.state.selection instanceof G&&(o=t.state.selection.node),!o)return;const i="listItem"===t.state.doc.resolve(s.pos).parent.type.name;if(t.state.selection instanceof G&&"listItem"===t.state.selection.node.type.name&&!i&&"OL"==e){const e=t.state.schema.nodes.orderedList?.createAndFill(null,o),n=new Z(K.from(e),0,0);t.dragging={slice:n,move:r.ctrlKey}}},dragend:t=>{t.dom.classList.remove("dragging")}}}})}const xt=W.create({name:"globalDragHandle",addOptions:()=>({dragHandleWidth:20,scrollTreshold:100,excludedTags:[],customNodes:[]}),addProseMirrorPlugins(){return[bt({pluginKey:"globalDragHandle",dragHandleWidth:this.options.dragHandleWidth,scrollTreshold:this.options.scrollTreshold,dragHandleSelector:this.options.dragHandleSelector,excludedTags:this.options.excludedTags,customNodes:this.options.customNodes})]}});function yt(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let o=t.child(n),s=e.child(n);if(o!=s){if(!o.sameMarkup(s))return r;if(o.isText&&o.text!=s.text){for(let t=0;o.text[t]==s.text[t];t++)r++;return r}if(o.content.size||s.content.size){let t=yt(o.content,s.content,r+1);if(null!=t)return t}r+=o.nodeSize}else r+=o.nodeSize}}function St(t,e,r,n){for(let o=t.childCount,s=e.childCount;;){if(0==o||0==s)return o==s?null:{a:r,b:n};let i=t.child(--o),a=e.child(--s),l=i.nodeSize;if(i!=a){if(!i.sameMarkup(a))return{a:r,b:n};if(i.isText&&i.text!=a.text){let t=0,e=Math.min(i.text.length,a.text.length);for(;t<e&&i.text[i.text.length-t-1]==a.text[a.text.length-t-1];)t++,r--,n--;return{a:r,b:n}}if(i.content.size||a.content.size){let t=St(i.content,a.content,r-1,n-1);if(t)return t}r-=l,n-=l}else r-=l,n-=l}}class kt{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,n=0,o){for(let s=0,i=0;i<e;s++){let a=this.content[s],l=i+a.nodeSize;if(l>t&&!1!==r(a,n+i,o||null,s)&&a.content.size){let o=i+1;a.nodesBetween(Math.max(0,t-o),Math.min(a.content.size,e-o),r,n+o)}i=l}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,n){let o="",s=!0;return this.nodesBetween(t,e,((i,a)=>{let l=i.isText?i.text.slice(Math.max(t,a)-a,e-a):i.isLeaf?n?"function"==typeof n?n(i):n:i.type.spec.leafText?i.type.spec.leafText(i):"":"";i.isBlock&&(i.isLeaf&&l||i.isTextblock)&&r&&(s?s=!1:o+=r),o+=l}),0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,n=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(r)&&(n[n.length-1]=e.withText(e.text+r.text),o=1);o<t.content.length;o++)n.push(t.content[o]);return new kt(n,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let r=[],n=0;if(e>t)for(let o=0,s=0;s<e;o++){let i=this.content[o],a=s+i.nodeSize;a>t&&((s<t||a>e)&&(i=i.isText?i.cut(Math.max(0,t-s),Math.min(i.text.length,e-s)):i.cut(Math.max(0,t-s-1),Math.min(i.content.size,e-s-1))),r.push(i),n+=i.nodeSize),s=a}return new kt(r,n)}cutByIndex(t,e){return t==e?kt.empty:0==t&&e==this.content.length?this:new kt(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let n=this.content.slice(),o=this.size+e.nodeSize-r.nodeSize;return n[t]=e,new kt(n,o)}addToStart(t){return new kt([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new kt(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let n=this.content[e];t(n,r,e),r+=n.nodeSize}}findDiffStart(t,e=0){return yt(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return St(this,t,e,r)}findIndex(t,e=-1){if(0==t)return Tt(0,t);if(t==this.size)return Tt(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,n=0;;r++){let o=n+this.child(r).nodeSize;if(o>=t)return o==t||e>0?Tt(r+1,o):Tt(r,n);n=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((t=>t.toJSON())):null}static fromJSON(t,e){if(!e)return kt.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new kt(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return kt.empty;let e,r=0;for(let n=0;n<t.length;n++){let o=t[n];r+=o.nodeSize,n&&o.isText&&t[n-1].sameMarkup(o)?(e||(e=t.slice(0,n)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new kt(e||t,r)}static from(t){if(!t)return kt.empty;if(t instanceof kt)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new kt([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}kt.empty=new kt([],0);const Ct={index:0,offset:0};function Tt(t,e){return Ct.index=t,Ct.offset=e,Ct}class Et extends Error{}class Ot{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=zt(this.content,t+this.openStart,e);return r&&new Ot(r,this.openStart,this.openEnd)}removeBetween(t,e){return new Ot(Nt(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return Ot.empty;let r=e.openStart||0,n=e.openEnd||0;if("number"!=typeof r||"number"!=typeof n)throw new RangeError("Invalid input for Slice.fromJSON");return new Ot(kt.fromJSON(t,e.content),r,n)}static maxOpen(t,e=!0){let r=0,n=0;for(let o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=t.lastChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.lastChild)n++;return new Ot(t,r,n)}}function Nt(t,e,r){let{index:n,offset:o}=t.findIndex(e),s=t.maybeChild(n),{index:i,offset:a}=t.findIndex(r);if(o==e||s.isText){if(a!=r&&!t.child(i).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=i)throw new RangeError("Removing non-flat range");return t.replaceChild(n,s.copy(Nt(s.content,e-o-1,r-o-1)))}function zt(t,e,r,n){let{index:o,offset:s}=t.findIndex(e),i=t.maybeChild(o);if(s==e||i.isText)return t.cut(0,e).append(r).append(t.cut(e));let a=zt(i.content,e-s-1,r);return a&&t.replaceChild(o,i.copy(a))}Ot.empty=new Ot(kt.empty,0,0);const Mt=Math.pow(2,16);function At(t){return 65535&t}class It{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class Rt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&Rt.empty)return Rt.empty}recover(t){let e=0,r=At(t);if(!this.inverted)for(let n=0;n<r;n++)e+=this.ranges[3*n+2]-this.ranges[3*n+1];return this.ranges[3*r]+e+function(t){return(t-(65535&t))/Mt}(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let n=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let a=this.ranges[i]-(this.inverted?n:0);if(a>t)break;let l=this.ranges[i+o],c=this.ranges[i+s],d=a+l;if(t<=d){let o=a+n+((l?t==a?-1:t==d?1:e:e)<0?0:c);if(r)return o;let s=t==(e<0?a:d)?null:i/3+(t-a)*Mt,h=t==a?2:t==d?1:4;return(e<0?t!=a:t!=d)&&(h|=8),new It(o,h,s)}n+=c-l}return r?t+n:new It(t+n,0,null)}touches(t,e){let r=0,n=At(e),o=this.inverted?2:1,s=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let e=this.ranges[i]-(this.inverted?r:0);if(e>t)break;let a=this.ranges[i+o];if(t<=e+a&&i==3*n)return!0;r+=this.ranges[i+s]-a}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let n=0,o=0;n<this.ranges.length;n+=3){let s=this.ranges[n],i=s-(this.inverted?o:0),a=s+(this.inverted?0:o),l=this.ranges[n+e],c=this.ranges[n+r];t(i,i+l,a,a+c),o+=c-l}}invert(){return new Rt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?Rt.empty:new Rt(t<0?[0,-t,0]:[0,0,t])}}Rt.empty=new Rt([]);const Jt=Object.create(null);class Dt{getMap(){return Rt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Jt[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Jt)throw new RangeError("Duplicate use of step JSON ID "+t);return Jt[t]=e,e.prototype.jsonID=t,e}}class _t{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new _t(t,null)}static fail(t){return new _t(null,t)}static fromReplace(t,e,r,n){try{return _t.ok(t.replace(e,r,n))}catch(o){if(o instanceof Et)return _t.fail(o.message);throw o}}}function Lt(t,e,r){let n=[];for(let o=0;o<t.childCount;o++){let s=t.child(o);s.content.size&&(s=s.copy(Lt(s.content,e,s))),s.isInline&&(s=e(s,r,o)),n.push(s)}return kt.fromArray(n)}class jt extends Dt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),n=r.node(r.sharedDepth(this.to)),o=new Ot(Lt(e.content,((t,e)=>t.isAtom&&e.type.allowsMarkType(this.mark.type)?t.mark(this.mark.addToSet(t.marks)):t),n),e.openStart,e.openEnd);return _t.fromReplace(t,this.from,this.to,o)}invert(){return new Ft(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new jt(e.pos,r.pos,this.mark)}merge(t){return t instanceof jt&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new jt(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new jt(e.from,e.to,t.markFromJSON(e.mark))}}Dt.jsonID("addMark",jt);class Ft extends Dt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new Ot(Lt(e.content,(t=>t.mark(this.mark.removeFromSet(t.marks))),t),e.openStart,e.openEnd);return _t.fromReplace(t,this.from,this.to,r)}invert(){return new jt(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ft(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ft&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ft(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ft(e.from,e.to,t.markFromJSON(e.mark))}}Dt.jsonID("removeMark",Ft);class Pt extends Dt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return _t.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return _t.fromReplace(t,this.pos,this.pos+1,new Ot(kt.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let t=this.mark.addToSet(e.marks);if(t.length==e.marks.length){for(let r=0;r<e.marks.length;r++)if(!e.marks[r].isInSet(t))return new Pt(this.pos,e.marks[r]);return new Pt(this.pos,this.mark)}}return new Ht(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Pt(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Pt(e.pos,t.markFromJSON(e.mark))}}Dt.jsonID("addNodeMark",Pt);class Ht extends Dt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return _t.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return _t.fromReplace(t,this.pos,this.pos+1,new Ot(kt.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new Pt(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Ht(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ht(e.pos,t.markFromJSON(e.mark))}}Dt.jsonID("removeNodeMark",Ht);class Bt extends Dt{constructor(t,e,r,n=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=n}apply(t){return this.structure&&Wt(t,this.from,this.to)?_t.fail("Structure replace would overwrite content"):_t.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new Rt([this.from,this.to-this.from,this.slice.size])}invert(t){return new Bt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new Bt(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof Bt)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;{let e=this.slice.size+t.slice.size==0?Ot.empty:new Ot(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Bt(t.from,this.to,e,this.structure)}}{let e=this.slice.size+t.slice.size==0?Ot.empty:new Ot(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Bt(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Bt(e.from,e.to,Ot.fromJSON(t,e.slice),!!e.structure)}}Dt.jsonID("replace",Bt);class $t extends Dt{constructor(t,e,r,n,o,s,i=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=n,this.slice=o,this.insert=s,this.structure=i}apply(t){if(this.structure&&(Wt(t,this.from,this.gapFrom)||Wt(t,this.gapTo,this.to)))return _t.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return _t.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?_t.fromReplace(t,this.from,this.to,r):_t.fail("Content does not fit in gap")}getMap(){return new Rt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new $t(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),n=t.map(this.gapFrom,-1),o=t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||n<e.pos||o>r.pos?null:new $t(e.pos,r.pos,n,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new $t(e.from,e.to,e.gapFrom,e.gapTo,Ot.fromJSON(t,e.slice),e.insert,!!e.structure)}}function Wt(t,e,r){let n=t.resolve(e),o=r-e,s=n.depth;for(;o>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,o--;if(o>0){let t=n.node(s).maybeChild(n.indexAfter(s));for(;o>0;){if(!t||t.isLeaf)return!0;t=t.firstChild,o--}}return!1}function Ut(t,e){let r=t.resolve(e),n=r.index();return o=r.nodeBefore,s=r.nodeAfter,!(!o||!s||o.isLeaf||!o.canAppend(s))&&r.parent.canReplace(n,n+1);var o,s}Dt.jsonID("replaceAround",$t);class qt extends Dt{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return _t.fail("No node at attribute step's position");let r=Object.create(null);for(let o in e.attrs)r[o]=e.attrs[o];r[this.attr]=this.value;let n=e.type.create(r,null,e.marks);return _t.fromReplace(t,this.pos,this.pos+1,new Ot(kt.from(n),0,e.isLeaf?0:1))}getMap(){return Rt.empty}invert(t){return new qt(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new qt(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new qt(e.pos,e.attr,e.value)}}Dt.jsonID("attr",qt);class Gt extends Dt{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return _t.ok(r)}getMap(){return Rt.empty}invert(t){return new Gt(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if("string"!=typeof e.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Gt(e.attr,e.value)}}Dt.jsonID("docAttr",Gt);let Vt=class extends Error{};function Zt(t,e,r){let n=[];for(let i=0;i<t.mapping.maps.length;i++){let e=t.mapping.maps[i];if(e){for(let t=0;t<n.length;t++)n[t]=e.map(n[t]);e.forEach(((t,e,r,o)=>n.push(r,o)))}}let o=[];for(let i=0;i<n.length;i+=2){let e=n[i],s=n[i+1],a=t.doc.resolve(e),l=a.sharedDepth(s),c=a.node(l);for(let t=a.indexAfter(l),n=a.after(l+1);n<=s;++t){let e=c.maybeChild(t);if(!e)break;if(t&&-1==o.indexOf(n)){let s=c.child(t-1);s.type==e.type&&r.includes(s.type)&&o.push(n)}n+=e.nodeSize}}let s=!1;o.sort(((t,e)=>t-e));for(let i=o.length-1;i>=0;i--)Ut(t.doc,o[i])&&(e.join(o[i]),s=!0);return s}Vt=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r},(Vt.prototype=Object.create(Error.prototype)).constructor=Vt,Vt.prototype.name="TransformError";const Kt=W.create({name:"autoJoiner",addOptions:()=>({elementsToJoin:[]}),addProseMirrorPlugins(){const t=new q(this.name),e=[this.editor.schema.nodes.bulletList,this.editor.schema.nodes.orderedList];return this.options.elementsToJoin.forEach((t=>{const r=Y(t,this.editor.schema);e.push(r)})),[new U({key:t,appendTransaction(t,r,n){let o=n.tr,s=!1;for(const i of t)s=Zt(i,o,e)||s;if(s)return o}})]}}),Yt=W.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new U({key:new q("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,o=[];if(!r)return null;const s=this.editor.isEmpty;return t.descendants(((t,e)=>{const r=n>=e&&n<=e+t.nodeSize,i=!t.isLeaf&&X(t);if((r||!this.options.showOnlyCurrent)&&i){const n=[this.options.emptyNodeClass];s&&n.push(this.options.emptyEditorClass);const i=j.node(e,e+t.nodeSize,{class:n.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:t,pos:e,hasAnchor:r}):this.options.placeholder});o.push(i)}return this.options.includeChildren})),F.create(t,o)}}})]}}),Xt=W.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter((t=>""!==t)).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=t=>{const e=(null==t?void 0:t.node)||this.editor.state.doc;if("textSize"===((null==t?void 0:t.mode)||this.options.mode)){const t=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(t)}return e.nodeSize},this.storage.words=t=>{const e=(null==t?void 0:t.node)||this.editor.state.doc,r=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let t=!1;return[new U({key:new q("characterCount"),appendTransaction:(e,r,n)=>{if(t)return;const o=this.options.limit;if(null==o||0===o)return void(t=!0);const s=this.storage.characters({node:n.doc});if(s>o){const e=0,r=s-o;console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);const i=n.tr.deleteRange(e,r);return t=!0,i}t=!0},filterTransaction:(t,e)=>{const r=this.options.limit;if(!t.docChanged||0===r||null==r)return!0;const n=this.storage.characters({node:e.doc}),o=this.storage.characters({node:t.doc});if(o<=r)return!0;if(n>r&&o>r&&o<=n)return!0;if(n>r&&o>r&&o>n)return!1;if(!t.getMeta("paste"))return!1;const s=t.selection.$head.pos,i=s-(o-r),a=s;return t.deleteRange(i,a),!(this.storage.characters({node:t.doc})>r)}})]}});w.extend(r),w.extend(n),w.extend(o),w.locale("zh-tw");const Qt=()=>w.utc().local();new class{timer=null;getDomainTime=(()=>h(null))();constructor(){this.getDomainTime.value=Qt()}calculateNextDelay(){return 1e3-Qt().millisecond()}start(){const t=()=>{this.getDomainTime.value=Qt();const e=this.calculateNextDelay(),r=Qt().valueOf()-this.getDomainTime.value.valueOf();console.log("誤差:",r,"ms"),this.timer=setTimeout(t,e)};t()}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}getTime(){return this.getDomainTime.value}};const te=12,ee="xid: invalid ID",re=new TextEncoder,ne=new TextDecoder,oe=re.encode("0123456789abcdefghijklmnopqrstuv"),se=new Uint8Array(256).fill(255);for(let t=0;t<oe.length;t++)se[oe[t]]=t;const ie="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,ae=ce();class le extends Uint8Array{static machineId=(()=>ce())();static pid=(()=>function(){if("object"==typeof globalThis&&"process"in globalThis)return 65535&globalThis.process.pid;const t=ie.getRandomValues(new Uint8Array(2));return t[0]<<8|t[1]}())();static counter=(()=>ae[0]<<16|ae[1]<<8|ae[2])();constructor(t){if(super(te),null==t){const t=new DataView(this.buffer),e=Math.floor(Date.now()/1e3);t.setUint32(0,e),this[4]=le.machineId[0],this[5]=le.machineId[1],this[6]=le.machineId[2],this[7]=le.pid>>8,this[8]=255&le.pid,le.counter+=1,le.counter>16777215&&(le.counter=0),this[9]=le.counter>>16,this[10]=255&le.counter,this[11]=255&le.counter}else{if(!(t instanceof Uint8Array&&t.length===te))throw new Error(ee);this.set(t)}}static default(){return new le(new Uint8Array(te).fill(0))}static fromValue(t){if(t instanceof le)return t;if("string"==typeof t)return le.parse(t);if(t instanceof Uint8Array&&t.length===te)return new le(t);if(t instanceof ArrayBuffer&&t.byteLength===te)return new le(new Uint8Array(t));if(Array.isArray(t)&&t.length===te&&t.every((t=>"number"==typeof t&&t>=0&&t<=255)))return new le(new Uint8Array(t));throw new Error(ee)}static parse(t){if(20!==t.length)throw new Error(ee);const e=new le;return e.decode(t),e}decode(t){const e=re.encode(t);if(20!==e.length)throw new Error(ee);for(const r of e)if(255==se[r])throw new Error(ee);if(this[11]=se[e[17]]<<6|se[e[18]]<<1|se[e[19]]>>4,oe[this[11]<<4&31]!=e[19])throw new Error(ee);this[10]=se[e[16]]<<3|se[e[17]]>>2,this[9]=se[e[14]]<<5|se[e[15]],this[8]=se[e[12]]<<7|se[e[13]]<<2|se[e[14]]>>3,this[7]=se[e[11]]<<4|se[e[12]]>>1,this[6]=se[e[9]]<<6|se[e[10]]<<1|se[e[11]]>>4,this[5]=se[e[8]]<<3|se[e[9]]>>2,this[4]=se[e[6]]<<5|se[e[7]],this[3]=se[e[4]]<<7|se[e[5]]<<2|se[e[6]]>>3,this[2]=se[e[3]]<<4|se[e[4]]>>1,this[1]=se[e[1]]<<6|se[e[2]]<<1|se[e[3]]>>4,this[0]=se[e[0]]<<3|se[e[1]]>>2}encode(){const t=new Uint8Array(20);return t[19]=oe[this[11]<<4&31],t[18]=oe[this[11]>>1&31],t[17]=oe[this[11]>>6|this[10]<<2&31],t[16]=oe[this[10]>>3],t[15]=oe[31&this[9]],t[14]=oe[this[9]>>5|this[8]<<3&31],t[13]=oe[this[8]>>2&31],t[12]=oe[this[8]>>7|this[7]<<1&31],t[11]=oe[this[7]>>4|this[6]<<4&31],t[10]=oe[this[6]>>1&31],t[9]=oe[this[6]>>6|this[5]<<2&31],t[8]=oe[this[5]>>3],t[7]=oe[31&this[4]],t[6]=oe[this[4]>>5|this[3]<<3&31],t[5]=oe[this[3]>>2&31],t[4]=oe[this[3]>>7|this[2]<<1&31],t[3]=oe[this[2]>>4|this[1]<<4&31],t[2]=oe[this[1]>>1&31],t[1]=oe[this[1]>>6|this[0]<<2&31],t[0]=oe[this[0]>>3],ne.decode(t)}timestamp(){return new DataView(this.buffer).getUint32(0)}machine(){return new Uint8Array(this.buffer,4,3)}pid(){return this[7]<<8|this[8]}counter(){return this[9]<<16|this[10]<<8|this[11]}isZero(){return super.every((t=>0===t))}toString(){return this.encode()}toBytes(){return new Uint8Array(this.buffer,0,te)}toJSON(){return this.encode()}equals(t){for(let e=0;e<te;e++)if(this[e]!==t[e])return!1;return!0}}function ce(){return ie.getRandomValues(new Uint8Array(3))}const de={class:"border border-dashed border-stone-500"},he={class:"h-9 flex justify-between relative"},ue={class:"flex items-center h-8 px-2 select-none"},pe={class:"flex items-center h-8 px-2 select-none"},fe={class:"flex items-end gap-3 px-5"},me={class:"font-[monospace] text-xs flex"},ge={class:"flex flex-col justify-end items-end h-full text-stone-400"},ve={class:"px-3 w-[768px] flex justify-between"},we=["disabled"],be=["disabled"],xe=["disabled"],ye=["disabled"],Se=l({__name:"TextEditor",props:{articleHtmlRef:{},articleHtmlRefModifiers:{},isDomainFormat:{type:Boolean},isDomainFormatModifiers:{}},emits:["update:articleHtmlRef","update:isDomainFormat"],setup(t){const e=D(),r=b(t,"articleHtmlRef"),n=b(t,"isDomainFormat");let o=!1,l=!0;const c=h(!1),d=h(),u=h(),p=new ft({extensions:[...Q,xt.configure({dragHandleSelector:".drag-handle"}),Kt,Xt.configure({limit:s.WORD_LIMIT,textCounter:t=>t.replace(/\s+/g," ").length}),Yt.configure({placeholder:({pos:t,node:e,editor:r})=>0===t?"第一段內容會作為標題或封面圖":"新段落..."})],editorProps:{attributes:{spellcheck:"false"},handleDOMEvents:{input:(t,e)=>(!o&&l&&setTimeout((()=>{j(p)}),0),!1),compositionstart:()=>(o=!0,!1),compositionend:()=>(o=!1,l&&setTimeout((()=>{j(p)}),0),!1)}},content:r.value,onUpdate:({editor:t})=>{const e=t.getJSON();e&&(r.value=JSON.stringify(e))}}),m=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983]],g=t=>{const e=t.codePointAt(0);return!!e&&m.some((([t,r])=>e>=t&&e<=r))},v=t=>/^[a-zA-Z0-9]$/.test(t),L=(t,e)=>{if(!t||!e)return!1;if(" "===t||" "===e)return!1;const r=g(t),n=v(t),o=g(e),s=v(e);return r&&s||n&&o},j=t=>{const e=tt((t=>"paragraph"===t.type.name))(t.state.selection);if(!e)return;const{node:r,start:n}=e,o=((t,e,r)=>{const n=[];let o="",s=0,i=!1;return t.descendants(((t,e)=>{t.isText?(t.text||"").split("").forEach(((t,r)=>{n.push({text:t,originalPosition:s,nodePosition:e+r}),o+=t,s++})):"mention"===t.type.name&&(i=!0,(t.attrs.label||"").split("").forEach(((t,r)=>{n.push({text:t,originalPosition:s,nodePosition:e}),o+=t,s++})))})),{mappings:n,text:o,isMention:i,cursorOffset:r-e}})(r,n,t.state.selection.from),s=(t=>{const e=[],{text:r}=t;for(let n=0;n<r.length-1;n++)L(r[n],r[n+1])&&e.push(n+1);return e})(o);if(0===s.length)return;t.chain().focus().command((({tr:t})=>(s.reverse().forEach((e=>{const r=o.mappings[e].nodePosition+(o.isMention,0);t.insertText(" ",n+r)})),!0))).run();const i=((t,e,r)=>{const{cursorOffset:n}=t,o=e.filter((t=>t<=n)).length;let s=r.state.selection.from+o;if(n>0){const e=t.text[n-1],r=t.text[n];e&&r&&(s-=o+1)}return s})(o,s,t);t.commands.setTextSelection(i)},F=x((()=>p.storage.characterCount.characters())),P=x((()=>p.storage.characterCount.characters()>=s.WORD_LIMIT)),H=x((()=>p.storage.characterCount.characters()>=s.WORD_WARNING&&p.storage.characterCount.characters()<s.WORD_LIMIT)),B=x((()=>et.size>=s.IMAGE_LIMIT)),$=x((()=>et.size>=s.IMAGE_WARNING&&et.size<s.IMAGE_LIMIT));y(d,(()=>c.value=!1),{ignore:[u]});const W=h(),U=h(!1),q=h(0),G=h(0),V=t=>{W.value&&(U.value=!0,q.value=t.pageX-W.value.offsetLeft,G.value=W.value.scrollLeft,console.log("isDragging.value",U.value))},Z=()=>{U.value=!1,console.log("isDragging.value22",U.value)},K=t=>{if(!U.value||!W.value)return;t.preventDefault();const e=1*(t.pageX-W.value.offsetLeft-q.value);console.log(e),W.value.scrollLeft=G.value-e},Y=S(),X=k(),lt=h(!1),ct=()=>{const t=p.getJSON();if(!t||!t.content||0===t.content.length)return"";const e=t.content.find((t=>"paragraph"===t.type&&t.content&&t.content.length>0));return e&&e.content?e.content.filter((t=>"text"===t.type)).map((t=>t.text)).join(""):""};return(t,o)=>{const h=z("Icon"),m=i;return _(),C(T,null,[E("div",de,[O(f(mt),{editor:f(p),class:N({"amDomain-format-editorMode":n.value})},null,8,["editor","class"]),E("div",he,[E("button",{ref_key:"editorOptionsButtonRef",ref:u,class:"ml-3 hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:o[0]||(o[0]=t=>c.value=!f(c))},[O(h,{icon:"ic:sharp-menu",width:"24",height:"24"})],512),E("div",{ref_key:"editorOptionsRef",ref:d,class:N("absolute left-0 mx-3  bottom-10 flex w-44 font-semibold text-sm border border-stone-400/50 bg-stone-300/10 p-1 rounded-lg backdrop-blur-sm bg-opacity-20 z-10  flex-col\n                    "+(f(c)?"":"hidden"))},[E("div",ue,[M(E("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>n.value=t),class:"w-4 h-4 hover:cursor-pointer",id:"editorGap",type:"checkbox",value:"true",checked:""},null,512),[[A,n.value]]),o[15]||(o[15]=E("label",{class:"w-full hover:cursor-pointer pl-2",for:"editorGap"},"同領地格式",-1))]),E("div",pe,[M(E("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>I(l)?l.value=t:l=t),class:"w-4 h-4 hover:cursor-pointer",id:"autoGap",type:"checkbox",value:"true",checked:""},null,512),[[A,f(l)]]),o[16]||(o[16]=E("label",{class:"w-full hover:cursor-pointer pl-2",for:"autoGap"},"中英文自動空白",-1))])],2),E("div",fe,[E("div",me,[O(m,{isClock:"",paramFormat:f(a).CLOCK_FORMAT},null,8,["paramFormat"])]),E("div",ge,[E("div",{class:N({"text-xs font-[monospace] ":!0,"text-red-600 font-bold":f(P),"text-orange-400":f(H)})},R(`${f(F)}/${f(s).WORD_LIMIT}`)+"字 ",3),E("div",{class:N({"text-xs font-[monospace]":!0,"text-red-600 font-bold":f(B),"text-orange-400":f($)})},R(`${f(et).size}/${f(s).IMAGE_LIMIT}`)+"圖 ",3)])])]),E("div",{class:"py-2 overflow-auto overflow-x-hidden",ref_key:"toolbarRef",ref:W,onMousedown:V,onMouseup:Z,onMouseleave:Z,onMousemove:K},[E("span",ve,[E("button",{class:"hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:o[3]||(o[3]=t=>f(p).chain().focus().undo().run()),disabled:!f(p).can().chain().focus().undo().run()},[O(h,{icon:"ic:baseline-undo",width:"24",height:"24"})],8,we),E("button",{class:"hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:o[4]||(o[4]=t=>f(p).chain().focus().redo().run()),disabled:!f(p).can().chain().focus().redo().run()},[O(h,{icon:"ic:sharp-redo",width:"24",height:"24"})],8,be),E("button",{class:"hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:o[5]||(o[5]=t=>{f(p).chain().focus().clearContent(!0).run(),f(et).clear()})},[O(h,{icon:"ic:round-restore-page",width:"24",height:"24"})]),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("bold")}]),onClick:o[6]||(o[6]=t=>f(p).chain().focus().toggleBold().run()),disabled:!f(p).can().chain().focus().toggleBold().run()},[O(h,{icon:"ic:round-format-bold",width:"24",height:"24"})],10,xe),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("highlight")}]),onClick:o[7]||(o[7]=t=>f(p).chain().focus().toggleHighlight().run())},[O(h,{icon:"ic:baseline-texture",width:"24",height:"24"})],2),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("bulletList")}]),onClick:o[8]||(o[8]=t=>f(p).chain().focus().toggleBulletList().run())},[O(h,{icon:"ic:round-format-list-bulleted",width:"24",height:"24"})],2),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("orderedList")}]),onClick:o[9]||(o[9]=t=>f(p).chain().focus().toggleOrderedList().run())},[O(h,{icon:"ic:sharp-format-list-numbered",width:"24",height:"24"})],2),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("heading",{level:1})}]),onClick:o[10]||(o[10]=t=>f(p).chain().focus().toggleHeading({level:1}).run())},o[17]||(o[17]=[E("span",{class:"flex font-bold items-baseline"},[E("b",null,"H"),E("small",null,"1")],-1)]),2),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("heading",{level:2})}]),onClick:o[11]||(o[11]=t=>f(p).chain().focus().toggleHeading({level:2}).run())},o[18]||(o[18]=[E("span",{class:"flex font-bold items-baseline"},[E("b",null,"H"),E("small",null,"2")],-1)]),2),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("horizontalRule")}]),onClick:o[12]||(o[12]=t=>f(p).chain().focus().setHorizontalRule().run())},[O(h,{icon:"ic:sharp-horizontal-rule",width:"24",height:"24"})],2),E("button",{class:N(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":f(p).isActive("blockquote")}]),onClick:o[13]||(o[13]=t=>f(p).chain().focus().toggleBlockquote().run())},[O(h,{icon:"ic:baseline-format-quote",width:"24",height:"24"})],2),E("button",{disabled:f(lt),class:"cursor-pointer h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded px-2 disabled:cursor-not-allowed not-disabled:hover:border-stone-400 not-disabled:focus-visible:outline-2 not-disabled:focus-visible:outline-offset-2 not-disabled:focus-visible:outline-stone-600",type:"submit",onClickOnce:o[14]||(o[14]=t=>(async()=>{lt.value=!0;const t={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:`${X.name} 想發文, 但沒有內容`}]}]},o="index"===Y.topic?"letsTalking":Y.topic,s=w().valueOf(),i=new le;if(Y.article){const e=rt(nt,"articles",Y.article),o=(await ot(e)).data(),i={articleTitle:ct(),articleHtmlRef:r.value??JSON.stringify(t),isDomainFormat:n.value??!1,time:s,tag:`${ct()}`,floor:o.messages.length+1};await st(e,{messages:it(i)})}else{const e={xid:i.toString(),user:X.name,time:s,analyze:{rating:{nice:0,bad:0},ratedLists:{},views:0},path:i.toString(),alias:o,history:[{articleTitle:ct(),articleHtmlRef:r.value??JSON.stringify(t),isDomainFormat:n.value??!1,time:s,tag:`${ct()}(原文)`}],messages:[]};await at(rt(nt,"articles",i.toString()),e);const a=rt(nt,"topics",Y.topic),l=rt(nt,"topics","index");console.log(a,l),await st(a,{articleIDs:it(i.toString())}),await st(l,{articleIDs:it(i.toString())})}e.push("/")})())},[M(E("p",null,[O(h,{class:"w-9 h-9",icon:"line-md:loading-twotone-loop"})],512),[[J,f(lt)]]),M(E("p",null," 確認發文 ",512),[[J,!f(lt)]])],40,ye)])],544)]),o[19]||(o[19]=E("div",{class:"text-[0.8rem]"}," 可左右拖曳來選擇工具 ",-1))],64)}}}),ke=lt(Se,[["__scopeId","data-v-996c856e"]]),Ce={class:"bg-stone-100 [&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},Te={class:"flex w-full"},Ee={class:"xl:w-[600px] md:w-[400px] md:flex max-md:hidden flex-col"},Oe={class:"sticky top-[100px]"},Ne={class:"text-[1.1rem]"},ze={class:"w-full xl:max-w-[654px] md:max-w-[550px]"};t("default",l({__name:"PostsPage",setup(t){const e=S(),r=`你準備在 ${e.topicTitle} 發表`,n=`你正要在 ${e.articleTitle} 留言`,o=x((()=>""===e.article?r:n));return console.log(e.topic),(t,e)=>{const r=ct,n=ht,s=dt,i=ke;return _(),C(T,null,[O(r),E("div",Ce,[O(s,{class:"select-none !pt-5 flex justify-center xl:min-h-[calc(100dvh-100px-(1.25rem*2))] md:min-h-[calc(100dvh-80px-(1rem*2))] max-md:min-h-[calc(100dvh-60px)]"},{default:L((()=>[E("div",Te,[E("div",Ee,[E("div",Oe,[O(s,{class:"flex flex-col"},{default:L((()=>[E("p",Ne,[O(n,{text:f(o)},null,8,["text"])])])),_:1})])]),E("div",ze,[O(i)])])])),_:1})])],64)}}}))}}}));

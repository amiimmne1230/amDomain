System.register(["./SiteScroll.vue_vue_type_script_setup_true_lang-legacy-LLmmvp60.js","./NavigationTempl.vue_vue_type_script_setup_true_lang-legacy-CpdnMrvN.js","./useArticle-legacy-BBnBA827.js","./index-legacy-B2lF5WV6.js","./Constant-legacy-BH4m8QoS.js"],(function(e,t){"use strict";var l,a,r,n,o,s,i,d,c,u,m,x,p,f,v,h,b,g,y,w,j,k,T,_,O,I,E,S,M,C,U,z,H,L,N,$,V,A,D,F,W,Y,R,q,G;return{setters:[e=>{l=e._},e=>{a=e.a,r=e.b,n=e.e,o=e.f,s=e.D,i=e.q,d=e.w,c=e.h,u=e.l,m=e.o,x=e.c},e=>{p=e._,f=e.s},e=>{v=e.d,h=e.y,b=e.i,g=e.r,y=e.c,w=e.a,j=e.e,k=e.u,T=e.t,_=e.f,O=e.U,I=e.j,E=e.K,S=e.b,M=e.g,C=e.V,U=e.W,z=e.J,H=e.o,L=e.D,N=e.X,$=e.H,V=e.A,A=e.Y,D=e.F,F=e.C,W=e.z,Y=e.E,R=e.G,q=e.I,G=e.S},null],execute:function(){var t=document.createElement("style");t.textContent=".transImage{--imageTrans: invert(73%) sepia(13%) saturate(147%) hue-rotate(345deg) brightness(88%) contrast(85%) }.transImage:hover{--imageTrans: filter: invert(24%) sepia(6%) saturate(733%) hue-rotate(353deg) brightness(93%) contrast(89%) }@keyframes scale-up{0%{scale:0}to{scale:1}}.scale-up{animation:scale-up .3s ease-out forwards}\n/*$vite$:1*/",document.head.appendChild(t);var J="object"==typeof global&&global&&global.Object===Object&&global,K="object"==typeof self&&self&&self.Object===Object&&self,P=J||K||Function("return this")(),X=P.Symbol,B=Object.prototype,Q=B.hasOwnProperty,Z=B.toString,ee=X?X.toStringTag:void 0,te=Object.prototype.toString,le=X?X.toStringTag:void 0;function ae(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":le&&le in Object(e)?function(e){var t=Q.call(e,ee),l=e[ee];try{e[ee]=void 0;var a=!0}catch(n){}var r=Z.call(e);return a&&(t?e[ee]=l:delete e[ee]),r}(e):function(e){return te.call(e)}(e)}var re=/\s/,ne=/^\s+/;function oe(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&re.test(e.charAt(t)););return t}(e)+1).replace(ne,""):e}function se(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var ie=/^[-+]0x[0-9a-f]+$/i,de=/^0b[01]+$/i,ce=/^0o[0-7]+$/i,ue=parseInt;function me(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==ae(e)}(e))return NaN;if(se(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=se(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=oe(e);var l=de.test(e);return l||ce.test(e)?ue(e.slice(2),l?2:8):ie.test(e)?NaN:+e}var xe=function(){return P.Date.now()},pe=Math.max,fe=Math.min;function ve(e,t,l){var a,r,n,o,s,i,d=0,c=!1,u=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function x(t){var l=a,n=r;return a=r=void 0,d=t,o=e.apply(n,l)}function p(e){var l=e-i;return void 0===i||l>=t||l<0||u&&e-d>=n}function f(){var e=xe();if(p(e))return v(e);s=setTimeout(f,function(e){var l=t-(e-i);return u?fe(l,n-(e-d)):l}(e))}function v(e){return s=void 0,m&&a?x(e):(a=r=void 0,o)}function h(){var e=xe(),l=p(e);if(a=arguments,r=this,i=e,l){if(void 0===s)return function(e){return d=e,s=setTimeout(f,t),c?x(e):o}(i);if(u)return clearTimeout(s),s=setTimeout(f,t),x(i)}return void 0===s&&(s=setTimeout(f,t)),o}return t=me(t)||0,se(l)&&(c=!!l.leading,n=(u="maxWait"in l)?pe(me(l.maxWait)||0,t):n,m="trailing"in l?!!l.trailing:m),h.cancel=function(){void 0!==s&&clearTimeout(s),d=0,a=i=r=s=void 0},h.flush=function(){return void 0===s?o:v(xe())},h}const he={class:"border-b w-full flex items-end font-bold cursor-pointer border-stone-400 text-stone-400 hover:mix-blend-difference"},be={class:"xl:pt-2 md:pt-1 max-md:pt-0.5"},ge={class:"break-all line-clamp-2 text-stone-400/50 xl:w-80 xl:text-lg \x3c!-- 原 calc(1.25rem*20) = 25rem → w-80 (320px) --\x3e md:w-64 md:text-base \x3c!-- calc(1rem*20) = 20rem → w-64 (256px) --\x3e max-md:max-w-48 max-md:text-[8px]"},ye={class:"break-all line-clamp-2 xl:w-96 xl:text-lg \x3c!-- calc(1.5rem*20) = 30rem → w-96 (384px) --\x3e md:w-64 md:text-base max-md:max-w-[calc(1rem*8)] max-md:text-[12px]"},we={class:"flex flex-col ml-auto xl:text-xl md:text-base max-md:text-[8px]"},je={class:"flex justify-end gap-5"},ke={class:"flex gap-1 items-center"},Te={class:"flex gap-1 items-center"},_e=v({__name:"ReviewArticleTempl",props:h({article:{}},{forumTemplModels:{},forumTemplModelsModifiers:{},reviewImageObject:{},reviewImageObjectModifiers:{}}),emits:["update:forumTemplModels","update:reviewImageObject"],setup(e){const t=E(),l=e,a=b(e,"forumTemplModels"),r=b(e,"reviewImageObject"),n=g(""),o=y((()=>a.value?.alias||l.article.alias)),s=y((()=>(n.value=a.value?.path||l.article.path,a.value?.path||l.article.path))),i=y((()=>a.value?.time||l.article.time)),d=y((()=>{const e=a.value?.analyze.rating||l.article.analyze.rating;return{nice:e.nice,bad:e.bad}}));y((()=>a.value?.analyze.views||l.article.analyze.views));const c=y((()=>{const e=a.value?.history.length||l.article.history.length;return a.value?.history[e-1].articleTitle||l.article.history[e-1].articleTitle})),u=()=>{r.value.isEnterElement=!1};return(e,l)=>{const a=I("Icon"),r=p;return S(),w("div",{onMouseleave:u},[j("div",{onClick:l[0]||(l[0]=e=>{return l=k(s),void t.push({path:l});var l})},[j("div",he,[j("span",be,[j("p",ge,T(k(o)),1),j("p",ye,T(k(c)),1)]),j("span",we,[j("div",je,[j("p",ke,[_(a,{icon:"ic:round-thumb-up-alt",class:"xl:w-5 xl:h-5 md:w-4 md:h-4 max-md:w-3 max-md:h-3"}),O(" "+T(k(d).nice),1)]),j("p",Te,[_(a,{icon:"ic:round-thumb-down-alt",class:"xl:w-5 xl:h-5 md:w-4 md:h-4 max-md:w-3 max-md:h-3"}),O(" "+T(k(d).bad),1)])]),j("p",null,[_(r,{paramTime:k(i),fromNow:""},null,8,["paramTime"])])])])])],32)}}}),Oe={ref:"root"},Ie={key:0,class:"xl:mt-25 md:mt-20 max-md:mt-15"},Ee={class:"xl:flex-2/3 md:flex-3/4"},Se={class:"border-y border-stone-400 py-5 grid grid-cols-3"},Me={class:"p-2"},Ce={class:"transImage w-full h-full border relative text-stone-400 border-stone-400 hover:text-stone-700 hover:border-stone-700 flex items-end overflow-hidden xl:h-[120px] md:h-[100px] max-md:h-[70px] after:backdrop-blur-[2px] after:absolute after:content-[''] after:w-full after:h-full after:-z-20"},Ue=["src"],ze=["src"],He={class:"px-2 font-bold max-md:text-[0.8rem]"},Le={class:"p-2"},Ne={class:"flex"},$e=["disabled"],Ve=["disabled"],Ae={class:"flex-col flex xl:flex-1/3 md:flex-2/4"},De={class:"md:sticky md:top-[100px] flex flex-col"},Fe={class:"font-bold xl:text-[6rem] md:text-[3rem] max-md:text-[2rem]"},We={class:"md:text-[1rem] max-md:text-[0.75rem] max-md:mb-2"},Ye={class:"flex gap-3 select-none flex-wrap"},Re={class:"flex"},qe={class:"flex"},Ge={class:"flex"},Je={class:"flex"},Ke={class:"w-[82%] xl:my-10 md:my-5 max-md:my-5 max-md:sticky max-md:top-[100px]"},Pe={ref:"searchForm",class:"relative group flex-7/12 flex items-center"},Xe={class:"absolute group-focus-within:text-stone-700 text-stone-400",for:"s"},Be={class:"xl:flex-2/3 md:flex-2/4"};e("default",v({__name:"ForumIndex",setup(e){const t=M(),p=C({isEnterElement:!1,imageSource:""}),v=U(A),h=z(),b=y((()=>h.path.split("/")[1]||"index")),T=g([]),E=g([]),J=g([]),K=g(!1),P=g(!0),X=g(null),B=async(e=!1)=>{if(!K.value&&P.value){K.value=!0;try{let t;const l=T.value.find((e=>e.name===b.value))?.articleIDs||[],a=n(s,"articles"),r=l.slice(0,ie.value);console.log(r),e?(E.value=[],X.value=null,P.value=!0,t=i(a,d("xid","in",r))):t=i(a,d("xid","in",r),c(X.value));const u=await o(t);if(console.log(u.docs),u.empty)return P.value=!1,void(K.value=!1);const m=u.docs[u.docs.length-1];X.value=m,u.forEach((e=>{E.value.push({...e.data()})}))}catch(t){console.error(t)}finally{K.value=!1}}},Q=ve((async()=>{!K.value&&P.value&&await B(!1)}),300);H((async()=>{await(async()=>{const e=n(s,"topics");(await o(e)).forEach((e=>{T.value.push({...e.data()})}))})(),B(!0),(async()=>{if(J.value.length>0)return;const e=n(s,"articles"),t=i(e,m("time","desc"),u(2));(await o(t)).forEach((e=>{J.value.push({...e.data()})}))})()})),L(b,(()=>{re.value="order",K.value=!1,P.value=!0,B(!0)}));const Z=g(1),ee=v?.value.fetchTopics??0,te=y((()=>({currentMax:Z.value*ee,currentMin:(Z.value-1)*ee}))),le=()=>{Z.value-=1},ae=()=>{Z.value+=1},re=g("order");L(re,(()=>{f(re.value,E.value)}));const ne=g("");L(ne,ve((()=>{(async()=>{if(!ne.value.trim())return K.value=!1,P.value=!0,void(await B(!0));try{K.value=!0,E.value=[];const e=n(s,"articles"),t=await o(e),l=ne.value.toLowerCase();t.forEach((e=>{const t={...e.data()},a=t.history.length-1;(t.history[a].articleTitle.toLowerCase().includes(l)||t.history[a].articleHtmlRef.toLowerCase().includes(l))&&E.value.push(t)})),P.value=!1}catch(e){console.error("Error searching articles:",e)}finally{K.value=!1}})()}),500));const oe=y((()=>{const e=T.value.find((e=>e.name===b.value))??null,l=e?.nickname??"開始聊";return t.topicTitle="同領地"===l?"開始聊":l,t.articleTitle="",e})),se=g(!1),ie=g(5),{y:de}=N(),ce=y((()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return{scrollableHeight:e-t,currentScrollY:de.value,windowHeight:t}})),ue=y((()=>{const{scrollableHeight:e,currentScrollY:t,windowHeight:l}=ce.value;return!se.value&&t>0&&(se.value=!0),!!(se.value&&e-t<.1*l)}));return L(ue,(()=>{ue.value&&(ie.value+=5,Q())})),(e,t)=>{const n=a,o=_e,s=r,i=x,d=I("router-link"),c=I("Icon"),u=l;return S(),w("div",Oe,[_(n),"index"===k(b)?(S(),w("div",Ie,[_(s,{class:"xl:flex xl:item-start xl:py-20 md:flex md:item-start md:py-10 max-md:flex-col max-md:py-6"},{default:V((()=>[t[7]||(t[7]=j("h2",{class:"xl:text-[2.5rem] xl:flex-1/3 md:text-[2rem] md:flex-1/4 max-md:text-[1.5rem]"}," 熱門文章 ",-1)),j("div",Ee,[k(J).length>0?(S(!0),w(D,{key:0},F(k(J),(e=>(S(),W(o,{reviewImageObject:k(p),"onUpdate:reviewImageObject":t[0]||(t[0]=e=>Y(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),256)):(S(),w(D,{key:1},[O(" still loading... ")],64))])])),_:1})])):$("",!0),_(s,{class:"!p-0 !py-10 select-none"},{default:V((()=>[j("div",Se,[k(T).length>0?(S(!0),w(D,{key:0},F(k(T).slice(k(te).currentMin,k(te).currentMax),(e=>(S(),w("div",Me,[_(d,{to:e.path},{default:V((()=>[j("div",Ce,[j("img",{src:`./${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-4 -bottom-2 rounded-full absolute z-10w-20 h-20"},null,8,Ue),j("img",{src:`./${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-8 -bottom-4 rounded-full absolute opacity-20 z-10 w-40 h-40"},null,8,ze),j("div",He,[_(i,{text:e.nickname},null,8,["text"])])])])),_:2},1032,["to"])])))),256)):(S(),w(D,{key:1},F(3,(e=>j("div",Le,t[8]||(t[8]=[j("div",{class:"xl:h-[120px] animate-pulse bg-stone-400 md:h-[100px] max-md:h-[70px]"},null,-1)])))),64))]),j("div",Ne,[j("button",{disabled:1===k(Z),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:-translate-x-10 flex-1/2 flex justify-center border-b border-r border-stone-400 py-1",onClick:le},[_(c,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-left-large-light"})],8,$e),j("button",{disabled:k(Z)>k(T).length/k(ee),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:translate-x-10 flex-1/2 flex justify-center border-b border-stone-400 py-1",onClick:ae},[_(c,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-right-large-light"})],8,Ve)])])),_:1}),_(s,{ref:"root",class:"w-full py-10 xl:flex xl:item-start md:flex md:item-start max-lg:flex-col max-md:flex-col"},{default:V((()=>[j("div",Ae,[j("div",De,[j("h2",Fe,[_(i,{text:k(oe)?.nickname??"/*15a"},null,8,["text"])]),j("div",We,[_(i,{text:k(oe)?.description??"/*13ad|15a"},null,8,["text"])]),j("div",Ye,[j("div",Re,[R(j("input",{type:"radio",id:"order",name:"msg",value:"order","onUpdate:modelValue":t[1]||(t[1]=e=>Y(re)?re.value=e:null),class:"hidden peer"},null,512),[[q,k(re)]]),t[9]||(t[9]=j("label",{for:"order",class:"border-dashed border-2 border-transparent hover:border-stone-400 flex items-center cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 按順序 ",-1))]),j("div",qe,[R(j("input",{type:"radio",id:"newest",name:"msg",value:"newest","onUpdate:modelValue":t[2]||(t[2]=e=>Y(re)?re.value=e:null),class:"hidden peer"},null,512),[[q,k(re)]]),t[10]||(t[10]=j("label",{for:"newest",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最新 ",-1))]),j("div",Ge,[R(j("input",{type:"radio",id:"mostLiked",name:"mostLiked",value:"mostLiked","onUpdate:modelValue":t[3]||(t[3]=e=>Y(re)?re.value=e:null),class:"hidden peer"},null,512),[[q,k(re)]]),t[11]||(t[11]=j("label",{for:"mostLiked",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最多讚 ",-1))]),j("div",Je,[R(j("input",{type:"radio",id:"worst",name:"msg",value:"worst","onUpdate:modelValue":t[4]||(t[4]=e=>Y(re)?re.value=e:null),class:"hidden peer"},null,512),[[q,k(re)]]),t[12]||(t[12]=j("label",{for:"worst",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最爛 ",-1))])]),j("div",Ke,[j("form",Pe,[j("label",Xe,[_(c,{icon:"ic:baseline-search",class:"xl:w-6 xl:h-6 md:w-4.5 md:h-4.5 max-md:w-4 max-md:h-4"})]),R(j("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>Y(ne)?ne.value=e:null),type:"text",id:"s",placeholder:"文章搜尋...",class:"w-full xl:px-7 xl:h-10 xl:text-[1.2rem] md:px-5 md:h-8 md:text-[1rem] max-md:px-5 max-md:h-5 max-md:text-[1rem] outline-none bg-none border-b border-transparent relative border-b-stone-400 focus:border-b-stone-700"},null,512),[[G,k(ne)]])],512)])])]),j("div",Be,[k(E).length>0?(S(!0),w(D,{key:0},F(k(E),(e=>(S(),W(o,{key:e.xid,ref_for:!0,ref:"currentArticleScroll",reviewImageObject:k(p),"onUpdate:reviewImageObject":t[6]||(t[6]=e=>Y(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),128)):(S(),w(D,{key:1},[O(" still loading... ")],64))])])),_:1},512),_(u)],512)}}}))}}}));

import{a as D,b as T,c as N,q as U,e as q,D as r,w as B,f as S,s as x,d as v}from"./NavigationTempl.vue_vue_type_script_setup_true_lang-DhGwbUhp.js";import{d as V,h as j,r as u,a as _,f as n,e as t,A,F as I,G as m,H as O,U as Q,L as h,j as R,Q as d,J as F,K as M,b as g}from"./index-BgsJa8Kn.js";const P={class:"bg-stone-100 [&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},$={class:"sm:mx-auto sm:w-full sm:max-w-sm text-center"},E={class:"mt-10 md:w-[40%] max-md:w-[80%]"},G=["disabled"],H={class:"h-6"},J={key:0,class:"text-red-700 mt-2 font-bold"},X=V({__name:"LoginPage",setup(K){const b=j(),f=M(),w=F(),s=u(""),l=u(""),i=u(!1);let p=0;const y=async()=>{if(!s.value||s.value===""||s.value.length<2){clearTimeout(p),l.value="*你為什麼不輸入只要兩個字的名稱呢",p=setTimeout(()=>{l.value=""},6e3);return}i.value=!0;const e=s.value.trim().toLocaleLowerCase();try{const o=U(q(r,"users"),B("name","==",e)),c=await S(o);console.log(c.empty),c.empty?await x(v(r,"users",e),{lastLogin:d().valueOf(),name:e,posting:[],createdAt:d().valueOf()}):await x(v(r,"users",e),{lastLogin:d().valueOf()},{merge:!0}),b.name=e,localStorage.setItem("user",e);const a=w.query.redirect;if(a){f.push(a);return}f.push("/")}catch(o){console.log(o)}};return(e,o)=>{const c=D,a=N,k=R("Icon"),L=T;return g(),_(I,null,[n(c),t("div",P,[n(L,{class:"select-none !pt-5 flex flex-col items-center xl:min-h-[calc(100dvh-100px-(1.25rem*2))] md:min-h-[calc(100dvh-80px-(1rem*2))] max-md:min-h-[calc(100dvh-60px)]"},{default:A(()=>[t("div",$,[n(a,{text:"\n                    匿名註冊也等同登入\n                    有可能使用到別人名稱帳號\n                    但無所謂，不會儲存多重要的資訊\n                    當作大家隨性使用的匿名社群即可\n                "})]),t("div",E,[m(t("input",{"onUpdate:modelValue":o[0]||(o[0]=C=>s.value=C),type:"text",name:"nickname",id:"nickname",autocomplete:"nickname",required:"",class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-stone-600 sm:text-sm/6"},null,512),[[Q,s.value]]),t("button",{disabled:i.value,onClick:y,class:"flex mt-5 w-full justify-center rounded-md bg-stone-600 px-3 py-1.5 text-sm/6 font-semibold text-white shadow-xs disabled:cursor-not-allowed not-disabled:hover:bg-stone-500 not-disabled:focus-visible:outline-2 not-disabled:focus-visible:outline-offset-2 not-disabled:focus-visible:outline-stone-600"},[m(t("p",null,[n(k,{class:"w-6 h-6",icon:"line-md:loading-twotone-loop"})],512),[[h,i.value]]),m(t("p",H," 確認 ",512),[[h,!i.value]])],8,G),l.value?(g(),_("p",J,[n(a,{text:l.value},null,8,["text"])])):O("",!0)])]),_:1})])],64)}}});export{X as default};

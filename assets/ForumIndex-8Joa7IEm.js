import{_ as ke}from"./SiteScroll.vue_vue_type_script_setup_true_lang-B_WChsvk.js";import{_ as je}from"./TransformTexts.vue_vue_type_script_setup_true_lang-ClfTigCn.js";import{a as Ee,b as Ie,_ as Oe}from"./NavigationTempl.vue_vue_type_script_setup_true_lang-ONSS9R4d.js";import{_ as $e}from"./DomainTime.vue_vue_type_script_setup_true_lang-Bx8huQX5.js";import{d as ae,v as Me,H as Ae,u as Q,e as I,g as j,r as se,c as O,o as T,a as t,h as o,t as z,b as p,Q as P,U as he,V as ge,W as Fe,f as be,L as Le,z as de,X as Ne,D as Ce,B as te,Y as Re,x as re,Z as Ue,y as G,F as C,A as q,C as N,E as B,G as K,S as ze}from"./index-BaPN8NSU.js";import{u as Be,s as He,c as ue}from"./posts-BFG-dEd0.js";import{u as Pe}from"./useTopic-CGqswk0A.js";const De={class:"border-b w-full flex items-end font-bold cursor-pointer border-stone-400 text-stone-400 hover:mix-blend-difference"},Ve={class:"xl:pt-2 md:pt-1 max-md:pt-0.5"},We={class:"break-all line-clamp-2 text-stone-400/50 xl:w-[calc(1.25rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},Ye={class:"break-all line-clamp-2 xl:w-[calc(1.5rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},Xe={class:"flex flex-col ml-auto xl:text-[1.2rem] md:text-[1rem] max-md:text-[0.8rem]"},Ge={class:"flex justify-end gap-5"},qe={class:"flex gap-1 items-center"},Ke={class:"flex gap-1 items-center"},Qe={class:"flex gap-1 items-center"},Ze=ae({__name:"ReviewArticleTempl",props:Me({article:{}},{forumTemplModels:{},forumTemplModelsModifiers:{},reviewImageObject:{},reviewImageObjectModifiers:{}}),emits:["update:forumTemplModels","update:reviewImageObject"],setup(e){const s=Ae(),n=e,l=Q(e,"forumTemplModels"),b=Q(e,"reviewImageObject"),v=c=>{s.push({path:c})},u=I(""),i=j(()=>{var c;return((c=l.value)==null?void 0:c.alias)||n.article.alias}),x=j(()=>{var c,f;return u.value=((c=l.value)==null?void 0:c.path)||n.article.path,((f=l.value)==null?void 0:f.path)||n.article.path}),_=j(()=>{var f;return((f=l.value)==null?void 0:f.time)||n.article.time}),S=j(()=>{var h;const c=((h=l.value)==null?void 0:h.analyze.rating)||n.article.analyze.rating;return{nice:c.nice,bad:c.bad}}),w=j(()=>{var f;return((f=l.value)==null?void 0:f.analyze.views)||n.article.analyze.views}),y=j(()=>{var h,a;const c=((h=l.value)==null?void 0:h.history.length)||n.article.history.length;return((a=l.value)==null?void 0:a.history[c-1].articleTitle)||n.article.history[c-1].articleTitle}),$=()=>{b.value.isEnterElement=!1};return(c,f)=>{const h=se("Icon"),a=$e;return T(),O("div",{onMouseleave:$},[t("div",{onClick:f[0]||(f[0]=A=>v(o(x)))},[t("div",De,[t("span",Ve,[t("p",We,z(o(i)),1),t("p",Ye,z(o(y)),1)]),t("span",Xe,[t("div",Ge,[t("p",qe,[p(h,{icon:"ic:twotone-signal-cellular-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),P(" "+z(o(w)),1)]),t("p",Ke,[p(h,{icon:"ic:round-thumb-up-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),P(" "+z(o(S).nice),1)]),t("p",Qe,[p(h,{icon:"ic:round-thumb-down-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),P(" "+z(o(S).bad),1)])]),t("p",null,[p(a,{paramTime:o(_),fromNow:""},null,8,["paramTime"])])])])])],32)}}}),Je=["src"],xe=.08,et=ae({__name:"followWhatYouSee",props:{imageString:{},imageStringModifiers:{},isEnterElement:{type:Boolean},isEnterElementModifiers:{}},emits:["update:imageString","update:isEnterElement"],setup(e){he(ge);const s=I(),n=Q(e,"imageString"),l=Q(e,"isEnterElement"),{x:b,y:v}=Fe();let u=0,i=0,x=0,_=0,S;return be(()=>{const w=()=>{u=b.value,i=v.value,x+=(u-x)*xe,_+=(i-_)*xe,s.value.style.top="".concat(_,"px"),s.value.style.left="".concat(x,"px"),S=requestAnimationFrame(w)};w()}),Le(()=>{cancelAnimationFrame(S)}),(w,y)=>(T(),O("div",{ref_key:"movingDiv",ref:s,class:"absolute -z-10 pointer-events-none select-none"},[t("div",{class:"absolute -z-20 object-cover -translate-1/2 md:w-[202px] max-md:w-[122px] transition-[height] duration-[0.3s] bg-stone-700 mix-blend-difference",style:de({height:l.value?0:"0px"})},null,4),t("img",{src:n.value,class:"object-cover -translate-1/2 md:w-[200px] max-md:w-[120px] transition-[height] duration-[0.3s]",style:de({height:l.value?0:"0px"})},null,12,Je)],512))}});var tt=typeof global=="object"&&global&&global.Object===Object&&global,rt=typeof self=="object"&&self&&self.Object===Object&&self,_e=tt||rt||Function("return this")(),Z=_e.Symbol,we=Object.prototype,nt=we.hasOwnProperty,ot=we.toString,H=Z?Z.toStringTag:void 0;function st(e){var s=nt.call(e,H),n=e[H];try{e[H]=void 0;var l=!0}catch(v){}var b=ot.call(e);return l&&(s?e[H]=n:delete e[H]),b}var lt=Object.prototype,at=lt.toString;function it(e){return at.call(e)}var ct="[object Null]",mt="[object Undefined]",fe=Z?Z.toStringTag:void 0;function dt(e){return e==null?e===void 0?mt:ct:fe&&fe in Object(e)?st(e):it(e)}function ut(e){return e!=null&&typeof e=="object"}var xt="[object Symbol]";function ft(e){return typeof e=="symbol"||ut(e)&&dt(e)==xt}var pt=/\s/;function vt(e){for(var s=e.length;s--&&pt.test(e.charAt(s)););return s}var ht=/^\s+/;function gt(e){return e&&e.slice(0,vt(e)+1).replace(ht,"")}function le(e){var s=typeof e;return e!=null&&(s=="object"||s=="function")}var pe=NaN,bt=/^[-+]0x[0-9a-f]+$/i,_t=/^0b[01]+$/i,wt=/^0o[0-7]+$/i,yt=parseInt;function ve(e){if(typeof e=="number")return e;if(ft(e))return pe;if(le(e)){var s=typeof e.valueOf=="function"?e.valueOf():e;e=le(s)?s+"":s}if(typeof e!="string")return e===0?e:+e;e=gt(e);var n=_t.test(e);return n||wt.test(e)?yt(e.slice(2),n?2:8):bt.test(e)?pe:+e}var ne=function(){return _e.Date.now()},Tt="Expected a function",St=Math.max,kt=Math.min;function jt(e,s,n){var l,b,v,u,i,x,_=0,S=!1,w=!1,y=!0;if(typeof e!="function")throw new TypeError(Tt);s=ve(s)||0,le(n)&&(S=!!n.leading,w="maxWait"in n,v=w?St(ve(n.maxWait)||0,s):v,y="trailing"in n?!!n.trailing:y);function $(m){var E=l,F=b;return l=b=void 0,_=m,u=e.apply(F,E),u}function c(m){return _=m,i=setTimeout(a,s),S?$(m):u}function f(m){var E=m-x,F=m-_,U=s-E;return w?kt(U,v-F):U}function h(m){var E=m-x,F=m-_;return x===void 0||E>=s||E<0||w&&F>=v}function a(){var m=ne();if(h(m))return A(m);i=setTimeout(a,f(m))}function A(m){return i=void 0,y&&l?$(m):(l=b=void 0,u)}function D(){i!==void 0&&clearTimeout(i),_=0,l=x=b=i=void 0}function R(){return i===void 0?u:A(ne())}function M(){var m=ne(),E=h(m);if(l=arguments,b=this,x=m,E){if(i===void 0)return c(x);if(w)return clearTimeout(i),i=setTimeout(a,s),$(x)}return i===void 0&&(i=setTimeout(a,s)),u}return M.cancel=D,M.flush=R,M}const Et={ref:"root"},It={class:"[&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},Ot={class:"xl:flex-2/3 md:flex-3/4"},$t={class:"border-y border-stone-400 py-5 grid grid-cols-4"},Mt={class:"p-2"},At={class:"transImage w-full h-full border relative text-stone-400 border-stone-400 hover:text-stone-700 hover:border-stone-700 flex items-end overflow-hidden xl:h-[120px] md:h-[100px] max-md:h-[70px] after:backdrop-blur-[2px] after:absolute after:content-[''] after:w-full after:h-full after:-z-20"},Ft=["src"],Lt=["src"],Nt={class:"px-2 font-bold max-md:text-[0.8rem]"},Ct={class:"p-2"},Rt={class:"flex"},Ut=["disabled"],zt=["disabled"],Bt={class:"flex-col flex xl:flex-1/3 md:flex-2/4"},Ht={class:"md:sticky md:top-[100px] flex flex-col"},Pt={class:"font-bold xl:text-[6rem] md:text-[3rem] max-md:text-[2rem]"},Dt={class:"px-2"},Vt={class:"flex gap-3 select-none flex-wrap"},Wt={class:"flex"},Yt={class:"flex"},Xt={class:"flex"},Gt={class:"flex"},qt={class:"w-[82%] xl:my-10 md:my-5 max-md:my-5 max-md:sticky max-md:top-[100px]"},Kt={ref:"searchForm",class:"relative group flex-7/12 flex items-center"},Qt={class:"absolute group-focus-within:text-stone-700 text-stone-400",for:"s"},Zt={type:"submit",class:"absolute right-0 hover:cursor-pointer hover:text-stone-700 text-stone-400 z-10"},Jt={class:"xl:flex-2/3 md:flex-2/4"},oe=10,er=ae({__name:"ForumIndex",setup(e){var ie;const s=Be(),n=Ne({isEnterElement:!1,imageSource:""}),l=he(ge),b=Ce(),v=j(()=>b.path.split("/")[1]||"index"),u=I([]),i=I([]),x=I([]),_=async()=>{const d=await Pe();u.value=d.topics.value},S=async()=>{const d=await ue(v.value,{from:0,to:M.value,hot:!1});i.value=d.articles.value},w=async()=>{const d=await ue(v.value,{from:0,to:2,hot:!0});x.value=d.articles.value};be(()=>{w(),_(),S()}),te(v,()=>{i.value=[],M.value=oe,S()});const y=I(1),$=(ie=l==null?void 0:l.value.fetchTopics)!=null?ie:0,c=j(()=>{const d=y.value*$,r=(y.value-1)*$;return{currentMax:d,currentMin:r}}),f=()=>{y.value-=1},h=()=>{y.value+=1},a=I("order");te(a,()=>{He(a.value,i.value)});const A=I(""),D=j(()=>{var L,V;const d=(L=u.value.find(W=>W.name===v.value))!=null?L:null,r=(V=d==null?void 0:d.nickname)!=null?V:"開始聊";return s.alias=r==="同領地"?"開始聊":r,s.inArticleTitle="",d}),R=I(!1),M=I(oe),{y:m}=Re(),E=j(()=>{const d=document.documentElement.scrollHeight,r=window.innerHeight;return{scrollableHeight:d-r,currentScrollY:m.value,windowHeight:r}}),F=jt(async()=>{M.value+=oe,console.log(M.value),await S()},100),U=j(()=>{const{scrollableHeight:d,currentScrollY:r,windowHeight:L}=E.value;return!R.value&&r>0&&(R.value=!0),!!(R.value&&d-r<L*.1)});return te(U,()=>{U.value&&F()}),(d,r)=>{const L=et,V=Ee,W=Ze,J=Ie,ee=je,ye=se("router-link"),Y=se("Icon"),Te=ke;return T(),O("div",Et,[p(L,{isEnterElement:o(n).isEnterElement,"onUpdate:isEnterElement":r[0]||(r[0]=g=>o(n).isEnterElement=g),imageString:o(n).imageSource,"onUpdate:imageString":r[1]||(r[1]=g=>o(n).imageSource=g)},null,8,["isEnterElement","imageString"]),p(V),t("div",It,[o(v)==="index"?(T(),re(J,{key:0,class:"xl:flex xl:item-start xl:py-20 md:flex md:item-start md:py-10 max-md:flex-col max-md:py-6"},{default:G(()=>[r[9]||(r[9]=t("h2",{class:"xl:text-[2.5rem] xl:flex-1/3 md:text-[2rem] md:flex-1/4 max-md:text-[1.5rem]"}," 熱門文章 ",-1)),t("div",Ot,[o(x).length>0?(T(!0),O(C,{key:0},q(o(x),g=>(T(),re(W,{reviewImageObject:o(n),"onUpdate:reviewImageObject":r[2]||(r[2]=X=>N(n)?n.value=X:null),article:g},null,8,["reviewImageObject","article"]))),256)):(T(),O(C,{key:1},[P(" still loading... ")],64))])]),_:1})):Ue("",!0),p(J,{class:"!p-0 !py-10 select-none"},{default:G(()=>[t("div",$t,[o(u).length>0?(T(!0),O(C,{key:0},q(o(u).slice(o(c).currentMin,o(c).currentMax),g=>(T(),O("div",Mt,[p(ye,{to:g.path},{default:G(()=>[t("div",At,[t("img",{src:"".concat(g.image),class:"scale-up filter-[var(--imageTrans)] -right-4 -bottom-2 rounded-full absolute z-10w-20 h-20"},null,8,Ft),t("img",{src:"".concat(g.image),class:"scale-up filter-[var(--imageTrans)] -right-8 -bottom-4 rounded-full absolute opacity-20 z-10 w-40 h-40"},null,8,Lt),t("div",Nt,[p(ee,{text:g.nickname},null,8,["text"])])])]),_:2},1032,["to"])]))),256)):(T(),O(C,{key:1},q(4,g=>t("div",Ct,r[10]||(r[10]=[t("div",{class:"xl:h-[120px] animate-pulse bg-stone-400 md:h-[100px] max-md:h-[70px]"},null,-1)]))),64))]),t("div",Rt,[t("button",{disabled:o(y)===1,class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:-translate-x-10 flex-1/2 flex justify-center border-b border-r border-stone-400 py-1",onClick:f},[p(Y,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-left-large-light"})],8,Ut),t("button",{disabled:o(y)>o(u).length/o($),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:translate-x-10 flex-1/2 flex justify-center border-b border-stone-400 py-1",onClick:h},[p(Y,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-right-large-light"})],8,zt)])]),_:1}),p(J,{ref:"root",class:"w-full pt-10 xl:flex xl:item-start md:flex md:item-start max-lg:flex-col max-md:flex-col"},{default:G(()=>{var g,X,ce,me;return[t("div",Bt,[t("div",Ht,[t("h2",Pt,[p(ee,{text:(X=(g=o(D))==null?void 0:g.nickname)!=null?X:"/*15a"},null,8,["text"])]),t("div",Dt,[p(ee,{text:(me=(ce=o(D))==null?void 0:ce.description)!=null?me:"/*13ad|15a"},null,8,["text"])]),t("div",Vt,[t("div",Wt,[B(t("input",{type:"radio",id:"order",name:"msg",value:"order","onUpdate:modelValue":r[3]||(r[3]=k=>N(a)?a.value=k:null),class:"hidden peer"},null,512),[[K,o(a)]]),r[11]||(r[11]=t("label",{for:"order",class:"border-dashed border-2 border-transparent hover:border-stone-400 flex items-center cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 按順序 ",-1))]),t("div",Yt,[B(t("input",{type:"radio",id:"newest",name:"msg",value:"newest","onUpdate:modelValue":r[4]||(r[4]=k=>N(a)?a.value=k:null),class:"hidden peer"},null,512),[[K,o(a)]]),r[12]||(r[12]=t("label",{for:"newest",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最新 ",-1))]),t("div",Xt,[B(t("input",{type:"radio",id:"mostLiked",name:"mostLiked",value:"mostLiked","onUpdate:modelValue":r[5]||(r[5]=k=>N(a)?a.value=k:null),class:"hidden peer"},null,512),[[K,o(a)]]),r[13]||(r[13]=t("label",{for:"mostLiked",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最多讚 ",-1))]),t("div",Gt,[B(t("input",{type:"radio",id:"worst",name:"msg",value:"worst","onUpdate:modelValue":r[6]||(r[6]=k=>N(a)?a.value=k:null),class:"hidden peer"},null,512),[[K,o(a)]]),r[14]||(r[14]=t("label",{for:"worst",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最爛 ",-1))])]),t("div",qt,[t("form",Kt,[t("label",Qt,[p(Y,{icon:"ic:baseline-search",class:"xl:w-6 xl:h-6 md:w-4.5 md:h-4.5 max-md:w-4 max-md:h-4"})]),B(t("input",{"onUpdate:modelValue":r[7]||(r[7]=k=>N(A)?A.value=k:null),type:"text",id:"s",placeholder:"文章搜尋...",class:"w-full xl:px-7 xl:h-10 xl:text-[1.2rem] md:px-5 md:h-8 md:text-[1rem] max-md:px-5 max-md:h-5 max-md:text-[1rem] outline-none bg-none border-b border-transparent relative border-b-stone-400 focus:border-b-stone-700"},null,512),[[ze,o(A)]]),t("button",Zt,[p(Y,{icon:"stash:arrow-right-large-light",class:"xl:w-6 xl:h-6 md:w-4.5 md:h-4.5 max-md:w-4 max-md:h-4"})])],512)])])]),t("div",Jt,[o(i).length>0?(T(!0),O(C,{key:0},q(o(i),k=>(T(),re(W,{ref_for:!0,ref:"currentArticleScroll",reviewImageObject:o(n),"onUpdate:reviewImageObject":r[8]||(r[8]=Se=>N(n)?n.value=Se:null),article:k},null,8,["reviewImageObject","article"]))),256)):(T(),O(C,{key:1},[P(" still loading... ")],64))])]}),_:1},512)]),p(Te)],512)}}}),ir=Oe(er,[["__scopeId","data-v-67247612"]]);export{ir as default};

System.register(["./SiteScroll.vue_vue_type_script_setup_true_lang-legacy-f1gvvJaL.js","./NavigationTempl.vue_vue_type_script_setup_true_lang-legacy-DPo_OE1L.js","./DomainTime.vue_vue_type_script_setup_true_lang-legacy-CNTwJqso.js","./index-legacy-DT6CjNYs.js","./Constant-legacy-C2LnN0pO.js"],(function(e,t){"use strict";var a,l,r,n,i,o,s,d,c,m,u,x,p,v,f,h,g,b,y,w,_,j,k,E,T,z,S,O,I,M,U,C,L,$,H,N,A,D,F,V,W,Y,R,q,B,G,P,Q;return{setters:[e=>{a=e._},e=>{l=e.a,r=e.b,n=e.e,i=e.f,o=e.D,s=e.q,d=e.w,c=e.i,m=e.l,u=e.o,x=e.c,p=e._},e=>{v=e._},e=>{f=e.d,h=e.y,g=e.H,b=e.b,y=e.g,w=e.i,_=e.r,j=e.c,k=e.o,E=e.e,T=e.j,z=e.t,S=e.f,O=e.S,I=e.U,M=e.V,U=e.h,C=e.L,L=e.B,$=e.W,H=e.u,N=e.X,A=e.G,D=e.Y,F=e.Z,V=e.z,W=e.Q,Y=e.A,R=e.F,q=e.C,B=e.E,G=e._,P=e.D,Q=e.R},null],execute:function(){var t=document.createElement("style");t.textContent=".transImage[data-v-007fd147]{--imageTrans: invert(73%) sepia(13%) saturate(147%) hue-rotate(345deg) brightness(88%) contrast(85%) }.transImage[data-v-007fd147]:hover{--imageTrans: filter: invert(24%) sepia(6%) saturate(733%) hue-rotate(353deg) brightness(93%) contrast(89%) }@keyframes scale-up-007fd147{0%{scale:0}to{scale:1}}.scale-up[data-v-007fd147]{animation:scale-up-007fd147 .3s ease-out forwards}\n/*$vite$:1*/",document.head.appendChild(t);const X={class:"border-b w-full flex items-end font-bold cursor-pointer border-stone-400 text-stone-400 hover:mix-blend-difference"},Z={class:"xl:pt-2 md:pt-1 max-md:pt-0.5"},J={class:"break-all line-clamp-2 text-stone-400/50 xl:w-[calc(1.25rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},K={class:"break-all line-clamp-2 xl:w-[calc(1.5rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},ee={class:"flex flex-col ml-auto xl:text-[1.2rem] md:text-[1rem] max-md:text-[0.8rem]"},te={class:"flex justify-end gap-5"},ae={class:"flex gap-1 items-center"},le={class:"flex gap-1 items-center"},re=f({__name:"ReviewArticleTempl",props:h({article:{}},{forumTemplModels:{},forumTemplModelsModifiers:{},reviewImageObject:{},reviewImageObjectModifiers:{}}),emits:["update:forumTemplModels","update:reviewImageObject"],setup(e){const t=g(),a=e,l=b(e,"forumTemplModels"),r=b(e,"reviewImageObject"),n=y(""),i=w((()=>l.value?.alias||a.article.alias)),o=w((()=>(n.value=l.value?.path||a.article.path,l.value?.path||a.article.path))),s=w((()=>l.value?.time||a.article.time)),d=w((()=>{const e=l.value?.analyze.rating||a.article.analyze.rating;return{nice:e.nice,bad:e.bad}}));w((()=>l.value?.analyze.views||a.article.analyze.views));const c=w((()=>{const e=l.value?.history.length||a.article.history.length;return l.value?.history[e-1].articleTitle||a.article.history[e-1].articleTitle})),m=()=>{r.value.isEnterElement=!1};return(e,a)=>{const l=_("Icon"),r=v;return k(),j("div",{onMouseleave:m},[E("div",{onClick:a[0]||(a[0]=e=>{return a=T(o),void t.push({path:a});var a})},[E("div",X,[E("span",Z,[E("p",J,z(T(i)),1),E("p",K,z(T(c)),1)]),E("span",ee,[E("div",te,[E("p",ae,[S(l,{icon:"ic:round-thumb-up-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),O(" "+z(T(d).nice),1)]),E("p",le,[S(l,{icon:"ic:round-thumb-down-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),O(" "+z(T(d).bad),1)])]),E("p",null,[S(r,{paramTime:T(s),fromNow:""},null,8,["paramTime"])])])])])],32)}}}),ne=["src"],ie=f({__name:"followWhatYouSee",props:{imageString:{},imageStringModifiers:{},isEnterElement:{type:Boolean},isEnterElementModifiers:{}},emits:["update:imageString","update:isEnterElement"],setup(e){I($);const t=y(),a=b(e,"imageString"),l=b(e,"isEnterElement"),{x:r,y:n}=M();let i,o=0,s=0,d=0,c=0;return U((()=>{const e=()=>{o=r.value,s=n.value,d+=.08*(o-d),c+=.08*(s-c),t.value.style.top=`${c}px`,t.value.style.left=`${d}px`,i=requestAnimationFrame(e)};e()})),C((()=>{cancelAnimationFrame(i)})),(e,r)=>(k(),j("div",{ref_key:"movingDiv",ref:t,class:"absolute -z-10 pointer-events-none select-none"},[E("div",{class:"absolute -z-20 object-cover -translate-1/2 md:w-[202px] max-md:w-[122px] transition-[height] duration-[0.3s] bg-stone-700 mix-blend-difference",style:L({height:l.value?0:"0px"})},null,4),E("img",{src:a.value,class:"object-cover -translate-1/2 md:w-[200px] max-md:w-[120px] transition-[height] duration-[0.3s]",style:L({height:l.value?0:"0px"})},null,12,ne)],512))}});var oe="object"==typeof global&&global&&global.Object===Object&&global,se="object"==typeof self&&self&&self.Object===Object&&self,de=oe||se||Function("return this")(),ce=de.Symbol,me=Object.prototype,ue=me.hasOwnProperty,xe=me.toString,pe=ce?ce.toStringTag:void 0,ve=Object.prototype.toString,fe=ce?ce.toStringTag:void 0;function he(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":fe&&fe in Object(e)?function(e){var t=ue.call(e,pe),a=e[pe];try{e[pe]=void 0;var l=!0}catch(n){}var r=xe.call(e);return l&&(t?e[pe]=a:delete e[pe]),r}(e):function(e){return ve.call(e)}(e)}var ge=/\s/,be=/^\s+/;function ye(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&ge.test(e.charAt(t)););return t}(e)+1).replace(be,""):e}function we(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var _e=/^[-+]0x[0-9a-f]+$/i,je=/^0b[01]+$/i,ke=/^0o[0-7]+$/i,Ee=parseInt;function Te(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==he(e)}(e))return NaN;if(we(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=we(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ye(e);var a=je.test(e);return a||ke.test(e)?Ee(e.slice(2),a?2:8):_e.test(e)?NaN:+e}var ze=function(){return de.Date.now()},Se=Math.max,Oe=Math.min;function Ie(e,t,a){var l,r,n,i,o,s,d=0,c=!1,m=!1,u=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function x(t){var a=l,n=r;return l=r=void 0,d=t,i=e.apply(n,a)}function p(e){var a=e-s;return void 0===s||a>=t||a<0||m&&e-d>=n}function v(){var e=ze();if(p(e))return f(e);o=setTimeout(v,function(e){var a=t-(e-s);return m?Oe(a,n-(e-d)):a}(e))}function f(e){return o=void 0,u&&l?x(e):(l=r=void 0,i)}function h(){var e=ze(),a=p(e);if(l=arguments,r=this,s=e,a){if(void 0===o)return function(e){return d=e,o=setTimeout(v,t),c?x(e):i}(s);if(m)return clearTimeout(o),o=setTimeout(v,t),x(s)}return void 0===o&&(o=setTimeout(v,t)),i}return t=Te(t)||0,we(a)&&(c=!!a.leading,n=(m="maxWait"in a)?Se(Te(a.maxWait)||0,t):n,u="trailing"in a?!!a.trailing:u),h.cancel=function(){void 0!==o&&clearTimeout(o),d=0,l=s=r=o=void 0},h.flush=function(){return void 0===o?i:f(ze())},h}const Me={ref:"root"},Ue={class:"[&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},Ce={class:"xl:flex-2/3 md:flex-3/4"},Le={class:"border-y border-stone-400 py-5 grid grid-cols-3"},$e={class:"p-2"},He={class:"transImage w-full h-full border relative text-stone-400 border-stone-400 hover:text-stone-700 hover:border-stone-700 flex items-end overflow-hidden xl:h-[120px] md:h-[100px] max-md:h-[70px] after:backdrop-blur-[2px] after:absolute after:content-[''] after:w-full after:h-full after:-z-20"},Ne=["src"],Ae=["src"],De={class:"px-2 font-bold max-md:text-[0.8rem]"},Fe={class:"p-2"},Ve={class:"flex"},We=["disabled"],Ye=["disabled"],Re={class:"flex-col flex xl:flex-1/3 md:flex-2/4"},qe={class:"md:sticky md:top-[100px] flex flex-col"},Be={class:"font-bold xl:text-[6rem] md:text-[3rem] max-md:text-[2rem]"},Ge={class:"px-2"},Pe={class:"flex gap-3 select-none flex-wrap"},Qe={class:"flex"},Xe={class:"flex"},Ze={class:"flex"},Je={class:"flex"},Ke={class:"w-[82%] xl:my-10 md:my-5 max-md:my-5 max-md:sticky max-md:top-[100px]"},et={ref:"searchForm",class:"relative group flex-7/12 flex items-center"},tt={class:"absolute group-focus-within:text-stone-700 text-stone-400",for:"s"},at={class:"xl:flex-2/3 md:flex-2/4"};e("default",p(f({__name:"ForumIndex",setup(e){const t=H(),p=N({isEnterElement:!1,imageSource:""}),v=I($),f=A(),h=w((()=>f.path.split("/")[1]||"index")),g=y([]),b=y([]),z=y([]),M=y(!1),C=y(!0),L=y(null),X=async(e=!1)=>{if(!M.value&&C.value){M.value=!0;try{let t;const a=g.value.find((e=>e.name===h.value))?.articleIDs||[],l=n(o,"articles"),r=a.slice(0,de.value);console.log(r),e?(b.value=[],L.value=null,C.value=!0,t=s(l,d("xid","in",r))):t=s(l,d("xid","in",r),c(L.value));const m=await i(t);if(console.log(m.docs),m.empty)return C.value=!1,void(M.value=!1);const u=m.docs[m.docs.length-1];L.value=u,m.forEach((e=>{b.value.push({...e.data()})}))}catch(t){console.error(t)}finally{M.value=!1}}},Z=Ie((async()=>{!M.value&&C.value&&await X(!1)}),300);U((async()=>{await(async()=>{const e=n(o,"topics");(await i(e)).forEach((e=>{g.value.push({...e.data()})}))})(),X(!0),(async()=>{if(z.value.length>0)return;const e=n(o,"articles"),t=s(e,u("time","desc"),m(2));(await i(t)).forEach((e=>{z.value.push({...e.data()})}))})()})),D(h,(()=>{le.value="order",M.value=!1,C.value=!0,X(!0)}));const J=y(1),K=v?.value.fetchTopics??0,ee=w((()=>({currentMax:J.value*K,currentMin:(J.value-1)*K}))),te=()=>{J.value-=1},ae=()=>{J.value+=1},le=y("order");D(le,(()=>{((e,t)=>{switch(e){case"hot":return t.sort(((e,t)=>t.analyze.views+t.analyze.rating.nice+t.analyze.rating.bad-(e.analyze.views+e.analyze.rating.nice+e.analyze.rating.bad)));case"cool":return t.sort(((e,t)=>{const a=t.analyze.views+t.analyze.rating.nice+t.analyze.rating.bad;return e.analyze.views+e.analyze.rating.nice+e.analyze.rating.bad-a}));case"newest":return console.log(t),t.sort(((e,t)=>t.time-e.time));case"order":return t.sort(((e,t)=>e.time-t.time));case"mostLiked":return t.sort(((e,t)=>t.analyze.rating.nice-e.analyze.rating.nice));case"worst":t.sort(((e,t)=>e.analyze.rating.bad-t.analyze.rating.bad))}})(le.value,b.value)}));const ne=y("");D(ne,Ie((()=>{(async()=>{if(!ne.value.trim())return M.value=!1,C.value=!0,void(await X(!0));try{M.value=!0,b.value=[];const e=n(o,"articles"),t=await i(e),a=ne.value.toLowerCase();t.forEach((e=>{const t={...e.data()},l=t.history.length-1;(t.history[l].articleTitle.toLowerCase().includes(a)||t.history[l].articleHtmlRef.toLowerCase().includes(a))&&b.value.push(t)})),C.value=!1}catch(e){console.error("Error searching articles:",e)}finally{M.value=!1}})()}),500));const oe=w((()=>{const e=g.value.find((e=>e.name===h.value))??null,a=e?.nickname??"開始聊";return t.topicTitle="同領地"===a?"開始聊":a,t.articleTitle="",e})),se=y(!1),de=y(5),{y:ce}=F(),me=w((()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return{scrollableHeight:e-t,currentScrollY:ce.value,windowHeight:t}})),ue=w((()=>{const{scrollableHeight:e,currentScrollY:t,windowHeight:a}=me.value;return!se.value&&t>0&&(se.value=!0),!!(se.value&&e-t<.1*a)}));return D(ue,(()=>{ue.value&&(de.value+=5,Z())})),(e,t)=>{const n=ie,i=l,o=re,s=r,d=x,c=_("router-link"),m=_("Icon"),u=a;return k(),j("div",Me,[S(n,{isEnterElement:T(p).isEnterElement,"onUpdate:isEnterElement":t[0]||(t[0]=e=>T(p).isEnterElement=e),imageString:T(p).imageSource,"onUpdate:imageString":t[1]||(t[1]=e=>T(p).imageSource=e)},null,8,["isEnterElement","imageString"]),S(i),E("div",Ue,["index"===T(h)?(k(),V(s,{key:0,class:"xl:flex xl:item-start xl:py-20 md:flex md:item-start md:py-10 max-md:flex-col max-md:py-6"},{default:Y((()=>[t[9]||(t[9]=E("h2",{class:"xl:text-[2.5rem] xl:flex-1/3 md:text-[2rem] md:flex-1/4 max-md:text-[1.5rem]"}," 熱門文章 ",-1)),E("div",Ce,[T(z).length>0?(k(!0),j(R,{key:0},q(T(z),(e=>(k(),V(o,{reviewImageObject:T(p),"onUpdate:reviewImageObject":t[2]||(t[2]=e=>P(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),256)):(k(),j(R,{key:1},[O(" still loading... ")],64))])])),_:1})):W("",!0),S(s,{class:"!p-0 !py-10 select-none"},{default:Y((()=>[E("div",Le,[T(g).length>0?(k(!0),j(R,{key:0},q(T(g).slice(T(ee).currentMin,T(ee).currentMax),(e=>(k(),j("div",$e,[S(c,{to:e.path},{default:Y((()=>[E("div",He,[E("img",{src:`${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-4 -bottom-2 rounded-full absolute z-10w-20 h-20"},null,8,Ne),E("img",{src:`${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-8 -bottom-4 rounded-full absolute opacity-20 z-10 w-40 h-40"},null,8,Ae),E("div",De,[S(d,{text:e.nickname},null,8,["text"])])])])),_:2},1032,["to"])])))),256)):(k(),j(R,{key:1},q(3,(e=>E("div",Fe,t[10]||(t[10]=[E("div",{class:"xl:h-[120px] animate-pulse bg-stone-400 md:h-[100px] max-md:h-[70px]"},null,-1)])))),64))]),E("div",Ve,[E("button",{disabled:1===T(J),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:-translate-x-10 flex-1/2 flex justify-center border-b border-r border-stone-400 py-1",onClick:te},[S(m,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-left-large-light"})],8,We),E("button",{disabled:T(J)>T(g).length/T(K),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:translate-x-10 flex-1/2 flex justify-center border-b border-stone-400 py-1",onClick:ae},[S(m,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-right-large-light"})],8,Ye)])])),_:1}),S(s,{ref:"root",class:"w-full py-10 xl:flex xl:item-start md:flex md:item-start max-lg:flex-col max-md:flex-col"},{default:Y((()=>[E("div",Re,[E("div",qe,[E("h2",Be,[S(d,{text:T(oe)?.nickname??"/*15a"},null,8,["text"])]),E("div",Ge,[S(d,{text:T(oe)?.description??"/*13ad|15a"},null,8,["text"])]),E("div",Pe,[E("div",Qe,[B(E("input",{type:"radio",id:"order",name:"msg",value:"order","onUpdate:modelValue":t[3]||(t[3]=e=>P(le)?le.value=e:null),class:"hidden peer"},null,512),[[G,T(le)]]),t[11]||(t[11]=E("label",{for:"order",class:"border-dashed border-2 border-transparent hover:border-stone-400 flex items-center cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 按順序 ",-1))]),E("div",Xe,[B(E("input",{type:"radio",id:"newest",name:"msg",value:"newest","onUpdate:modelValue":t[4]||(t[4]=e=>P(le)?le.value=e:null),class:"hidden peer"},null,512),[[G,T(le)]]),t[12]||(t[12]=E("label",{for:"newest",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最新 ",-1))]),E("div",Ze,[B(E("input",{type:"radio",id:"mostLiked",name:"mostLiked",value:"mostLiked","onUpdate:modelValue":t[5]||(t[5]=e=>P(le)?le.value=e:null),class:"hidden peer"},null,512),[[G,T(le)]]),t[13]||(t[13]=E("label",{for:"mostLiked",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最多讚 ",-1))]),E("div",Je,[B(E("input",{type:"radio",id:"worst",name:"msg",value:"worst","onUpdate:modelValue":t[6]||(t[6]=e=>P(le)?le.value=e:null),class:"hidden peer"},null,512),[[G,T(le)]]),t[14]||(t[14]=E("label",{for:"worst",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最爛 ",-1))])]),E("div",Ke,[E("form",et,[E("label",tt,[S(m,{icon:"ic:baseline-search",class:"xl:w-6 xl:h-6 md:w-4.5 md:h-4.5 max-md:w-4 max-md:h-4"})]),B(E("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>P(ne)?ne.value=e:null),type:"text",id:"s",placeholder:"文章搜尋...",class:"w-full xl:px-7 xl:h-10 xl:text-[1.2rem] md:px-5 md:h-8 md:text-[1rem] max-md:px-5 max-md:h-5 max-md:text-[1rem] outline-none bg-none border-b border-transparent relative border-b-stone-400 focus:border-b-stone-700"},null,512),[[Q,T(ne)]])],512)])])]),E("div",at,[T(b).length>0?(k(!0),j(R,{key:0},q(T(b),(e=>(k(),V(o,{key:e.xid,ref_for:!0,ref:"currentArticleScroll",reviewImageObject:T(p),"onUpdate:reviewImageObject":t[8]||(t[8]=e=>P(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),128)):(k(),j(R,{key:1},[O(" still loading... ")],64))])])),_:1},512)]),S(u)],512)}}}),[["__scopeId","data-v-007fd147"]]))}}}));

var pe=Object.defineProperty;var me=(s,t,e)=>t in s?pe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Z=(s,t,e)=>me(s,typeof t!="symbol"?t+"":t,e);import{i as ge,r as xe,u as we,A as F,_ as ye,T as be}from"./DomainTime.vue_vue_type_script_setup_true_lang-lbZBLFQD.js";import{d as At,M as ve,o as qt,N as Vt,s as Se,r as G,p as Te,m as Ee,u as p,O as ke,P as Ce,Q as Oe,R as tt,i as $t,c as X,S as Ne,g as Yt,h as Ie,a as It,F as Kt,H as ze,e as f,U as De,f as I,t as St,n as P,j as Re,G as ut,V as Ft,E as Ae,L as Ht,K as Je,b as zt,A as Bt}from"./index-0VZNout-.js";import{D as Zt,a as Qt,b as Me,_ as Pe,c as Le,d as $e,e as wt,P as yt,f as bt,N as B,T as Fe,S as He,F as Be,h as We,i as Ue,E as _e,G as je,j as st,k as Ge}from"./TipTap_Extensions-BSBZSbuK.js";import{d as ht,D as ft,g as qe,u as Tt,h as Et,s as Ve,_ as Ye,a as Ke,b as Ze,c as Qe}from"./NavigationTempl.vue_vue_type_script_setup_true_lang-D9DEyRyL.js";const Xe=Object.freeze(Object.defineProperty({__proto__:null,Decoration:Zt,DecorationSet:Qt,EditorView:Me,__endComposition:Pe,__parseFromClipboard:Le},Symbol.toStringTag,{value:"Module"}));function Wt(s){return Oe((t,e)=>({get(){return t(),s},set(r){s=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}}))}class tr extends $e{constructor(t={}){return super(t),this.contentComponent=null,this.appContext=null,this.reactiveState=Wt(this.view.state),this.reactiveExtensionStorage=Wt(this.extensionStorage),this.on("beforeTransaction",({nextState:e})=>{this.reactiveState.value=e,this.reactiveExtensionStorage.value=this.extensionStorage}),Ce(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,e){const r=super.registerPlugin(t,e);return this.reactiveState&&(this.reactiveState.value=r),r}unregisterPlugin(t){const e=super.unregisterPlugin(t);return this.reactiveState&&e&&(this.reactiveState.value=e),e}}const er=At({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(s){const t=G(),e=ke();return Te(()=>{const r=s.editor;r&&r.options.element&&t.value&&Ee(()=>{if(!t.value||!r.options.element.firstChild)return;const n=p(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=e.ctx._,e&&(r.appContext={...e.appContext,provides:e.provides}),r.setOptions({element:n}),r.createNodeViews()})}),Vt(()=>{const r=s.editor;r&&(r.contentComponent=null,r.appContext=null)}),{rootEl:t}},render(){return Se("div",{ref:s=>{this.rootEl=s}})}}),rr=(s={})=>{const t=ve();return qt(()=>{t.value=new tr(s)}),Vt(()=>{var e,r,n;const o=(e=t.value)===null||e===void 0?void 0:e.options.element,a=o==null?void 0:o.cloneNode(!0);(r=o==null?void 0:o.parentNode)===null||r===void 0||r.replaceChild(a,o),(n=t.value)===null||n===void 0||n.destroy()}),t};function nr(){try{return Xe}catch(s){return null}}function sr(s,t){if(s&&typeof s.serializeForClipboard=="function")return s.serializeForClipboard(t);const e=nr();if(e&&typeof(e==null?void 0:e.__serializeForClipboard)=="function")return e.__serializeForClipboard(s,t);throw new Error("No supported clipboard serialization method found.")}function or(s){const t=s.getBoundingClientRect(),e=s.closest('[role="dialog"]');if(e&&window.getComputedStyle(e).transform!=="none"){const r=e.getBoundingClientRect();return{top:t.top-r.top,left:t.left-r.left,width:t.width}}return{top:t.top,left:t.left,width:t.width}}function Ut(s,t){const e=["li","p:not(:first-child)","pre","blockquote","h1","h2","h3","h4","h5","h6",...t.customNodes.map(r=>"[data-type=".concat(r,"]"))].join(", ");return document.elementsFromPoint(s.x,s.y).find(r=>{var n,o;return((o=(n=r.parentElement)==null?void 0:n.matches)==null?void 0:o.call(n,".ProseMirror"))||r.matches(e)})}function ir(s,t,e){var n;const r=s.getBoundingClientRect();return(n=t.posAtCoords({left:r.left+50+e.dragHandleWidth,top:r.top+1}))==null?void 0:n.inside}function _t(s,t){const e=t.state.doc.resolve(s);return e.depth>1?e.before(e.depth):s}function ar(s){let t="";function e(i,l){if(l.focus(),!i.dataTransfer)return;const u=Ut({x:i.clientX+50+s.dragHandleWidth,y:i.clientY},s);if(!(u instanceof Element))return;let d=ir(u,l,s);if(d==null||d<0)return;d=_t(d,l);const{from:w,to:E}=l.state.selection,k=w-E,z=_t(w,l);let y=!1;const N=l.state.doc.resolve(z);if(N.node().type.name==="doc")y=!0;else{const H=B.create(l.state.doc,N.before());y=!(d+1>=H.$from.pos&&d<=H.$to.pos)}let M=l.state.selection;if(!y&&k!==0&&!(l.state.selection instanceof B)){const H=B.create(l.state.doc,E-1);M=Fe.create(l.state.doc,d,H.$to.pos)}else if(M=B.create(l.state.doc,d),M.node.type.isInline||M.node.type.name==="tableRow"){let H=l.state.doc.resolve(M.from);M=B.create(l.state.doc,H.before())}l.dispatch(l.state.tr.setSelection(M)),l.state.selection instanceof B&&l.state.selection.node.type.name==="listItem"&&(t=u.parentElement.tagName);const ct=l.state.selection.content(),{dom:K,text:vt}=sr(l,ct);i.dataTransfer.clearData(),i.dataTransfer.setData("text/html",K.innerHTML),i.dataTransfer.setData("text/plain",vt),i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setDragImage(u,0,0),l.dragging={slice:ct,move:i.ctrlKey}}let r=null;function n(){r&&r.classList.add("hide")}function o(){r&&r.classList.remove("hide")}function a(i){if(i.target instanceof Element){const l=i.relatedTarget;if((l==null?void 0:l.classList.contains("tiptap"))||(l==null?void 0:l.classList.contains("drag-handle")))return}n()}return new yt({key:new bt(s.pluginKey),view:i=>{var w,E,k,z;const l=s.dragHandleSelector?document.querySelector(s.dragHandleSelector):null;r=l!=null?l:document.createElement("div"),r.draggable=!0,r.dataset.dragHandle="",r.classList.add("drag-handle");function u(y){e(y,i)}r.addEventListener("dragstart",u);function d(y){n();let N=window.scrollY;y.clientY<s.scrollTreshold?window.scrollTo({top:N-30,behavior:"smooth"}):window.innerHeight-y.clientY<s.scrollTreshold&&window.scrollTo({top:N+30,behavior:"smooth"})}return r.addEventListener("drag",d),n(),l||(E=(w=i==null?void 0:i.dom)==null?void 0:w.parentElement)==null||E.appendChild(r),(z=(k=i==null?void 0:i.dom)==null?void 0:k.parentElement)==null||z.addEventListener("mouseout",a),{destroy:()=>{var y,N,M;l||(y=r==null?void 0:r.remove)==null||y.call(r),r==null||r.removeEventListener("drag",d),r==null||r.removeEventListener("dragstart",u),r=null,(M=(N=i==null?void 0:i.dom)==null?void 0:N.parentElement)==null||M.removeEventListener("mouseout",a)}}},props:{handleDOMEvents:{mousemove:(i,l)=>{if(!i.editable)return;const u=Ut({x:l.clientX+50+s.dragHandleWidth,y:l.clientY},s),d=u==null?void 0:u.closest(".not-draggable"),w=s.excludedTags.concat(["ol","ul"]).join(", ");if(!(u instanceof Element)||u.matches(w)||d){n();return}const E=window.getComputedStyle(u),k=parseInt(E.lineHeight,10),z=isNaN(k)?parseInt(E.fontSize)*1.2:k,y=parseInt(E.paddingTop,10),N=or(u);N.top+=(z-24)/2,N.top+=y,u.matches("ul:not([data-type=taskList]) li, ol li")&&(N.left-=s.dragHandleWidth),N.width=s.dragHandleWidth,r&&(r.style.left="".concat(N.left-N.width,"px"),r.style.top="".concat(N.top,"px"),o())},keydown:()=>{n()},mousewheel:()=>{n()},dragstart:i=>{i.dom.classList.add("dragging")},drop:(i,l)=>{var k;i.dom.classList.remove("dragging"),n();let u=null;const d=i.posAtCoords({left:l.clientX,top:l.clientY});if(!d||(i.state.selection instanceof B&&(u=i.state.selection.node),!u))return;const E=i.state.doc.resolve(d.pos).parent.type.name==="listItem";if(i.state.selection instanceof B&&i.state.selection.node.type.name==="listItem"&&!E&&t=="OL"){const z=(k=i.state.schema.nodes.orderedList)==null?void 0:k.createAndFill(null,u),y=new He(Be.from(z),0,0);i.dragging={slice:y,move:l.ctrlKey}}},dragend:i=>{i.dom.classList.remove("dragging")}}}})}const lr=wt.create({name:"globalDragHandle",addOptions(){return{dragHandleWidth:20,scrollTreshold:100,excludedTags:[],customNodes:[]}},addProseMirrorPlugins(){return[ar({pluginKey:"globalDragHandle",dragHandleWidth:this.options.dragHandleWidth,scrollTreshold:this.options.scrollTreshold,dragHandleSelector:this.options.dragHandleSelector,excludedTags:this.options.excludedTags,customNodes:this.options.customNodes})]}});function Xt(s,t,e){for(let r=0;;r++){if(r==s.childCount||r==t.childCount)return s.childCount==t.childCount?null:e;let n=s.child(r),o=t.child(r);if(n==o){e+=n.nodeSize;continue}if(!n.sameMarkup(o))return e;if(n.isText&&n.text!=o.text){for(let a=0;n.text[a]==o.text[a];a++)e++;return e}if(n.content.size||o.content.size){let a=Xt(n.content,o.content,e+1);if(a!=null)return a}e+=n.nodeSize}}function te(s,t,e,r){for(let n=s.childCount,o=t.childCount;;){if(n==0||o==0)return n==o?null:{a:e,b:r};let a=s.child(--n),i=t.child(--o),l=a.nodeSize;if(a==i){e-=l,r-=l;continue}if(!a.sameMarkup(i))return{a:e,b:r};if(a.isText&&a.text!=i.text){let u=0,d=Math.min(a.text.length,i.text.length);for(;u<d&&a.text[a.text.length-u-1]==i.text[i.text.length-u-1];)u++,e--,r--;return{a:e,b:r}}if(a.content.size||i.content.size){let u=te(a.content,i.content,e-1,r-1);if(u)return u}e-=l,r-=l}}class T{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,n=0,o){for(let a=0,i=0;i<e;a++){let l=this.content[a],u=i+l.nodeSize;if(u>t&&r(l,n+i,o||null,a)!==!1&&l.content.size){let d=i+1;l.nodesBetween(Math.max(0,t-d),Math.min(l.content.size,e-d),r,n+d)}i=u}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,n){let o="",a=!0;return this.nodesBetween(t,e,(i,l)=>{let u=i.isText?i.text.slice(Math.max(t,l)-l,e-l):i.isLeaf?n?typeof n=="function"?n(i):n:i.type.spec.leafText?i.type.spec.leafText(i):"":"";i.isBlock&&(i.isLeaf&&u||i.isTextblock)&&r&&(a?a=!1:o+=r),o+=u},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,n=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(r)&&(n[n.length-1]=e.withText(e.text+r.text),o=1);o<t.content.length;o++)n.push(t.content[o]);return new T(n,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],n=0;if(e>t)for(let o=0,a=0;a<e;o++){let i=this.content[o],l=a+i.nodeSize;l>t&&((a<t||l>e)&&(i.isText?i=i.cut(Math.max(0,t-a),Math.min(i.text.length,e-a)):i=i.cut(Math.max(0,t-a-1),Math.min(i.content.size,e-a-1))),r.push(i),n+=i.nodeSize),a=l}return new T(r,n)}cutByIndex(t,e){return t==e?T.empty:t==0&&e==this.content.length?this:new T(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let n=this.content.slice(),o=this.size+e.nodeSize-r.nodeSize;return n[t]=e,new T(n,o)}addToStart(t){return new T([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new T(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let n=this.content[e];t(n,r,e),r+=n.nodeSize}}findDiffStart(t,e=0){return Xt(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return te(this,t,e,r)}findIndex(t,e=-1){if(t==0)return pt(0,t);if(t==this.size)return pt(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position ".concat(t," outside of fragment (").concat(this,")"));for(let r=0,n=0;;r++){let o=this.child(r),a=n+o.nodeSize;if(a>=t)return a==t||e>0?pt(r+1,a):pt(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return T.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new T(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return T.empty;let e,r=0;for(let n=0;n<t.length;n++){let o=t[n];r+=o.nodeSize,n&&o.isText&&t[n-1].sameMarkup(o)?(e||(e=t.slice(0,n)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new T(e||t,r)}static from(t){if(!t)return T.empty;if(t instanceof T)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new T([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}T.empty=new T([],0);const kt={index:0,offset:0};function pt(s,t){return kt.index=s,kt.offset=t,kt}class cr extends Error{}class O{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=re(this.content,t+this.openStart,e);return r&&new O(r,this.openStart,this.openEnd)}removeBetween(t,e){return new O(ee(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return O.empty;let r=e.openStart||0,n=e.openEnd||0;if(typeof r!="number"||typeof n!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new O(T.fromJSON(t,e.content),r,n)}static maxOpen(t,e=!0){let r=0,n=0;for(let o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=t.lastChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.lastChild)n++;return new O(t,r,n)}}O.empty=new O(T.empty,0,0);function ee(s,t,e){let{index:r,offset:n}=s.findIndex(t),o=s.maybeChild(r),{index:a,offset:i}=s.findIndex(e);if(n==t||o.isText){if(i!=e&&!s.child(a).isText)throw new RangeError("Removing non-flat range");return s.cut(0,t).append(s.cut(e))}if(r!=a)throw new RangeError("Removing non-flat range");return s.replaceChild(r,o.copy(ee(o.content,t-n-1,e-n-1)))}function re(s,t,e,r){let{index:n,offset:o}=s.findIndex(t),a=s.maybeChild(n);if(o==t||a.isText)return s.cut(0,t).append(e).append(s.cut(t));let i=re(a.content,t-o-1,e);return i&&s.replaceChild(n,a.copy(i))}const ne=65535,se=Math.pow(2,16);function dr(s,t){return s+t*se}function jt(s){return s&ne}function ur(s){return(s-(s&ne))/se}const oe=1,ie=2,gt=4,ae=8;class Gt{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&ae)>0}get deletedBefore(){return(this.delInfo&(oe|gt))>0}get deletedAfter(){return(this.delInfo&(ie|gt))>0}get deletedAcross(){return(this.delInfo&gt)>0}}class J{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&J.empty)return J.empty}recover(t){let e=0,r=jt(t);if(!this.inverted)for(let n=0;n<r;n++)e+=this.ranges[n*3+2]-this.ranges[n*3+1];return this.ranges[r*3]+e+ur(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let n=0,o=this.inverted?2:1,a=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let l=this.ranges[i]-(this.inverted?n:0);if(l>t)break;let u=this.ranges[i+o],d=this.ranges[i+a],w=l+u;if(t<=w){let E=u?t==l?-1:t==w?1:e:e,k=l+n+(E<0?0:d);if(r)return k;let z=t==(e<0?l:w)?null:dr(i/3,t-l),y=t==l?ie:t==w?oe:gt;return(e<0?t!=l:t!=w)&&(y|=ae),new Gt(k,y,z)}n+=d-u}return r?t+n:new Gt(t+n,0,null)}touches(t,e){let r=0,n=jt(e),o=this.inverted?2:1,a=this.inverted?1:2;for(let i=0;i<this.ranges.length;i+=3){let l=this.ranges[i]-(this.inverted?r:0);if(l>t)break;let u=this.ranges[i+o],d=l+u;if(t<=d&&i==n*3)return!0;r+=this.ranges[i+a]-u}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let n=0,o=0;n<this.ranges.length;n+=3){let a=this.ranges[n],i=a-(this.inverted?o:0),l=a+(this.inverted?0:o),u=this.ranges[n+e],d=this.ranges[n+r];t(i,i+u,l,l+d),o+=d-u}}invert(){return new J(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?J.empty:new J(t<0?[0,-t,0]:[0,0,t])}}J.empty=new J([]);const Ct=Object.create(null);class D{getMap(){return J.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ct[e.stepType];if(!r)throw new RangeError("No step type ".concat(e.stepType," defined"));return r.fromJSON(t,e)}static jsonID(t,e){if(t in Ct)throw new RangeError("Duplicate use of step JSON ID "+t);return Ct[t]=e,e.prototype.jsonID=t,e}}class C{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new C(t,null)}static fail(t){return new C(null,t)}static fromReplace(t,e,r,n){try{return C.ok(t.replace(e,r,n))}catch(o){if(o instanceof cr)return C.fail(o.message);throw o}}}function Jt(s,t,e){let r=[];for(let n=0;n<s.childCount;n++){let o=s.child(n);o.content.size&&(o=o.copy(Jt(o.content,t,o))),o.isInline&&(o=t(o,e,n)),r.push(o)}return T.fromArray(r)}class q extends D{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),n=r.node(r.sharedDepth(this.to)),o=new O(Jt(e.content,(a,i)=>!a.isAtom||!i.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),n),e.openStart,e.openEnd);return C.fromReplace(t,this.from,this.to,o)}invert(){return new V(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new q(e.pos,r.pos,this.mark)}merge(t){return t instanceof q&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new q(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new q(e.from,e.to,t.markFromJSON(e.mark))}}D.jsonID("addMark",q);class V extends D{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new O(Jt(e.content,n=>n.mark(this.mark.removeFromSet(n.marks)),t),e.openStart,e.openEnd);return C.fromReplace(t,this.from,this.to,r)}invert(){return new q(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new V(e.pos,r.pos,this.mark)}merge(t){return t instanceof V&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new V(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new V(e.from,e.to,t.markFromJSON(e.mark))}}D.jsonID("removeMark",V);class Y extends D{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return C.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return C.fromReplace(t,this.pos,this.pos+1,new O(T.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let n=0;n<e.marks.length;n++)if(!e.marks[n].isInSet(r))return new Y(this.pos,e.marks[n]);return new Y(this.pos,this.mark)}}return new at(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Y(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Y(e.pos,t.markFromJSON(e.mark))}}D.jsonID("addNodeMark",Y);class at extends D{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return C.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return C.fromReplace(t,this.pos,this.pos+1,new O(T.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new Y(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new at(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new at(e.pos,t.markFromJSON(e.mark))}}D.jsonID("removeNodeMark",at);class U extends D{constructor(t,e,r,n=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=n}apply(t){return this.structure&&Dt(t,this.from,this.to)?C.fail("Structure replace would overwrite content"):C.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new J([this.from,this.to-this.from,this.slice.size])}invert(t){return new U(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new U(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof U)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?O.empty:new O(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new U(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?O.empty:new O(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new U(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new U(e.from,e.to,O.fromJSON(t,e.slice),!!e.structure)}}D.jsonID("replace",U);class ot extends D{constructor(t,e,r,n,o,a,i=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=n,this.slice=o,this.insert=a,this.structure=i}apply(t){if(this.structure&&(Dt(t,this.from,this.gapFrom)||Dt(t,this.gapTo,this.to)))return C.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return C.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?C.fromReplace(t,this.from,this.to,r):C.fail("Content does not fit in gap")}getMap(){return new J([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new ot(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),n=t.map(this.gapFrom,-1),o=t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||n<e.pos||o>r.pos?null:new ot(e.pos,r.pos,n,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ot(e.from,e.to,e.gapFrom,e.gapTo,O.fromJSON(t,e.slice),e.insert,!!e.structure)}}D.jsonID("replaceAround",ot);function Dt(s,t,e){let r=s.resolve(t),n=e-t,o=r.depth;for(;n>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,n--;if(n>0){let a=r.node(o).maybeChild(r.indexAfter(o));for(;n>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,n--}}return!1}function hr(s,t){let e=s.resolve(t),r=e.index();return fr(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function fr(s,t){return!!(s&&t&&!s.isLeaf&&s.canAppend(t))}class it extends D{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return C.fail("No node at attribute step's position");let r=Object.create(null);for(let o in e.attrs)r[o]=e.attrs[o];r[this.attr]=this.value;let n=e.type.create(r,null,e.marks);return C.fromReplace(t,this.pos,this.pos+1,new O(T.from(n),0,e.isLeaf?0:1))}getMap(){return J.empty}invert(t){return new it(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new it(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new it(e.pos,e.attr,e.value)}}D.jsonID("attr",it);class xt extends D{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return C.ok(r)}getMap(){return J.empty}invert(t){return new xt(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new xt(e.attr,e.value)}}D.jsonID("docAttr",xt);let lt=class extends Error{};lt=function s(t){let e=Error.call(this,t);return e.__proto__=s.prototype,e};lt.prototype=Object.create(Error.prototype);lt.prototype.constructor=lt;lt.prototype.name="TransformError";function pr(s,t,e){let r=[];for(let a=0;a<s.mapping.maps.length;a++){let i=s.mapping.maps[a];if(i){for(let l=0;l<r.length;l++)r[l]=i.map(r[l]);i.forEach((l,u,d,w)=>r.push(d,w))}}let n=[];for(let a=0;a<r.length;a+=2){let i=r[a],l=r[a+1],u=s.doc.resolve(i),d=u.sharedDepth(l),w=u.node(d);for(let E=u.indexAfter(d),k=u.after(d+1);k<=l;++E){let z=w.maybeChild(E);if(!z)break;if(E&&n.indexOf(k)==-1){let y=w.child(E-1);y.type==z.type&&e.includes(y.type)&&n.push(k)}k+=z.nodeSize}}let o=!1;n.sort((a,i)=>a-i);for(let a=n.length-1;a>=0;a--)hr(s.doc,n[a])&&(t.join(n[a]),o=!0);return o}const mr=wt.create({name:"autoJoiner",addOptions(){return{elementsToJoin:[]}},addProseMirrorPlugins(){const s=new bt(this.name),t=[this.editor.schema.nodes.bulletList,this.editor.schema.nodes.orderedList];return this.options.elementsToJoin.forEach(e=>{const r=We(e,this.editor.schema);t.push(r)}),[new yt({key:s,appendTransaction(e,r,n){let o=n.tr,a=!1;for(const i of e)a=pr(i,o,t)||a;if(a)return o}})]}}),gr=wt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new yt({key:new bt("placeholder"),props:{decorations:({doc:s,selection:t})=>{const e=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,n=[];if(!e)return null;const o=this.editor.isEmpty;return s.descendants((a,i)=>{const l=r>=i&&r<=i+a.nodeSize,u=!a.isLeaf&&Ue(a);if((l||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];o&&d.push(this.options.emptyEditorClass);const w=Zt.node(i,i+a.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:i,hasAnchor:l}):this.options.placeholder});n.push(w)}return this.options.includeChildren}),Qt.create(s,n)}}})]}}),xr=wt.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:s=>s.length,wordCounter:s=>s.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=s=>{const t=(s==null?void 0:s.node)||this.editor.state.doc;if(((s==null?void 0:s.mode)||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=s=>{const t=(s==null?void 0:s.node)||this.editor.state.doc,e=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(e)}},addProseMirrorPlugins(){let s=!1;return[new yt({key:new bt("characterCount"),appendTransaction:(t,e,r)=>{if(s)return;const n=this.options.limit;if(n==null||n===0){s=!0;return}const o=this.storage.characters({node:r.doc});if(o>n){const a=o-n,i=0,l=a;console.warn("[CharacterCount] Initial content exceeded limit of ".concat(n," characters. Content was automatically trimmed."));const u=r.tr.deleteRange(i,l);return s=!0,u}s=!0},filterTransaction:(t,e)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const n=this.storage.characters({node:e.doc}),o=this.storage.characters({node:t.doc});if(o<=r||n>r&&o>r&&o<=n)return!0;if(n>r&&o>r&&o>n||!t.getMeta("paste"))return!1;const i=t.selection.$head.pos,l=o-r,u=i-l,d=i;return t.deleteRange(u,d),!(this.storage.characters({node:t.doc})>r)}})]}});tt.extend(ge);tt.extend(xe);tt.extend(we);tt.locale("zh-tw");const mt=()=>tt.utc().local();class wr{constructor(){Z(this,"timer",null);Z(this,"getDomainTime",G(null));this.getDomainTime.value=mt()}calculateNextDelay(){return 1e3-mt().millisecond()}start(){const t=()=>{this.getDomainTime.value=mt();const e=this.calculateNextDelay(),r=mt().valueOf()-this.getDomainTime.value.valueOf();console.log("誤差:",r,"ms"),this.timer=setTimeout(t,e)};t()}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}getTime(){return this.getDomainTime.value}}new wr;const Ot=20,W=12,Q="xid: invalid ID",le=new TextEncoder,yr=new TextDecoder,v=le.encode("0123456789abcdefghijklmnopqrstuv"),x=new Uint8Array(256).fill(255);for(let s=0;s<v.length;s++)x[v[s]]=s;const ce=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,Nt=de(),S=class S extends Uint8Array{constructor(t){if(super(W),t==null){const e=new DataView(this.buffer),r=Math.floor(Date.now()/1e3);e.setUint32(0,r),this[4]=S.machineId[0],this[5]=S.machineId[1],this[6]=S.machineId[2],this[7]=S.pid>>8,this[8]=S.pid&255,S.counter+=1,S.counter>16777215&&(S.counter=0),this[9]=S.counter>>16,this[10]=S.counter&255,this[11]=S.counter&255}else{if(!(t instanceof Uint8Array)||t.length!==W)throw new Error(Q);this.set(t)}}static default(){return new S(new Uint8Array(W).fill(0))}static fromValue(t){if(t instanceof S)return t;if(typeof t=="string")return S.parse(t);if(t instanceof Uint8Array&&t.length===W)return new S(t);if(t instanceof ArrayBuffer&&t.byteLength===W)return new S(new Uint8Array(t));if(Array.isArray(t)&&t.length===W&&t.every(e=>typeof e=="number"&&e>=0&&e<=255))return new S(new Uint8Array(t));throw new Error(Q)}static parse(t){if(t.length!==Ot)throw new Error(Q);const e=new S;return e.decode(t),e}decode(t){const e=le.encode(t);if(e.length!==Ot)throw new Error(Q);for(const r of e)if(x[r]==255)throw new Error(Q);if(this[11]=x[e[17]]<<6|x[e[18]]<<1|x[e[19]]>>4,v[this[11]<<4&31]!=e[19])throw new Error(Q);this[10]=x[e[16]]<<3|x[e[17]]>>2,this[9]=x[e[14]]<<5|x[e[15]],this[8]=x[e[12]]<<7|x[e[13]]<<2|x[e[14]]>>3,this[7]=x[e[11]]<<4|x[e[12]]>>1,this[6]=x[e[9]]<<6|x[e[10]]<<1|x[e[11]]>>4,this[5]=x[e[8]]<<3|x[e[9]]>>2,this[4]=x[e[6]]<<5|x[e[7]],this[3]=x[e[4]]<<7|x[e[5]]<<2|x[e[6]]>>3,this[2]=x[e[3]]<<4|x[e[4]]>>1,this[1]=x[e[1]]<<6|x[e[2]]<<1|x[e[3]]>>4,this[0]=x[e[0]]<<3|x[e[1]]>>2}encode(){const t=new Uint8Array(Ot);return t[19]=v[this[11]<<4&31],t[18]=v[this[11]>>1&31],t[17]=v[this[11]>>6|this[10]<<2&31],t[16]=v[this[10]>>3],t[15]=v[this[9]&31],t[14]=v[this[9]>>5|this[8]<<3&31],t[13]=v[this[8]>>2&31],t[12]=v[this[8]>>7|this[7]<<1&31],t[11]=v[this[7]>>4|this[6]<<4&31],t[10]=v[this[6]>>1&31],t[9]=v[this[6]>>6|this[5]<<2&31],t[8]=v[this[5]>>3],t[7]=v[this[4]&31],t[6]=v[this[4]>>5|this[3]<<3&31],t[5]=v[this[3]>>2&31],t[4]=v[this[3]>>7|this[2]<<1&31],t[3]=v[this[2]>>4|this[1]<<4&31],t[2]=v[this[1]>>1&31],t[1]=v[this[1]>>6|this[0]<<2&31],t[0]=v[this[0]>>3],yr.decode(t)}timestamp(){return new DataView(this.buffer).getUint32(0)}machine(){return new Uint8Array(this.buffer,4,3)}pid(){return this[7]<<8|this[8]}counter(){return this[9]<<16|this[10]<<8|this[11]}isZero(){return super.every(t=>t===0)}toString(){return this.encode()}toBytes(){return new Uint8Array(this.buffer,0,W)}toJSON(){return this.encode()}equals(t){for(let e=0;e<W;e++)if(this[e]!==t[e])return!1;return!0}};Z(S,"machineId",de()),Z(S,"pid",br()),Z(S,"counter",Nt[0]<<16|Nt[1]<<8|Nt[2]);let Rt=S;function de(){return ce.getRandomValues(new Uint8Array(3))}function br(){if(typeof globalThis=="object"&&"process"in globalThis)return globalThis.process.pid&65535;const s=ce.getRandomValues(new Uint8Array(2));return s[0]<<8|s[1]}const vr={key:0,class:"border border-dashed border-stone-500"},Sr={class:"h-9 flex justify-between relative"},Tr={class:"flex items-center h-8 px-2 select-none"},Er={class:"flex items-center h-8 px-2 select-none"},kr={class:"flex items-end gap-3 px-5"},Cr={class:"font-[monospace] text-xs flex"},Or={class:"flex flex-col justify-end items-end h-full text-stone-400"},Nr={class:"py-2 w-[100%] overflow-x-scroll",ref:"toolbarRef"},Ir={class:"px-3 w-[768px] flex justify-between overflow-auto"},zr=["disabled"],Dr=["disabled"],Rr=["disabled"],Ar=["disabled"],Jr=At({__name:"TextEditor",props:{articleHtmlRef:{},articleHtmlRefModifiers:{},isDomainFormat:{type:Boolean},isDomainFormatModifiers:{}},emits:["update:articleHtmlRef","update:isDomainFormat"],setup(s){var Pt;const t=Je(),e=$t(s,"articleHtmlRef"),r=$t(s,"isDomainFormat");let n=!1,o=G(!0);const a=G(!1),i=G(),l=G(),u=h=>{try{if(!o.value)return;ct(h)}catch(c){console.error("自動空白處理時發生錯誤:",c)}},d=rr({extensions:[..._e,je,lr.configure({dragHandleSelector:".drag-handle"}),mr,xr.configure({limit:F.WORD_LIMIT,textCounter:h=>h.replace(/\s+/g," ").length}),gr.configure({placeholder:({pos:h,node:c,editor:m})=>h===0?"第一段內容會作為標題或封面圖":"新段落..."})],editorProps:{attributes:{spellcheck:"false",autocomplete:"off",autocorrect:"off",autocapitalize:"off",inputmode:"text",enterkeyhint:"enter"},handleDOMEvents:{touchstart:(h,c)=>(h.focus(),!1),input:(h,c)=>(n||u(d.value),!1),compositionstart:()=>(n=!0,!1),compositionend:()=>(n=!1,u(d.value),!1),click:(h,c)=>(setTimeout(()=>{d.value.commands.focus()},0),!1)}},content:(Pt=e.value)!=null?Pt:"",onUpdate:({editor:h})=>{const c=h.getJSON();c&&(e.value=JSON.stringify(c))}}),w=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983]],E=h=>{const c=h.codePointAt(0);return c?w.some(([m,b])=>c>=m&&c<=b):!1},k=h=>/^[a-zA-Z0-9]$/.test(h),z=(h,c)=>{if(!h||!c||h===" "||c===" ")return!1;const m=E(h),b=k(h),g=E(c),A=k(c);return m&&A||b&&g},y=(h,c,m)=>{const b=[];let g="",A=0,L=!1;return h&&typeof h.descendants=="function"&&h.descendants((R,$)=>{var _;R.isText?(R.text||"").split("").forEach((nt,Lt)=>{b.push({text:nt,originalPosition:A,nodePosition:$+Lt}),g+=nt,A++}):R.type&&R.type.name==="mention"&&(L=!0,(((_=R.attrs)==null?void 0:_.label)||"").split("").forEach((nt,Lt)=>{b.push({text:nt,originalPosition:A,nodePosition:$}),g+=nt,A++}))}),{mappings:b,text:g,isMention:L,cursorOffset:m-c}},N=h=>{const c=[],{text:m}=h;for(let b=0;b<m.length-1;b++)z(m[b],m[b+1])&&c.push(b+1);return c},M=(h,c,m)=>{const{cursorOffset:b}=h,g=c.filter(L=>L<=b).length;return m.state.selection.from+g},ct=h=>{try{if(!h||!h.state||!h.state.selection)return;const c=Ge(R=>R.type.name==="paragraph")(h.state.selection);if(!c)return;const{node:m,start:b}=c,g=y(m,b,h.state.selection.from),A=N(g);if(!A.length)return;h.chain().focus().command(({tr:R})=>(A.reverse().forEach($=>{if($>=0&&$<g.mappings.length){const j=g.mappings[$].nodePosition+(g.isMention,0);R.insertText(" ",b+j)}}),!0)).run();const L=M(g,A,h);L>0&&h.commands.setTextSelection(L)}catch(c){console.error("自動空白處理錯誤:",c)}},K=X(()=>{try{return d.value.storage.characterCount.characters()}catch(h){return 0}}),vt=X(()=>K.value>=F.WORD_LIMIT),H=X(()=>K.value>=F.WORD_WARNING&&K.value<F.WORD_LIMIT),ue=X(()=>st.size>=F.IMAGE_LIMIT),he=X(()=>st.size>=F.IMAGE_WARNING&&st.size<F.IMAGE_LIMIT);Ne(i,()=>a.value=!1,{ignore:[l]});const et=Yt(),Mt=Ie(),rt=G(!1),dt=()=>{try{const h=d.value.getJSON();if(!h||!h.content||h.content.length===0)return"";const c=h.content.find(m=>m.type==="paragraph"&&m.content&&m.content.length>0);if(c&&c.content)return c.content.filter(m=>m.type==="text").map(m=>m.text).join("")}catch(h){console.error("提取段落文本錯誤:",h)}return""},fe=async()=>{var h,c,m,b;try{rt.value=!0;const g={type:"doc",content:[{type:"paragraph",content:[{type:"text",text:"".concat(Mt.name," 想發文, 但沒有內容")}]}]},A=et.topic==="index"?"letsTalking":et.topic,L=tt().valueOf(),R=new Rt;if(et.article){const $=ht(ft,"articles",et.article),_=(await qe($)).data(),j={articleTitle:dt(),articleHtmlRef:(h=e.value)!=null?h:JSON.stringify(g),isDomainFormat:(c=r.value)!=null?c:!1,time:L,tag:"".concat(dt()),floor:_.messages.length+1};await Tt($,{messages:Et(j)})}else{const $={xid:R.toString(),user:Mt.name,time:L,analyze:{rating:{nice:0,bad:0},ratedLists:{},views:0},path:R.toString(),alias:A,history:[{articleTitle:dt(),articleHtmlRef:(m=e.value)!=null?m:JSON.stringify(g),isDomainFormat:(b=r.value)!=null?b:!1,time:L,tag:"".concat(dt(),"(原文)")}],messages:[]};await Ve(ht(ft,"articles",R.toString()),$);const _=ht(ft,"topics",et.topic),j=ht(ft,"topics","index");await Tt(_,{articleIDs:Et(R.toString())}),await Tt(j,{articleIDs:Et(R.toString())})}t.push("/")}catch(g){console.error("發文錯誤:",g),rt.value=!1}};return qt(()=>{setTimeout(()=>{d.value.commands.focus("end")},100)}),(h,c)=>{const m=Re("Icon"),b=ye;return zt(),It(Kt,null,[p(d)?(zt(),It("div",vr,[De(St(e.value)+" ",1),I(p(er),{editor:p(d),class:P({"amDomain-format-editorMode":r.value})},null,8,["editor","class"]),f("div",Sr,[f("button",{ref_key:"editorOptionsButtonRef",ref:l,class:"ml-3 hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:c[0]||(c[0]=g=>a.value=!p(a))},[I(m,{icon:"ic:sharp-menu",width:"24",height:"24"})],512),f("div",{ref_key:"editorOptionsRef",ref:i,class:P("absolute left-0 mx-3  bottom-10 flex w-44 font-semibold text-sm border border-stone-400/50 bg-stone-300/10 p-1 rounded-lg backdrop-blur-sm bg-opacity-20 z-10  flex-col\n                    ".concat(p(a)?"":"hidden"))},[f("div",Tr,[ut(f("input",{"onUpdate:modelValue":c[1]||(c[1]=g=>r.value=g),class:"w-4 h-4 hover:cursor-pointer",id:"editorGap",type:"checkbox",value:"true",checked:""},null,512),[[Ft,r.value]]),c[15]||(c[15]=f("label",{class:"w-full hover:cursor-pointer pl-2",for:"editorGap"},"同領地格式",-1))]),f("div",Er,[ut(f("input",{"onUpdate:modelValue":c[2]||(c[2]=g=>Ae(o)?o.value=g:o=g),class:"w-4 h-4 hover:cursor-pointer",id:"autoGap",type:"checkbox",value:"true",checked:""},null,512),[[Ft,p(o)]]),c[16]||(c[16]=f("label",{class:"w-full hover:cursor-pointer pl-2",for:"autoGap"},"中英文自動空白",-1))])],2),f("div",kr,[f("div",Cr,[I(b,{isClock:"",paramFormat:p(be).CLOCK_FORMAT},null,8,["paramFormat"])]),f("div",Or,[f("div",{class:P({"text-xs font-[monospace] ":!0,"text-red-600 font-bold":p(vt),"text-orange-400":p(H)})},St("".concat(p(K),"/").concat(p(F).WORD_LIMIT))+"字 ",3),f("div",{class:P({"text-xs font-[monospace]":!0,"text-red-600 font-bold":p(ue),"text-orange-400":p(he)})},St("".concat(p(st).size,"/").concat(p(F).IMAGE_LIMIT))+"圖 ",3)])])]),f("div",Nr,[f("span",Ir,[f("button",{class:"hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:c[3]||(c[3]=g=>p(d).chain().focus().undo().run()),disabled:!p(d).can().chain().focus().undo().run()},[I(m,{icon:"ic:baseline-undo",width:"24",height:"24"})],8,zr),f("button",{class:"hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:c[4]||(c[4]=g=>p(d).chain().focus().redo().run()),disabled:!p(d).can().chain().focus().redo().run()},[I(m,{icon:"ic:sharp-redo",width:"24",height:"24"})],8,Dr),f("button",{class:"hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",onClick:c[5]||(c[5]=g=>{p(d).chain().focus().clearContent(!0).run(),p(st).clear()})},[I(m,{icon:"ic:round-restore-page",width:"24",height:"24"})]),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("bold")}]),onClick:c[6]||(c[6]=g=>p(d).chain().focus().toggleBold().run()),disabled:!p(d).can().chain().focus().toggleBold().run()},[I(m,{icon:"ic:round-format-bold",width:"24",height:"24"})],10,Rr),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("highlight")}]),onClick:c[7]||(c[7]=g=>p(d).chain().focus().toggleHighlight().run())},[I(m,{icon:"ic:baseline-texture",width:"24",height:"24"})],2),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("bulletList")}]),onClick:c[8]||(c[8]=g=>p(d).chain().focus().toggleBulletList().run())},[I(m,{icon:"ic:round-format-list-bulleted",width:"24",height:"24"})],2),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("orderedList")}]),onClick:c[9]||(c[9]=g=>p(d).chain().focus().toggleOrderedList().run())},[I(m,{icon:"ic:sharp-format-list-numbered",width:"24",height:"24"})],2),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("heading",{level:1})}]),onClick:c[10]||(c[10]=g=>p(d).chain().focus().toggleHeading({level:1}).run())},c[17]||(c[17]=[f("span",{class:"flex font-bold items-baseline"},[f("b",null,"H"),f("small",null,"1")],-1)]),2),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("heading",{level:2})}]),onClick:c[11]||(c[11]=g=>p(d).chain().focus().toggleHeading({level:2}).run())},c[18]||(c[18]=[f("span",{class:"flex font-bold items-baseline"},[f("b",null,"H"),f("small",null,"2")],-1)]),2),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("horizontalRule")}]),onClick:c[12]||(c[12]=g=>p(d).chain().focus().setHorizontalRule().run())},[I(m,{icon:"ic:sharp-horizontal-rule",width:"24",height:"24"})],2),f("button",{class:P(["hover:border-stone-400 hover:cursor-pointer w-9 h-9 flex justify-center items-center border-2 border-dashed border-transparent rounded",{"border-stone-400 bg-stone-400 text-stone-100":p(d).isActive("blockquote")}]),onClick:c[13]||(c[13]=g=>p(d).chain().focus().toggleBlockquote().run())},[I(m,{icon:"ic:baseline-format-quote",width:"24",height:"24"})],2)])],512)])):ze("",!0),c[19]||(c[19]=f("div",{class:"text-[0.8rem] text-center"}," 左右滑動選擇工具 ",-1)),f("div",null,[f("button",{disabled:p(rt),class:"cursor-pointer h-9 flex justify-center items-center border-2 border-dashed border-stone-400 rounded px-2 disabled:cursor-not-allowed not-disabled:focus-visible:outline-2 not-disabled:focus-visible:outline-offset-2 not-disabled:focus-visible:outline-stone-600",type:"submit",onClickOnce:c[14]||(c[14]=g=>fe())},[ut(f("p",null,[I(m,{class:"w-9 h-9",icon:"line-md:loading-twotone-loop"})],512),[[Ht,p(rt)]]),ut(f("p",null," 確認發文 ",512),[[Ht,!p(rt)]])],40,Ar)])],64)}}}),Mr=Ye(Jr,[["__scopeId","data-v-b7921af3"]]),Pr={class:"bg-stone-100 [&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},Lr={class:"flex w-full"},$r={class:"xl:w-[600px] md:w-[400px] md:flex max-md:hidden flex-col"},Fr={class:"sticky top-[100px]"},Hr={class:"text-[1.1rem]"},Br={class:"w-full xl:max-w-[654px] md:max-w-[550px]"},qr=At({__name:"PostsPage",setup(s){const t=Yt(),e="你準備在 ".concat(t.topicTitle," 發表"),r="你正要在 ".concat(t.articleTitle," 留言"),n=X(()=>t.article===""?e:r);return console.log(t.topic),(o,a)=>{const i=Ke,l=Qe,u=Ze,d=Mr;return zt(),It(Kt,null,[I(i),f("div",Pr,[I(u,{class:"select-none !pt-5 flex justify-center xl:min-h-[calc(100dvh-100px-(1.25rem*2))] md:min-h-[calc(100dvh-80px-(1rem*2))] max-md:min-h-[calc(100dvh-60px)]"},{default:Bt(()=>[f("div",Lr,[f("div",$r,[f("div",Fr,[I(u,{class:"flex flex-col"},{default:Bt(()=>[f("p",Hr,[I(l,{text:p(n)},null,8,["text"])])]),_:1})])]),f("div",Br,[I(d)])])]),_:1})])],64)}}});export{qr as default};

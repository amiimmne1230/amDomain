System.register(["./SiteScroll.vue_vue_type_script_setup_true_lang-legacy-Bbgi80xX.js","./NavigationTempl.vue_vue_type_script_setup_true_lang-legacy-CqQduf2M.js","./DomainTime.vue_vue_type_script_setup_true_lang-legacy-Baf8qKY8.js","./index-legacy-CIHQvChL.js","./useArticle-legacy-Dpjfj-u7.js","./Constant-legacy-C2LnN0pO.js"],(function(e,t){"use strict";var l,r,a,n,o,s,i,d,c,m,u,x,p,v,f,h,b,g,y,w,j,_,k,E,T,S,O,I,M,U,z,C,$,H,A,L,N,D,F,V,W,Y,q,B,R,G,J,K,P;return{setters:[e=>{l=e._},e=>{r=e.a,a=e.b,n=e.e,o=e.f,s=e.D,i=e.q,d=e.w,c=e.i,m=e.l,u=e.o,x=e.c,p=e._},e=>{v=e._},e=>{f=e.d,h=e.y,b=e.b,g=e.r,y=e.j,w=e.c,j=e.e,_=e.f,k=e.t,E=e.g,T=e.V,S=e.h,O=e.K,I=e.i,M=e.W,U=e.X,z=e.o,C=e.O,$=e.B,H=e.Y,A=e.u,L=e.Z,N=e.J,D=e.D,F=e._,V=e.z,W=e.H,Y=e.A,q=e.F,B=e.C,R=e.E,G=e.G,J=e.I,K=e.U},e=>{P=e.s},null],execute:function(){var t=document.createElement("style");t.textContent=".transImage[data-v-51eb9614]{--imageTrans: invert(73%) sepia(13%) saturate(147%) hue-rotate(345deg) brightness(88%) contrast(85%) }.transImage[data-v-51eb9614]:hover{--imageTrans: filter: invert(24%) sepia(6%) saturate(733%) hue-rotate(353deg) brightness(93%) contrast(89%) }@keyframes scale-up-51eb9614{0%{scale:0}to{scale:1}}.scale-up[data-v-51eb9614]{animation:scale-up-51eb9614 .3s ease-out forwards}\n/*$vite$:1*/",document.head.appendChild(t);var X="object"==typeof global&&global&&global.Object===Object&&global,Z="object"==typeof self&&self&&self.Object===Object&&self,Q=X||Z||Function("return this")(),ee=Q.Symbol,te=Object.prototype,le=te.hasOwnProperty,re=te.toString,ae=ee?ee.toStringTag:void 0,ne=Object.prototype.toString,oe=ee?ee.toStringTag:void 0;function se(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":oe&&oe in Object(e)?function(e){var t=le.call(e,ae),l=e[ae];try{e[ae]=void 0;var r=!0}catch(n){}var a=re.call(e);return r&&(t?e[ae]=l:delete e[ae]),a}(e):function(e){return ne.call(e)}(e)}var ie=/\s/,de=/^\s+/;function ce(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}(e)+1).replace(de,""):e}function me(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var ue=/^[-+]0x[0-9a-f]+$/i,xe=/^0b[01]+$/i,pe=/^0o[0-7]+$/i,ve=parseInt;function fe(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==se(e)}(e))return NaN;if(me(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=me(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ce(e);var l=xe.test(e);return l||pe.test(e)?ve(e.slice(2),l?2:8):ue.test(e)?NaN:+e}var he=function(){return Q.Date.now()},be=Math.max,ge=Math.min;function ye(e,t,l){var r,a,n,o,s,i,d=0,c=!1,m=!1,u=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function x(t){var l=r,n=a;return r=a=void 0,d=t,o=e.apply(n,l)}function p(e){var l=e-i;return void 0===i||l>=t||l<0||m&&e-d>=n}function v(){var e=he();if(p(e))return f(e);s=setTimeout(v,function(e){var l=t-(e-i);return m?ge(l,n-(e-d)):l}(e))}function f(e){return s=void 0,u&&r?x(e):(r=a=void 0,o)}function h(){var e=he(),l=p(e);if(r=arguments,a=this,i=e,l){if(void 0===s)return function(e){return d=e,s=setTimeout(v,t),c?x(e):o}(i);if(m)return clearTimeout(s),s=setTimeout(v,t),x(i)}return void 0===s&&(s=setTimeout(v,t)),o}return t=fe(t)||0,me(l)&&(c=!!l.leading,n=(m="maxWait"in l)?be(fe(l.maxWait)||0,t):n,u="trailing"in l?!!l.trailing:u),h.cancel=function(){void 0!==s&&clearTimeout(s),d=0,r=i=a=s=void 0},h.flush=function(){return void 0===s?o:f(he())},h}const we={class:"border-b w-full flex items-end font-bold cursor-pointer border-stone-400 text-stone-400 hover:mix-blend-difference"},je={class:"xl:pt-2 md:pt-1 max-md:pt-0.5"},_e={class:"break-all line-clamp-2 text-stone-400/50 xl:w-[calc(1.25rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},ke={class:"break-all line-clamp-2 xl:w-[calc(1.5rem*20)] xl:text-[1.25rem] md:w-[calc(1rem*20)] md:text-[1rem] max-md:max-w-[calc(0.75rem*20)] max-md:text-[0.75rem]"},Ee={class:"flex flex-col ml-auto xl:text-[1.2rem] md:text-[1rem] max-md:text-[0.8rem]"},Te={class:"flex justify-end gap-5"},Se={class:"flex gap-1 items-center"},Oe={class:"flex gap-1 items-center"},Ie=f({__name:"ReviewArticleTempl",props:h({article:{}},{forumTemplModels:{},forumTemplModelsModifiers:{},reviewImageObject:{},reviewImageObjectModifiers:{}}),emits:["update:forumTemplModels","update:reviewImageObject"],setup(e){const t=O(),l=e,r=b(e,"forumTemplModels"),a=b(e,"reviewImageObject"),n=g(""),o=y((()=>r.value?.alias||l.article.alias)),s=y((()=>(n.value=r.value?.path||l.article.path,r.value?.path||l.article.path))),i=y((()=>r.value?.time||l.article.time)),d=y((()=>{const e=r.value?.analyze.rating||l.article.analyze.rating;return{nice:e.nice,bad:e.bad}}));y((()=>r.value?.analyze.views||l.article.analyze.views));const c=y((()=>{const e=r.value?.history.length||l.article.history.length;return r.value?.history[e-1].articleTitle||l.article.history[e-1].articleTitle})),m=()=>{a.value.isEnterElement=!1};return(e,l)=>{const r=S("Icon"),a=v;return I(),w("div",{onMouseleave:m},[j("div",{onClick:l[0]||(l[0]=e=>{return l=_(s),void t.push({path:l});var l})},[j("div",we,[j("span",je,[j("p",_e,k(_(o)),1),j("p",ke,k(_(c)),1)]),j("span",Ee,[j("div",Te,[j("p",Se,[E(r,{icon:"ic:round-thumb-up-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),T(" "+k(_(d).nice),1)]),j("p",Oe,[E(r,{icon:"ic:round-thumb-down-alt",class:"xl:w-[1.2rem] xl:h-[1.2rem] md:w-[1rem] md:h-[1rem] max-md:w-[0.8rem] max-md:h-[0.8rem]"}),T(" "+k(_(d).bad),1)])]),j("p",null,[E(a,{paramTime:_(i),fromNow:""},null,8,["paramTime"])])])])])],32)}}}),Me=["src"],Ue=f({__name:"followWhatYouSee",props:{imageString:{},imageStringModifiers:{},isEnterElement:{type:Boolean},isEnterElementModifiers:{}},emits:["update:imageString","update:isEnterElement"],setup(e){M(H);const t=g(),l=b(e,"imageString"),r=b(e,"isEnterElement"),{x:a,y:n}=U();let o,s=0,i=0,d=0,c=0;return z((()=>{const e=()=>{s=a.value,i=n.value,d+=.08*(s-d),c+=.08*(i-c),t.value.style.top=`${c}px`,t.value.style.left=`${d}px`,o=requestAnimationFrame(e)};e()})),C((()=>{cancelAnimationFrame(o)})),(e,a)=>(I(),w("div",{ref_key:"movingDiv",ref:t,class:"absolute -z-10 pointer-events-none select-none"},[j("div",{class:"absolute -z-20 object-cover -translate-1/2 md:w-[202px] max-md:w-[122px] transition-[height] duration-[0.3s] bg-stone-700 mix-blend-difference",style:$({height:r.value?0:"0px"})},null,4),j("img",{src:l.value,class:"object-cover -translate-1/2 md:w-[200px] max-md:w-[120px] transition-[height] duration-[0.3s]",style:$({height:r.value?0:"0px"})},null,12,Me)],512))}}),ze={ref:"root"},Ce={class:"[&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},$e={class:"xl:flex-2/3 md:flex-3/4"},He={class:"border-y border-stone-400 py-5 grid grid-cols-3"},Ae={class:"p-2"},Le={class:"transImage w-full h-full border relative text-stone-400 border-stone-400 hover:text-stone-700 hover:border-stone-700 flex items-end overflow-hidden xl:h-[120px] md:h-[100px] max-md:h-[70px] after:backdrop-blur-[2px] after:absolute after:content-[''] after:w-full after:h-full after:-z-20"},Ne=["src"],De=["src"],Fe={class:"px-2 font-bold max-md:text-[0.8rem]"},Ve={class:"p-2"},We={class:"flex"},Ye=["disabled"],qe=["disabled"],Be={class:"flex-col flex xl:flex-1/3 md:flex-2/4"},Re={class:"md:sticky md:top-[100px] flex flex-col"},Ge={class:"font-bold xl:text-[6rem] md:text-[3rem] max-md:text-[2rem]"},Je={class:"px-2"},Ke={class:"flex gap-3 select-none flex-wrap"},Pe={class:"flex"},Xe={class:"flex"},Ze={class:"flex"},Qe={class:"flex"},et={class:"w-[82%] xl:my-10 md:my-5 max-md:my-5 max-md:sticky max-md:top-[100px]"},tt={ref:"searchForm",class:"relative group flex-7/12 flex items-center"},lt={class:"absolute group-focus-within:text-stone-700 text-stone-400",for:"s"},rt={class:"xl:flex-2/3 md:flex-2/4"};e("default",p(f({__name:"ForumIndex",setup(e){const t=A(),p=L({isEnterElement:!1,imageSource:""}),v=M(H),f=N(),h=y((()=>f.path.split("/")[1]||"index")),b=g([]),k=g([]),O=g([]),U=g(!1),C=g(!0),$=g(null),X=async(e=!1)=>{if(!U.value&&C.value){U.value=!0;try{let t;const l=b.value.find((e=>e.name===h.value))?.articleIDs||[],r=n(s,"articles"),a=l.slice(0,ie.value);console.log(a),e?(k.value=[],$.value=null,C.value=!0,t=i(r,d("xid","in",a))):t=i(r,d("xid","in",a),c($.value));const m=await o(t);if(console.log(m.docs),m.empty)return C.value=!1,void(U.value=!1);const u=m.docs[m.docs.length-1];$.value=u,m.forEach((e=>{k.value.push({...e.data()})}))}catch(t){console.error(t)}finally{U.value=!1}}},Z=ye((async()=>{!U.value&&C.value&&await X(!1)}),300);z((async()=>{await(async()=>{const e=n(s,"topics");(await o(e)).forEach((e=>{b.value.push({...e.data()})}))})(),X(!0),(async()=>{if(O.value.length>0)return;const e=n(s,"articles"),t=i(e,u("time","desc"),m(2));(await o(t)).forEach((e=>{O.value.push({...e.data()})}))})()})),D(h,(()=>{ae.value="order",U.value=!1,C.value=!0,X(!0)}));const Q=g(1),ee=v?.value.fetchTopics??0,te=y((()=>({currentMax:Q.value*ee,currentMin:(Q.value-1)*ee}))),le=()=>{Q.value-=1},re=()=>{Q.value+=1},ae=g("order");D(ae,(()=>{P(ae.value,k.value)}));const ne=g("");D(ne,ye((()=>{(async()=>{if(!ne.value.trim())return U.value=!1,C.value=!0,void(await X(!0));try{U.value=!0,k.value=[];const e=n(s,"articles"),t=await o(e),l=ne.value.toLowerCase();t.forEach((e=>{const t={...e.data()},r=t.history.length-1;(t.history[r].articleTitle.toLowerCase().includes(l)||t.history[r].articleHtmlRef.toLowerCase().includes(l))&&k.value.push(t)})),C.value=!1}catch(e){console.error("Error searching articles:",e)}finally{U.value=!1}})()}),500));const oe=y((()=>{const e=b.value.find((e=>e.name===h.value))??null,l=e?.nickname??"開始聊";return t.topicTitle="同領地"===l?"開始聊":l,t.articleTitle="",e})),se=g(!1),ie=g(5),{y:de}=F(),ce=y((()=>{const e=document.documentElement.scrollHeight,t=window.innerHeight;return{scrollableHeight:e-t,currentScrollY:de.value,windowHeight:t}})),me=y((()=>{const{scrollableHeight:e,currentScrollY:t,windowHeight:l}=ce.value;return!se.value&&t>0&&(se.value=!0),!!(se.value&&e-t<.1*l)}));return D(me,(()=>{me.value&&(ie.value+=5,Z())})),(e,t)=>{const n=Ue,o=r,s=Ie,i=a,d=x,c=S("router-link"),m=S("Icon"),u=l;return I(),w("div",ze,[E(n,{isEnterElement:_(p).isEnterElement,"onUpdate:isEnterElement":t[0]||(t[0]=e=>_(p).isEnterElement=e),imageString:_(p).imageSource,"onUpdate:imageString":t[1]||(t[1]=e=>_(p).imageSource=e)},null,8,["isEnterElement","imageString"]),E(o),j("div",Ce,["index"===_(h)?(I(),V(i,{key:0,class:"xl:flex xl:item-start xl:py-20 md:flex md:item-start md:py-10 max-md:flex-col max-md:py-6"},{default:Y((()=>[t[9]||(t[9]=j("h2",{class:"xl:text-[2.5rem] xl:flex-1/3 md:text-[2rem] md:flex-1/4 max-md:text-[1.5rem]"}," 熱門文章 ",-1)),j("div",$e,[_(O).length>0?(I(!0),w(q,{key:0},B(_(O),(e=>(I(),V(s,{reviewImageObject:_(p),"onUpdate:reviewImageObject":t[2]||(t[2]=e=>R(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),256)):(I(),w(q,{key:1},[T(" still loading... ")],64))])])),_:1})):W("",!0),E(i,{class:"!p-0 !py-10 select-none"},{default:Y((()=>[j("div",He,[_(b).length>0?(I(!0),w(q,{key:0},B(_(b).slice(_(te).currentMin,_(te).currentMax),(e=>(I(),w("div",Ae,[E(c,{to:e.path},{default:Y((()=>[j("div",Le,[j("img",{src:`./${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-4 -bottom-2 rounded-full absolute z-10w-20 h-20"},null,8,Ne),j("img",{src:`./${e.image}`,class:"scale-up filter-[var(--imageTrans)] -right-8 -bottom-4 rounded-full absolute opacity-20 z-10 w-40 h-40"},null,8,De),j("div",Fe,[E(d,{text:e.nickname},null,8,["text"])])])])),_:2},1032,["to"])])))),256)):(I(),w(q,{key:1},B(3,(e=>j("div",Ve,t[10]||(t[10]=[j("div",{class:"xl:h-[120px] animate-pulse bg-stone-400 md:h-[100px] max-md:h-[70px]"},null,-1)])))),64))]),j("div",We,[j("button",{disabled:1===_(Q),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:-translate-x-10 flex-1/2 flex justify-center border-b border-r border-stone-400 py-1",onClick:le},[E(m,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-left-large-light"})],8,Ye),j("button",{disabled:_(Q)>_(b).length/_(ee),class:"disabled:text-stone-400/50 disabled:cursor-not-allowed not-disabled:cursor-pointer enabled:hover:[&>svg]:translate-x-10 flex-1/2 flex justify-center border-b border-stone-400 py-1",onClick:re},[E(m,{class:"transition ease-in-out duration-300 transform xl:w-10 xl:h-10",icon:"stash:arrow-right-large-light"})],8,qe)])])),_:1}),E(i,{ref:"root",class:"w-full py-10 xl:flex xl:item-start md:flex md:item-start max-lg:flex-col max-md:flex-col"},{default:Y((()=>[j("div",Be,[j("div",Re,[j("h2",Ge,[E(d,{text:_(oe)?.nickname??"/*15a"},null,8,["text"])]),j("div",Je,[E(d,{text:_(oe)?.description??"/*13ad|15a"},null,8,["text"])]),j("div",Ke,[j("div",Pe,[G(j("input",{type:"radio",id:"order",name:"msg",value:"order","onUpdate:modelValue":t[3]||(t[3]=e=>R(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[J,_(ae)]]),t[11]||(t[11]=j("label",{for:"order",class:"border-dashed border-2 border-transparent hover:border-stone-400 flex items-center cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 按順序 ",-1))]),j("div",Xe,[G(j("input",{type:"radio",id:"newest",name:"msg",value:"newest","onUpdate:modelValue":t[4]||(t[4]=e=>R(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[J,_(ae)]]),t[12]||(t[12]=j("label",{for:"newest",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最新 ",-1))]),j("div",Ze,[G(j("input",{type:"radio",id:"mostLiked",name:"mostLiked",value:"mostLiked","onUpdate:modelValue":t[5]||(t[5]=e=>R(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[J,_(ae)]]),t[13]||(t[13]=j("label",{for:"mostLiked",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最多讚 ",-1))]),j("div",Qe,[G(j("input",{type:"radio",id:"worst",name:"msg",value:"worst","onUpdate:modelValue":t[6]||(t[6]=e=>R(ae)?ae.value=e:null),class:"hidden peer"},null,512),[[J,_(ae)]]),t[14]||(t[14]=j("label",{for:"worst",class:"border-dashed border-2 border-transparent hover:border-stone-400 cursor-pointer text-stone-400 peer-checked:bg-stone-400 peer-checked:text-white rounded-full xl:py-1 xl:px-4 xl:text-[1rem] md:py-1 md:px-3 md:text-[0.8rem] max-md:py-0.5 max-md:px-2 max-md:text-[0.75rem]"}," 最爛 ",-1))])]),j("div",et,[j("form",tt,[j("label",lt,[E(m,{icon:"ic:baseline-search",class:"xl:w-6 xl:h-6 md:w-4.5 md:h-4.5 max-md:w-4 max-md:h-4"})]),G(j("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>R(ne)?ne.value=e:null),type:"text",id:"s",placeholder:"文章搜尋...",class:"w-full xl:px-7 xl:h-10 xl:text-[1.2rem] md:px-5 md:h-8 md:text-[1rem] max-md:px-5 max-md:h-5 max-md:text-[1rem] outline-none bg-none border-b border-transparent relative border-b-stone-400 focus:border-b-stone-700"},null,512),[[K,_(ne)]])],512)])])]),j("div",rt,[_(k).length>0?(I(!0),w(q,{key:0},B(_(k),(e=>(I(),V(s,{key:e.xid,ref_for:!0,ref:"currentArticleScroll",reviewImageObject:_(p),"onUpdate:reviewImageObject":t[8]||(t[8]=e=>R(p)?p.value=e:null),article:e},null,8,["reviewImageObject","article"])))),128)):(I(),w(q,{key:1},[T(" still loading... ")],64))])])),_:1},512)]),E(u)],512)}}}),[["__scopeId","data-v-51eb9614"]]))}}}));

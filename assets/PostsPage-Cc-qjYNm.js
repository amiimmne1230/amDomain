var Jt=Object.defineProperty;var Mt=(i,t,e)=>t in i?Jt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var M=(i,t,e)=>Mt(i,typeof t!="symbol"?t+"":t,e);import{D as gt,a as xt,b as Lt,_ as Pt,c as Ft,d as Bt,e as Q,P as Z,f as X,N as v,T as $t,S as Ht,F as Wt,h as Ut,i as _t,E as qt,j}from"./TipTap_Extensions-BbDUUah2.js";import{d as st,M as Vt,s as Yt,r as C,p as Gt,m as Kt,u as G,N as Qt,O as Zt,P as Xt,Q as _,i as lt,c as F,R as jt,g as wt,h as te,o as ee,z as re,K as ne,b as yt,a as ie,f as B,e as L,A as ct,F as se}from"./index-Rw6pzqcv.js";import{i as oe,r as ae,u as le,A as b}from"./Constant-8FMcXfiX.js";import{_ as ce,a as he,b as ue,c as de}from"./NavigationTempl.vue_vue_type_script_setup_true_lang-BUu-jgbR.js";const fe=Object.freeze(Object.defineProperty({__proto__:null,Decoration:gt,DecorationSet:xt,EditorView:Lt,__endComposition:Pt,__parseFromClipboard:Ft},Symbol.toStringTag,{value:"Module"}));function ht(i){return Xt((t,e)=>({get(){return t(),i},set(r){i=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e()})})}}))}class pe extends Bt{constructor(t={}){return super(t),this.contentComponent=null,this.appContext=null,this.reactiveState=ht(this.view.state),this.reactiveExtensionStorage=ht(this.extensionStorage),this.on("beforeTransaction",({nextState:e})=>{this.reactiveState.value=e,this.reactiveExtensionStorage.value=this.extensionStorage}),Vt(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,e){const r=super.registerPlugin(t,e);return this.reactiveState&&(this.reactiveState.value=r),r}unregisterPlugin(t){const e=super.unregisterPlugin(t);return this.reactiveState&&e&&(this.reactiveState.value=e),e}}const me=st({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(i){const t=C(),e=Qt();return Gt(()=>{const r=i.editor;r&&r.options.element&&t.value&&Kt(()=>{if(!t.value||!r.options.element.firstChild)return;const n=G(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=e.ctx._,e&&(r.appContext={...e.appContext,provides:e.provides}),r.setOptions({element:n}),r.createNodeViews()})}),Zt(()=>{const r=i.editor;r&&(r.contentComponent=null,r.appContext=null)}),{rootEl:t}},render(){return Yt("div",{ref:i=>{this.rootEl=i}})}});function ge(){try{return fe}catch(i){return null}}function xe(i,t){if(i&&typeof i.serializeForClipboard=="function")return i.serializeForClipboard(t);const e=ge();if(e&&typeof(e==null?void 0:e.__serializeForClipboard)=="function")return e.__serializeForClipboard(i,t);throw new Error("No supported clipboard serialization method found.")}function we(i){const t=i.getBoundingClientRect(),e=i.closest('[role="dialog"]');if(e&&window.getComputedStyle(e).transform!=="none"){const r=e.getBoundingClientRect();return{top:t.top-r.top,left:t.left-r.left,width:t.width}}return{top:t.top,left:t.left,width:t.width}}function ut(i,t){const e=["li","p:not(:first-child)","pre","blockquote","h1","h2","h3","h4","h5","h6",...t.customNodes.map(r=>"[data-type=".concat(r,"]"))].join(", ");return document.elementsFromPoint(i.x,i.y).find(r=>{var n,o;return((o=(n=r.parentElement)==null?void 0:n.matches)==null?void 0:o.call(n,".ProseMirror"))||r.matches(e)})}function ye(i,t,e){var n;const r=i.getBoundingClientRect();return(n=t.posAtCoords({left:r.left+50+e.dragHandleWidth,top:r.top+1}))==null?void 0:n.inside}function dt(i,t){const e=t.state.doc.resolve(i);return e.depth>1?e.before(e.depth):i}function Se(i){let t="";function e(s,l){if(l.focus(),!s.dataTransfer)return;const c=ut({x:s.clientX+50+i.dragHandleWidth,y:s.clientY},i);if(!(c instanceof Element))return;let h=ye(c,l,i);if(h==null||h<0)return;h=dt(h,l);const{from:m,to:y}=l.state.selection,S=m-y,O=dt(m,l);let g=!1;const E=l.state.doc.resolve(O);if(E.node().type.name==="doc")g=!0;else{const J=v.create(l.state.doc,E.before());g=!(h+1>=J.$from.pos&&h<=J.$to.pos)}let N=l.state.selection;if(!g&&S!==0&&!(l.state.selection instanceof v)){const J=v.create(l.state.doc,y-1);N=$t.create(l.state.doc,h,J.$to.pos)}else if(N=v.create(l.state.doc,h),N.node.type.isInline||N.node.type.name==="tableRow"){let J=l.state.doc.resolve(N.from);N=v.create(l.state.doc,J.before())}l.dispatch(l.state.tr.setSelection(N)),l.state.selection instanceof v&&l.state.selection.node.type.name==="listItem"&&(t=c.parentElement.tagName);const at=l.state.selection.content(),{dom:Rt,text:At}=xe(l,at);s.dataTransfer.clearData(),s.dataTransfer.setData("text/html",Rt.innerHTML),s.dataTransfer.setData("text/plain",At),s.dataTransfer.effectAllowed="copyMove",s.dataTransfer.setDragImage(c,0,0),l.dragging={slice:at,move:s.ctrlKey}}let r=null;function n(){r&&r.classList.add("hide")}function o(){r&&r.classList.remove("hide")}function a(s){if(s.target instanceof Element){const l=s.relatedTarget;if((l==null?void 0:l.classList.contains("tiptap"))||(l==null?void 0:l.classList.contains("drag-handle")))return}n()}return new Z({key:new X(i.pluginKey),view:s=>{var m,y,S,O;const l=i.dragHandleSelector?document.querySelector(i.dragHandleSelector):null;r=l!=null?l:document.createElement("div"),r.draggable=!0,r.dataset.dragHandle="",r.classList.add("drag-handle");function c(g){e(g,s)}r.addEventListener("dragstart",c);function h(g){n();let E=window.scrollY;g.clientY<i.scrollTreshold?window.scrollTo({top:E-30,behavior:"smooth"}):window.innerHeight-g.clientY<i.scrollTreshold&&window.scrollTo({top:E+30,behavior:"smooth"})}return r.addEventListener("drag",h),n(),l||(y=(m=s==null?void 0:s.dom)==null?void 0:m.parentElement)==null||y.appendChild(r),(O=(S=s==null?void 0:s.dom)==null?void 0:S.parentElement)==null||O.addEventListener("mouseout",a),{destroy:()=>{var g,E,N;l||(g=r==null?void 0:r.remove)==null||g.call(r),r==null||r.removeEventListener("drag",h),r==null||r.removeEventListener("dragstart",c),r=null,(N=(E=s==null?void 0:s.dom)==null?void 0:E.parentElement)==null||N.removeEventListener("mouseout",a)}}},props:{handleDOMEvents:{mousemove:(s,l)=>{if(!s.editable)return;const c=ut({x:l.clientX+50+i.dragHandleWidth,y:l.clientY},i),h=c==null?void 0:c.closest(".not-draggable"),m=i.excludedTags.concat(["ol","ul"]).join(", ");if(!(c instanceof Element)||c.matches(m)||h){n();return}const y=window.getComputedStyle(c),S=parseInt(y.lineHeight,10),O=isNaN(S)?parseInt(y.fontSize)*1.2:S,g=parseInt(y.paddingTop,10),E=we(c);E.top+=(O-24)/2,E.top+=g,c.matches("ul:not([data-type=taskList]) li, ol li")&&(E.left-=i.dragHandleWidth),E.width=i.dragHandleWidth,r&&(r.style.left="".concat(E.left-E.width,"px"),r.style.top="".concat(E.top,"px"),o())},keydown:()=>{n()},mousewheel:()=>{n()},dragstart:s=>{s.dom.classList.add("dragging")},drop:(s,l)=>{var S;s.dom.classList.remove("dragging"),n();let c=null;const h=s.posAtCoords({left:l.clientX,top:l.clientY});if(!h||(s.state.selection instanceof v&&(c=s.state.selection.node),!c))return;const y=s.state.doc.resolve(h.pos).parent.type.name==="listItem";if(s.state.selection instanceof v&&s.state.selection.node.type.name==="listItem"&&!y&&t=="OL"){const O=(S=s.state.schema.nodes.orderedList)==null?void 0:S.createAndFill(null,c),g=new Ht(Wt.from(O),0,0);s.dragging={slice:g,move:l.ctrlKey}}},dragend:s=>{s.dom.classList.remove("dragging")}}}})}const Ee=Q.create({name:"globalDragHandle",addOptions(){return{dragHandleWidth:20,scrollTreshold:100,excludedTags:[],customNodes:[]}},addProseMirrorPlugins(){return[Se({pluginKey:"globalDragHandle",dragHandleWidth:this.options.dragHandleWidth,scrollTreshold:this.options.scrollTreshold,dragHandleSelector:this.options.dragHandleSelector,excludedTags:this.options.excludedTags,customNodes:this.options.customNodes})]}});function St(i,t,e){for(let r=0;;r++){if(r==i.childCount||r==t.childCount)return i.childCount==t.childCount?null:e;let n=i.child(r),o=t.child(r);if(n==o){e+=n.nodeSize;continue}if(!n.sameMarkup(o))return e;if(n.isText&&n.text!=o.text){for(let a=0;n.text[a]==o.text[a];a++)e++;return e}if(n.content.size||o.content.size){let a=St(n.content,o.content,e+1);if(a!=null)return a}e+=n.nodeSize}}function Et(i,t,e,r){for(let n=i.childCount,o=t.childCount;;){if(n==0||o==0)return n==o?null:{a:e,b:r};let a=i.child(--n),s=t.child(--o),l=a.nodeSize;if(a==s){e-=l,r-=l;continue}if(!a.sameMarkup(s))return{a:e,b:r};if(a.isText&&a.text!=s.text){let c=0,h=Math.min(a.text.length,s.text.length);for(;c<h&&a.text[a.text.length-c-1]==s.text[s.text.length-c-1];)c++,e--,r--;return{a:e,b:r}}if(a.content.size||s.content.size){let c=Et(a.content,s.content,e-1,r-1);if(c)return c}e-=l,r-=l}}class p{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,n=0,o){for(let a=0,s=0;s<e;a++){let l=this.content[a],c=s+l.nodeSize;if(c>t&&r(l,n+s,o||null,a)!==!1&&l.content.size){let h=s+1;l.nodesBetween(Math.max(0,t-h),Math.min(l.content.size,e-h),r,n+h)}s=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,n){let o="",a=!0;return this.nodesBetween(t,e,(s,l)=>{let c=s.isText?s.text.slice(Math.max(t,l)-l,e-l):s.isLeaf?n?typeof n=="function"?n(s):n:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&c||s.isTextblock)&&r&&(a?a=!1:o+=r),o+=c},0),o}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,n=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(r)&&(n[n.length-1]=e.withText(e.text+r.text),o=1);o<t.content.length;o++)n.push(t.content[o]);return new p(n,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],n=0;if(e>t)for(let o=0,a=0;a<e;o++){let s=this.content[o],l=a+s.nodeSize;l>t&&((a<t||l>e)&&(s.isText?s=s.cut(Math.max(0,t-a),Math.min(s.text.length,e-a)):s=s.cut(Math.max(0,t-a-1),Math.min(s.content.size,e-a-1))),r.push(s),n+=s.nodeSize),a=l}return new p(r,n)}cutByIndex(t,e){return t==e?p.empty:t==0&&e==this.content.length?this:new p(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let n=this.content.slice(),o=this.size+e.nodeSize-r.nodeSize;return n[t]=e,new p(n,o)}addToStart(t){return new p([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new p(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let n=this.content[e];t(n,r,e),r+=n.nodeSize}}findDiffStart(t,e=0){return St(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return Et(this,t,e,r)}findIndex(t,e=-1){if(t==0)return q(0,t);if(t==this.size)return q(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position ".concat(t," outside of fragment (").concat(this,")"));for(let r=0,n=0;;r++){let o=this.child(r),a=n+o.nodeSize;if(a>=t)return a==t||e>0?q(r+1,a):q(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return p.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new p(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return p.empty;let e,r=0;for(let n=0;n<t.length;n++){let o=t[n];r+=o.nodeSize,n&&o.isText&&t[n-1].sameMarkup(o)?(e||(e=t.slice(0,n)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new p(e||t,r)}static from(t){if(!t)return p.empty;if(t instanceof p)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new p([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}p.empty=new p([],0);const tt={index:0,offset:0};function q(i,t){return tt.index=i,tt.offset=t,tt}class Te extends Error{}class w{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=Ot(this.content,t+this.openStart,e);return r&&new w(r,this.openStart,this.openEnd)}removeBetween(t,e){return new w(Tt(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return w.empty;let r=e.openStart||0,n=e.openEnd||0;if(typeof r!="number"||typeof n!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new w(p.fromJSON(t,e.content),r,n)}static maxOpen(t,e=!0){let r=0,n=0;for(let o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=t.lastChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.lastChild)n++;return new w(t,r,n)}}w.empty=new w(p.empty,0,0);function Tt(i,t,e){let{index:r,offset:n}=i.findIndex(t),o=i.maybeChild(r),{index:a,offset:s}=i.findIndex(e);if(n==t||o.isText){if(s!=e&&!i.child(a).isText)throw new RangeError("Removing non-flat range");return i.cut(0,t).append(i.cut(e))}if(r!=a)throw new RangeError("Removing non-flat range");return i.replaceChild(r,o.copy(Tt(o.content,t-n-1,e-n-1)))}function Ot(i,t,e,r){let{index:n,offset:o}=i.findIndex(t),a=i.maybeChild(n);if(o==t||a.isText)return i.cut(0,t).append(e).append(i.cut(t));let s=Ot(a.content,t-o-1,e);return s&&i.replaceChild(n,a.copy(s))}const kt=65535,Nt=Math.pow(2,16);function Oe(i,t){return i+t*Nt}function ft(i){return i&kt}function ke(i){return(i-(i&kt))/Nt}const vt=1,zt=2,Y=4,It=8;class pt{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&It)>0}get deletedBefore(){return(this.delInfo&(vt|Y))>0}get deletedAfter(){return(this.delInfo&(zt|Y))>0}get deletedAcross(){return(this.delInfo&Y)>0}}class k{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&k.empty)return k.empty}recover(t){let e=0,r=ft(t);if(!this.inverted)for(let n=0;n<r;n++)e+=this.ranges[n*3+2]-this.ranges[n*3+1];return this.ranges[r*3]+e+ke(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let n=0,o=this.inverted?2:1,a=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let l=this.ranges[s]-(this.inverted?n:0);if(l>t)break;let c=this.ranges[s+o],h=this.ranges[s+a],m=l+c;if(t<=m){let y=c?t==l?-1:t==m?1:e:e,S=l+n+(y<0?0:h);if(r)return S;let O=t==(e<0?l:m)?null:Oe(s/3,t-l),g=t==l?zt:t==m?vt:Y;return(e<0?t!=l:t!=m)&&(g|=It),new pt(S,g,O)}n+=h-c}return r?t+n:new pt(t+n,0,null)}touches(t,e){let r=0,n=ft(e),o=this.inverted?2:1,a=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let l=this.ranges[s]-(this.inverted?r:0);if(l>t)break;let c=this.ranges[s+o],h=l+c;if(t<=h&&s==n*3)return!0;r+=this.ranges[s+a]-c}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let n=0,o=0;n<this.ranges.length;n+=3){let a=this.ranges[n],s=a-(this.inverted?o:0),l=a+(this.inverted?0:o),c=this.ranges[n+e],h=this.ranges[n+r];t(s,s+c,l,l+h),o+=h-c}}invert(){return new k(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?k.empty:new k(t<0?[0,-t,0]:[0,0,t])}}k.empty=new k([]);const et=Object.create(null);class T{getMap(){return k.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=et[e.stepType];if(!r)throw new RangeError("No step type ".concat(e.stepType," defined"));return r.fromJSON(t,e)}static jsonID(t,e){if(t in et)throw new RangeError("Duplicate use of step JSON ID "+t);return et[t]=e,e.prototype.jsonID=t,e}}class x{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new x(t,null)}static fail(t){return new x(null,t)}static fromReplace(t,e,r,n){try{return x.ok(t.replace(e,r,n))}catch(o){if(o instanceof Te)return x.fail(o.message);throw o}}}function ot(i,t,e){let r=[];for(let n=0;n<i.childCount;n++){let o=i.child(n);o.content.size&&(o=o.copy(ot(o.content,t,o))),o.isInline&&(o=t(o,e,n)),r.push(o)}return p.fromArray(r)}class D extends T{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),n=r.node(r.sharedDepth(this.to)),o=new w(ot(e.content,(a,s)=>!a.isAtom||!s.type.allowsMarkType(this.mark.type)?a:a.mark(this.mark.addToSet(a.marks)),n),e.openStart,e.openEnd);return x.fromReplace(t,this.from,this.to,o)}invert(){return new R(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new D(e.pos,r.pos,this.mark)}merge(t){return t instanceof D&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new D(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new D(e.from,e.to,t.markFromJSON(e.mark))}}T.jsonID("addMark",D);class R extends T{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new w(ot(e.content,n=>n.mark(this.mark.removeFromSet(n.marks)),t),e.openStart,e.openEnd);return x.fromReplace(t,this.from,this.to,r)}invert(){return new D(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new R(e.pos,r.pos,this.mark)}merge(t){return t instanceof R&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new R(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new R(e.from,e.to,t.markFromJSON(e.mark))}}T.jsonID("removeMark",R);class A extends T{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return x.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return x.fromReplace(t,this.pos,this.pos+1,new w(p.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let n=0;n<e.marks.length;n++)if(!e.marks[n].isInSet(r))return new A(this.pos,e.marks[n]);return new A(this.pos,this.mark)}}return new W(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new A(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new A(e.pos,t.markFromJSON(e.mark))}}T.jsonID("addNodeMark",A);class W extends T{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return x.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return x.fromReplace(t,this.pos,this.pos+1,new w(p.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new A(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new W(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new W(e.pos,t.markFromJSON(e.mark))}}T.jsonID("removeNodeMark",W);class I extends T{constructor(t,e,r,n=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=n}apply(t){return this.structure&&it(t,this.from,this.to)?x.fail("Structure replace would overwrite content"):x.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new k([this.from,this.to-this.from,this.slice.size])}invert(t){return new I(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new I(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof I)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?w.empty:new w(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new I(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?w.empty:new w(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new I(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new I(e.from,e.to,w.fromJSON(t,e.slice),!!e.structure)}}T.jsonID("replace",I);class $ extends T{constructor(t,e,r,n,o,a,s=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=n,this.slice=o,this.insert=a,this.structure=s}apply(t){if(this.structure&&(it(t,this.from,this.gapFrom)||it(t,this.gapTo,this.to)))return x.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return x.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?x.fromReplace(t,this.from,this.to,r):x.fail("Content does not fit in gap")}getMap(){return new k([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new $(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),n=t.map(this.gapFrom,-1),o=t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||n<e.pos||o>r.pos?null:new $(e.pos,r.pos,n,o,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new $(e.from,e.to,e.gapFrom,e.gapTo,w.fromJSON(t,e.slice),e.insert,!!e.structure)}}T.jsonID("replaceAround",$);function it(i,t,e){let r=i.resolve(t),n=e-t,o=r.depth;for(;n>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,n--;if(n>0){let a=r.node(o).maybeChild(r.indexAfter(o));for(;n>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,n--}}return!1}function Ne(i,t){let e=i.resolve(t),r=e.index();return ve(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function ve(i,t){return!!(i&&t&&!i.isLeaf&&i.canAppend(t))}class H extends T{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return x.fail("No node at attribute step's position");let r=Object.create(null);for(let o in e.attrs)r[o]=e.attrs[o];r[this.attr]=this.value;let n=e.type.create(r,null,e.marks);return x.fromReplace(t,this.pos,this.pos+1,new w(p.from(n),0,e.isLeaf?0:1))}getMap(){return k.empty}invert(t){return new H(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new H(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new H(e.pos,e.attr,e.value)}}T.jsonID("attr",H);class K extends T{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let r=t.type.create(e,t.content,t.marks);return x.ok(r)}getMap(){return k.empty}invert(t){return new K(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new K(e.attr,e.value)}}T.jsonID("docAttr",K);let U=class extends Error{};U=function i(t){let e=Error.call(this,t);return e.__proto__=i.prototype,e};U.prototype=Object.create(Error.prototype);U.prototype.constructor=U;U.prototype.name="TransformError";function ze(i,t,e){let r=[];for(let a=0;a<i.mapping.maps.length;a++){let s=i.mapping.maps[a];if(s){for(let l=0;l<r.length;l++)r[l]=s.map(r[l]);s.forEach((l,c,h,m)=>r.push(h,m))}}let n=[];for(let a=0;a<r.length;a+=2){let s=r[a],l=r[a+1],c=i.doc.resolve(s),h=c.sharedDepth(l),m=c.node(h);for(let y=c.indexAfter(h),S=c.after(h+1);S<=l;++y){let O=m.maybeChild(y);if(!O)break;if(y&&n.indexOf(S)==-1){let g=m.child(y-1);g.type==O.type&&e.includes(g.type)&&n.push(S)}S+=O.nodeSize}}let o=!1;n.sort((a,s)=>a-s);for(let a=n.length-1;a>=0;a--)Ne(i.doc,n[a])&&(t.join(n[a]),o=!0);return o}const Ie=Q.create({name:"autoJoiner",addOptions(){return{elementsToJoin:[]}},addProseMirrorPlugins(){const i=new X(this.name),t=[this.editor.schema.nodes.bulletList,this.editor.schema.nodes.orderedList];return this.options.elementsToJoin.forEach(e=>{const r=Ut(e,this.editor.schema);t.push(r)}),[new Z({key:i,appendTransaction(e,r,n){let o=n.tr,a=!1;for(const s of e)a=ze(s,o,t)||a;if(a)return o}})]}}),be=Q.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Z({key:new X("placeholder"),props:{decorations:({doc:i,selection:t})=>{const e=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,n=[];if(!e)return null;const o=this.editor.isEmpty;return i.descendants((a,s)=>{const l=r>=s&&r<=s+a.nodeSize,c=!a.isLeaf&&_t(a);if((l||!this.options.showOnlyCurrent)&&c){const h=[this.options.emptyNodeClass];o&&h.push(this.options.emptyEditorClass);const m=gt.node(s,s+a.nodeSize,{class:h.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:a,pos:s,hasAnchor:l}):this.options.placeholder});n.push(m)}return this.options.includeChildren}),xt.create(i,n)}}})]}}),Ce=Q.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:i=>i.length,wordCounter:i=>i.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=i=>{const t=(i==null?void 0:i.node)||this.editor.state.doc;if(((i==null?void 0:i.mode)||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=i=>{const t=(i==null?void 0:i.node)||this.editor.state.doc,e=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(e)}},addProseMirrorPlugins(){let i=!1;return[new Z({key:new X("characterCount"),appendTransaction:(t,e,r)=>{if(i)return;const n=this.options.limit;if(n==null||n===0){i=!0;return}const o=this.storage.characters({node:r.doc});if(o>n){const a=o-n,s=0,l=a;console.warn("[CharacterCount] Initial content exceeded limit of ".concat(n," characters. Content was automatically trimmed."));const c=r.tr.deleteRange(s,l);return i=!0,c}i=!0},filterTransaction:(t,e)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const n=this.storage.characters({node:e.doc}),o=this.storage.characters({node:t.doc});if(o<=r||n>r&&o>r&&o<=n)return!0;if(n>r&&o>r&&o>n||!t.getMeta("paste"))return!1;const s=t.selection.$head.pos,l=o-r,c=s-l,h=s;return t.deleteRange(c,h),!(this.storage.characters({node:t.doc})>r)}})]}});_.extend(oe);_.extend(ae);_.extend(le);_.locale("zh-tw");const V=()=>_.utc().local();class De{constructor(){M(this,"timer",null);M(this,"getDomainTime",C(null));this.getDomainTime.value=V()}calculateNextDelay(){return 1e3-V().millisecond()}start(){const t=()=>{this.getDomainTime.value=V();const e=this.calculateNextDelay(),r=V().valueOf()-this.getDomainTime.value.valueOf();console.log("誤差:",r,"ms"),this.timer=setTimeout(t,e)};t()}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}getTime(){return this.getDomainTime.value}}new De;const rt=20,z=12,P="xid: invalid ID",bt=new TextEncoder,Re=new TextDecoder,d=bt.encode("0123456789abcdefghijklmnopqrstuv"),u=new Uint8Array(256).fill(255);for(let i=0;i<d.length;i++)u[d[i]]=i;const Ct=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,nt=Dt(),f=class f extends Uint8Array{constructor(t){if(super(z),t==null){const e=new DataView(this.buffer),r=Math.floor(Date.now()/1e3);e.setUint32(0,r),this[4]=f.machineId[0],this[5]=f.machineId[1],this[6]=f.machineId[2],this[7]=f.pid>>8,this[8]=f.pid&255,f.counter+=1,f.counter>16777215&&(f.counter=0),this[9]=f.counter>>16,this[10]=f.counter&255,this[11]=f.counter&255}else{if(!(t instanceof Uint8Array)||t.length!==z)throw new Error(P);this.set(t)}}static default(){return new f(new Uint8Array(z).fill(0))}static fromValue(t){if(t instanceof f)return t;if(typeof t=="string")return f.parse(t);if(t instanceof Uint8Array&&t.length===z)return new f(t);if(t instanceof ArrayBuffer&&t.byteLength===z)return new f(new Uint8Array(t));if(Array.isArray(t)&&t.length===z&&t.every(e=>typeof e=="number"&&e>=0&&e<=255))return new f(new Uint8Array(t));throw new Error(P)}static parse(t){if(t.length!==rt)throw new Error(P);const e=new f;return e.decode(t),e}decode(t){const e=bt.encode(t);if(e.length!==rt)throw new Error(P);for(const r of e)if(u[r]==255)throw new Error(P);if(this[11]=u[e[17]]<<6|u[e[18]]<<1|u[e[19]]>>4,d[this[11]<<4&31]!=e[19])throw new Error(P);this[10]=u[e[16]]<<3|u[e[17]]>>2,this[9]=u[e[14]]<<5|u[e[15]],this[8]=u[e[12]]<<7|u[e[13]]<<2|u[e[14]]>>3,this[7]=u[e[11]]<<4|u[e[12]]>>1,this[6]=u[e[9]]<<6|u[e[10]]<<1|u[e[11]]>>4,this[5]=u[e[8]]<<3|u[e[9]]>>2,this[4]=u[e[6]]<<5|u[e[7]],this[3]=u[e[4]]<<7|u[e[5]]<<2|u[e[6]]>>3,this[2]=u[e[3]]<<4|u[e[4]]>>1,this[1]=u[e[1]]<<6|u[e[2]]<<1|u[e[3]]>>4,this[0]=u[e[0]]<<3|u[e[1]]>>2}encode(){const t=new Uint8Array(rt);return t[19]=d[this[11]<<4&31],t[18]=d[this[11]>>1&31],t[17]=d[this[11]>>6|this[10]<<2&31],t[16]=d[this[10]>>3],t[15]=d[this[9]&31],t[14]=d[this[9]>>5|this[8]<<3&31],t[13]=d[this[8]>>2&31],t[12]=d[this[8]>>7|this[7]<<1&31],t[11]=d[this[7]>>4|this[6]<<4&31],t[10]=d[this[6]>>1&31],t[9]=d[this[6]>>6|this[5]<<2&31],t[8]=d[this[5]>>3],t[7]=d[this[4]&31],t[6]=d[this[4]>>5|this[3]<<3&31],t[5]=d[this[3]>>2&31],t[4]=d[this[3]>>7|this[2]<<1&31],t[3]=d[this[2]>>4|this[1]<<4&31],t[2]=d[this[1]>>1&31],t[1]=d[this[1]>>6|this[0]<<2&31],t[0]=d[this[0]>>3],Re.decode(t)}timestamp(){return new DataView(this.buffer).getUint32(0)}machine(){return new Uint8Array(this.buffer,4,3)}pid(){return this[7]<<8|this[8]}counter(){return this[9]<<16|this[10]<<8|this[11]}isZero(){return super.every(t=>t===0)}toString(){return this.encode()}toBytes(){return new Uint8Array(this.buffer,0,z)}toJSON(){return this.encode()}equals(t){for(let e=0;e<z;e++)if(this[e]!==t[e])return!1;return!0}};M(f,"machineId",Dt()),M(f,"pid",Ae()),M(f,"counter",nt[0]<<16|nt[1]<<8|nt[2]);let mt=f;function Dt(){return Ct.getRandomValues(new Uint8Array(3))}function Ae(){if(typeof globalThis=="object"&&"process"in globalThis)return globalThis.process.pid&65535;const i=Ct.getRandomValues(new Uint8Array(2));return i[0]<<8|i[1]}const Je=st({__name:"TextEditor",props:{articleHtmlRef:{},articleHtmlRefModifiers:{},isDomainFormat:{type:Boolean},isDomainFormatModifiers:{}},emits:["update:articleHtmlRef","update:isDomainFormat"],setup(i){ne(),lt(i,"articleHtmlRef"),lt(i,"isDomainFormat"),C(!0);const t=C(!1),e=C(),r=C(),n=new pe({extensions:[...qt,Ee.configure({dragHandleSelector:".drag-handle"}),Ie,Ce.configure({limit:b.WORD_LIMIT,textCounter:a=>a.replace(/\s+/g," ").length}),be.configure({placeholder:({pos:a,node:s,editor:l})=>a===0?"第一段內容會作為標題或封面圖":"新段落..."})]}),o=F(()=>{try{return n.storage.characterCount.characters()}catch(a){return 0}});return F(()=>o.value>=b.WORD_LIMIT),F(()=>o.value>=b.WORD_WARNING&&o.value<b.WORD_LIMIT),F(()=>j.size>=b.IMAGE_LIMIT),F(()=>j.size>=b.IMAGE_WARNING&&j.size<b.IMAGE_LIMIT),jt(e,()=>t.value=!1,{ignore:[r]}),wt(),te(),C(!1),ee(()=>{setTimeout(()=>{n.commands.focus("end")},100)}),(a,s)=>(yt(),re(G(me),{editor:G(n)},null,8,["editor"]))}}),Me=ce(Je,[["__scopeId","data-v-0d000519"]]),Le={class:"bg-stone-100 [&>div]:xl:first:mt-[100px] [&>div]:md:first:mt-[80px] [&>div]:max-md:first:mt-[60px]"},Pe={class:"flex w-full"},Fe={class:"xl:w-[600px] md:w-[400px] md:flex max-md:hidden flex-col"},Be={class:"sticky top-[100px]"},$e={class:"text-[1.1rem]"},He={class:"w-full xl:max-w-[654px] md:max-w-[550px]"},Ye=st({__name:"PostsPage",setup(i){const t=wt(),e="你準備在 ".concat(t.topicTitle," 發表"),r="你正要在 ".concat(t.articleTitle," 留言"),n=F(()=>t.article===""?e:r);return console.log(t.topic),(o,a)=>{const s=he,l=de,c=ue,h=Me;return yt(),ie(se,null,[B(s),L("div",Le,[B(c,{class:"select-none !pt-5 flex justify-center xl:min-h-[calc(100dvh-100px-(1.25rem*2))] md:min-h-[calc(100dvh-80px-(1rem*2))] max-md:min-h-[calc(100dvh-60px)]"},{default:ct(()=>[L("div",Pe,[L("div",Fe,[L("div",Be,[B(c,{class:"flex flex-col"},{default:ct(()=>[L("p",$e,[B(l,{text:G(n)},null,8,["text"])])]),_:1})])]),L("div",He,[B(h)])])]),_:1})])],64)}}});export{Ye as default};
